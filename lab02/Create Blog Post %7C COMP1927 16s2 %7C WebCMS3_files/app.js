function dean_addEvent(t,e,r){if(t.addEventListener)t.addEventListener(e,r,!1);else{r.$$guid||(r.$$guid=dean_addEvent.guid++),t.events||(t.events={});var o=t.events[e];o||(o=t.events[e]={},t["on"+e]&&(o[0]=t["on"+e])),o[r.$$guid]=r,t["on"+e]=handleEvent}}function removeEvent(t,e,r){t.removeEventListener?t.removeEventListener(e,r,!1):t.events&&t.events[e]&&delete t.events[e][r.$$guid]}function handleEvent(t){var e=!0;t=t||fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event);var r=this.events[t.type];for(var o in r)this.$$handleEvent=r[o],this.$$handleEvent(t)===!1&&(e=!1);return e}function fixEvent(t){return t.preventDefault=fixEvent.preventDefault,t.stopPropagation=fixEvent.stopPropagation,t}if(function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArraylike(obj){var length="length"in obj&&obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>=0!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function completed(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Data.uid++}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$1").toLowerCase(),data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}data_user.set(elem,key,data)}else data=void 0;return data}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(data_priv.hasData(src)&&(pdataOld=data_priv.access(src),pdataCur=data_priv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}data_user.hasData(src)&&(udataOld=data_user.access(src),udataCur=jQuery.extend({},udataOld),data_user.set(dest,udataCur))}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");return elem.detach(),display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement),doc=iframe[0].contentDocument,doc.write(),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name]),computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(style,name){if(name in style)return name;for(var capName=name[0].toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=data_priv.get(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=data_priv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))):(hidden=isHidden(elem),"none"===display&&hidden||data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){return setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],display=jQuery.css(elem,"display"),checkDisplay="none"===display?data_priv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display,"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0;if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=data_priv.access(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},document=window.document,version="2.1.4",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)+1>=0},isPlainObject:function(obj){return"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj)?!1:obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(1===code.indexOf("use strict")?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++)callbackInverse=!callback(elems[i],i),callbackInverse!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&ret.push(value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):void 0},now:Date.now,support:support}),jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],nodeType=context.nodeType,"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=1!==nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&testContext(context.parentNode)||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){if(outerCache=elem[expando]||(elem[expando]={}),(oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(outerCache[dir]=newCache,newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context!==document&&context);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;len>i;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),
TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,parent=doc.defaultView,parent&&parent!==parent.top&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler)),documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(doc.getElementsByClassName),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\f]' msallowcapture=''><option selected=''></option></select>",div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("name","D"),div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare?compare:(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&elem.parentNode&&(this.length=1,this[0]=elem),this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?"undefined"!=typeof rootjQuery.ready?rootjQuery.ready(selector):selector(jQuery):(void 0!==selector.selector&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))};init.prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},sibling:function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched}}),jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.unique(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnotwhite=/\S+/g,optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=void 0,this},disabled:function(){return!list},lock:function(){return stack=void 0,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){return jQuery.ready.promise().done(fn),this},jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){(wait===!0?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.triggerHandler&&(jQuery(document).triggerHandler("ready"),jQuery(document).off("ready"))))}}),jQuery.ready.promise=function(obj){return readyList||(readyList=jQuery.Deferred(),"complete"===document.readyState?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(obj)},jQuery.ready.promise();var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};jQuery.acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType},Data.uid=1,Data.accepts=jQuery.acceptData,Data.prototype={key:function(owner){if(!Data.accepts(owner))return 0;var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock},Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock,jQuery.extend(owner,descriptor)}}return this.cache[unlock]||(this.cache[unlock]={}),unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if("string"==typeof data)cache[data]=value;else if(jQuery.isEmptyObject(cache))jQuery.extend(this.cache[unlock],data);else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return void 0===key?cache:cache[key]},access:function(owner,key,value){var stored;return void 0===key||key&&"string"==typeof key&&void 0===value?(stored=this.get(owner,key),void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(void 0===key)this.cache[unlock]={};else{jQuery.isArray(key)?name=key.concat(key.map(jQuery.camelCase)):(camel=jQuery.camelCase(key),key in cache?name=[key,camel]:(name=camel,name=name in cache?[name]:name.match(rnotwhite)||[])),i=name.length;for(;i--;)delete cache[name[i]]}},hasData:function(owner){return!jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){owner[this.expando]&&delete this.cache[owner[this.expando]]}};var data_priv=new Data,data_user=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem);
},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=data_user.get(elem),1===elem.nodeType&&!data_priv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));data_priv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){data_user.set(this,key)}):access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&void 0===value){if(data=data_user.get(elem,key),void 0!==data)return data;if(data=data_user.get(elem,camelKey),void 0!==data)return data;if(data=dataAttr(elem,camelKey,void 0),void 0!==data)return data}else this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value),-1!==key.indexOf("-")&&void 0!==data&&data_user.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=data_priv.get(elem,type),data&&(!queue||jQuery.isArray(data)?queue=data_priv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)tmp=data_priv.get(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var strundefined="undefined";support.focusinBubbles="onfocusin"in window;var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle,!1)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,data_priv.remove(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&handle.apply&&jQuery.acceptData(cur)&&(event.result=handle.apply(cur,data),event.result===!1&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&special._default.apply(eventPath.pop(),data)!==!1||!jQuery.acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),void 0!==ret&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!==this;cur=cur.parentNode||this)if(cur.disabled!==!0||"click"!==event.type){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0),event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=document),3===event.target.nodeType&&(event.target=event.target.parentNode),fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==safeActiveElement()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),data_priv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=data_priv.access(doc,fix)-1;attaches?data_priv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),data_priv.remove(doc,fix))}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=void 0),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},buildFragment:function(elems,context,scripts,selection){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment},cleanData:function(elems){for(var data,elem,type,key,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++){if(jQuery.acceptData(elem)&&(key=elem[data_priv.expando],key&&(data=data_priv.cache[key]))){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);data_priv.cache[key]&&delete data_priv.cache[key]}delete data_user.cache[elem[data_user.expando]]}}}),jQuery.fn.extend({text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];return this.domManip(arguments,function(elem){arg=this.parentNode,jQuery.cleanData(getAll(this)),arg&&arg.replaceChild(elem,this)}),arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var iframe,elemdisplay={},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){return elem.ownerDocument.defaultView.opener?elem.ownerDocument.defaultView.getComputedStyle(elem,null):window.getComputedStyle(elem,null)};!function(){function computePixelPositionAndBoxSizingReliable(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",div.innerHTML="",docElem.appendChild(container);var divStyle=window.getComputedStyle(div,null);pixelPositionVal="1%"!==divStyle.top,boxSizingReliableVal="4px"===divStyle.width,docElem.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,docElem=document.documentElement,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",container.appendChild(div),window.getComputedStyle&&jQuery.extend(support,{pixelPosition:function(){return computePixelPositionAndBoxSizingReliable(),pixelPositionVal},boxSizingReliable:function(){return null==boxSizingReliableVal&&computePixelPositionAndBoxSizingReliable(),boxSizingReliableVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));return marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",docElem.appendChild(container),ret=!parseFloat(window.getComputedStyle(marginDiv,null).marginRight),docElem.removeChild(container),div.removeChild(marginDiv),ret}}))}(),jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value?hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name]:(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),null!=value&&value===value&&("number"!==type||jQuery.cssNumber[origName]||(value+="px"),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]=value)),void 0)}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,
tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||data_priv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),timer()?jQuery.fx.start():jQuery.timers.pop()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,select.disabled=!0,support.optDisabled=!opt.disabled,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),void 0===value?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret):null!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)&&(elem[propName]=!1),elem.removeAttribute(name)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;return isXML||(handle=attrHandle[name],attrHandle[name]=ret,ret=null!=getter(elem,name,isXML)?name.toLowerCase():null,attrHandle[name]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed="string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur),elem.className!==finalValue&&(elem.className=finalValue)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,proceed=0===arguments.length||"string"==typeof value&&value,i=0,len=this.length;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");finalValue=value?jQuery.trim(cur):"",elem.className!==finalValue&&(elem.className=finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):this.each(jQuery.isFunction(value)?function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}:function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===strundefined||"boolean"===type)&&(this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||value===!1?"":data_priv.get(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem))}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(option.value,values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")},jQuery.parseXML=function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=void 0}return(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data),xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*"),ajaxLocation=window.location.href,ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapAll(html.call(this,i))}):(this[0]&&(wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this)},wrapInner:function(html){return this.each(jQuery.isFunction(html)?function(i){jQuery(this).wrapInner(html.call(this,i))}:function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}}),jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrId=0,xhrCallbacks={},xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();window.attachEvent&&window.attachEvent("onunload",function(){for(var key in xhrCallbacks)xhrCallbacks[key]()}),support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(delete xhrCallbacks[id],callback=xhr.onload=xhr.onerror=null,"abort"===type?xhr.abort():"error"===type?complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"string"==typeof xhr.responseText?{text:xhr.responseText}:void 0,xhr.getAllResponseHeaders()))}},xhr.onload=callback(),xhr.onerror=callback("error"),callback=xhrCallbacks[id]=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}:void 0}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:!0,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"):void 0}),jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");return off>=0&&(selector=jQuery.trim(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}):box},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);return void 0===val?win?win[prop]:elem[method]:void(win?win.scrollTo(top?window.pageXOffset:val,top?val:window.pageYOffset):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},typeof noGlobal===strundefined&&(window.jQuery=window.$=jQuery),jQuery}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var version=$.fn.jquery.split(" ")[0].split(".");if(version[0]<2&&version[1]<9||1==version[0]&&9==version[1]&&version[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function($){"use strict";function transitionEnd(){
var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one("bsTransitionEnd",function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){return $(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.alert");data||$this.data("bs.alert",data=new Alert(this)),"string"==typeof option&&data[option].call($this)})}var dismiss='[data-dismiss="alert"]',Alert=function(el){$(el).on("click",dismiss,this.close)};Alert.VERSION="3.3.4",Alert.TRANSITION_DURATION=150,Alert.prototype.close=function(e){function removeElement(){$parent.detach().trigger("closed.bs.alert").remove()}var $this=$(this),selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=$(selector);e&&e.preventDefault(),$parent.length||($parent=$this.closest(".alert")),$parent.trigger(e=$.Event("close.bs.alert")),e.isDefaultPrevented()||($parent.removeClass("in"),$.support.transition&&$parent.hasClass("fade")?$parent.one("bsTransitionEnd",removeElement).emulateTransitionEnd(Alert.TRANSITION_DURATION):removeElement())};var old=$.fn.alert;$.fn.alert=Plugin,$.fn.alert.Constructor=Alert,$.fn.alert.noConflict=function(){return $.fn.alert=old,this},$(document).on("click.bs.alert.data-api",dismiss,Alert.prototype.close)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.button"),options="object"==typeof option&&option;data||$this.data("bs.button",data=new Button(this,options)),"toggle"==option?data.toggle():option&&data.setState(option)})}var Button=function(element,options){this.$element=$(element),this.options=$.extend({},Button.DEFAULTS,options),this.isLoading=!1};Button.VERSION="3.3.4",Button.DEFAULTS={loadingText:"loading..."},Button.prototype.setState=function(state){var d="disabled",$el=this.$element,val=$el.is("input")?"val":"html",data=$el.data();state+="Text",null==data.resetText&&$el.data("resetText",$el[val]()),setTimeout($.proxy(function(){$el[val](null==data[state]?this.options[state]:data[state]),"loadingText"==state?(this.isLoading=!0,$el.addClass(d).attr(d,d)):this.isLoading&&(this.isLoading=!1,$el.removeClass(d).removeAttr(d))},this),0)},Button.prototype.toggle=function(){var changed=!0,$parent=this.$element.closest('[data-toggle="buttons"]');if($parent.length){var $input=this.$element.find("input");"radio"==$input.prop("type")&&($input.prop("checked")&&this.$element.hasClass("active")?changed=!1:$parent.find(".active").removeClass("active")),changed&&$input.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));changed&&this.$element.toggleClass("active")};var old=$.fn.button;$.fn.button=Plugin,$.fn.button.Constructor=Button,$.fn.button.noConflict=function(){return $.fn.button=old,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var $btn=$(e.target);$btn.hasClass("btn")||($btn=$btn.closest(".btn")),Plugin.call($btn,"toggle"),e.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){$(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.carousel"),options=$.extend({},Carousel.DEFAULTS,$this.data(),"object"==typeof option&&option),action="string"==typeof option?option:options.slide;data||$this.data("bs.carousel",data=new Carousel(this,options)),"number"==typeof option?data.to(option):action?data[action]():options.interval&&data.pause().cycle()})}var Carousel=function(element,options){this.$element=$(element),this.$indicators=this.$element.find(".carousel-indicators"),this.options=options,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",$.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};Carousel.VERSION="3.3.4",Carousel.TRANSITION_DURATION=600,Carousel.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},Carousel.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},Carousel.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},Carousel.prototype.getItemIndex=function(item){return this.$items=item.parent().children(".item"),this.$items.index(item||this.$active)},Carousel.prototype.getItemForDirection=function(direction,active){var activeIndex=this.getItemIndex(active),willWrap="prev"==direction&&0===activeIndex||"next"==direction&&activeIndex==this.$items.length-1;if(willWrap&&!this.options.wrap)return active;var delta="prev"==direction?-1:1,itemIndex=(activeIndex+delta)%this.$items.length;return this.$items.eq(itemIndex)},Carousel.prototype.to=function(pos){var that=this,activeIndex=this.getItemIndex(this.$active=this.$element.find(".item.active"));return pos>this.$items.length-1||0>pos?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){that.to(pos)}):activeIndex==pos?this.pause().cycle():this.slide(pos>activeIndex?"next":"prev",this.$items.eq(pos))},Carousel.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},Carousel.prototype.next=function(){return this.sliding?void 0:this.slide("next")},Carousel.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},Carousel.prototype.slide=function(type,next){var $active=this.$element.find(".item.active"),$next=next||this.getItemForDirection(type,$active),isCycling=this.interval,direction="next"==type?"left":"right",that=this;if($next.hasClass("active"))return this.sliding=!1;var relatedTarget=$next[0],slideEvent=$.Event("slide.bs.carousel",{relatedTarget:relatedTarget,direction:direction});if(this.$element.trigger(slideEvent),!slideEvent.isDefaultPrevented()){if(this.sliding=!0,isCycling&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var $nextIndicator=$(this.$indicators.children()[this.getItemIndex($next)]);$nextIndicator&&$nextIndicator.addClass("active")}var slidEvent=$.Event("slid.bs.carousel",{relatedTarget:relatedTarget,direction:direction});return $.support.transition&&this.$element.hasClass("slide")?($next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$active.one("bsTransitionEnd",function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" ")),that.sliding=!1,setTimeout(function(){that.$element.trigger(slidEvent)},0)}).emulateTransitionEnd(Carousel.TRANSITION_DURATION)):($active.removeClass("active"),$next.addClass("active"),this.sliding=!1,this.$element.trigger(slidEvent)),isCycling&&this.cycle(),this}};var old=$.fn.carousel;$.fn.carousel=Plugin,$.fn.carousel.Constructor=Carousel,$.fn.carousel.noConflict=function(){return $.fn.carousel=old,this};var clickHandler=function(e){var href,$this=$(this),$target=$($this.attr("data-target")||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""));if($target.hasClass("carousel")){var options=$.extend({},$target.data(),$this.data()),slideIndex=$this.attr("data-slide-to");slideIndex&&(options.interval=!1),Plugin.call($target,options),slideIndex&&$target.data("bs.carousel").to(slideIndex),e.preventDefault()}};$(document).on("click.bs.carousel.data-api","[data-slide]",clickHandler).on("click.bs.carousel.data-api","[data-slide-to]",clickHandler),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var $carousel=$(this);Plugin.call($carousel,$carousel.data())})})}(jQuery),+function($){"use strict";function getTargetFromTrigger($trigger){var href,target=$trigger.attr("data-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"");return $(target)}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&/show|hide/.test(option)&&(options.toggle=!1),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.$trigger=$('[data-toggle="collapse"][href="#'+element.id+'"],[data-toggle="collapse"][data-target="#'+element.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};Collapse.VERSION="3.3.4",Collapse.TRANSITION_DURATION=350,Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var activesData,actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(actives&&actives.length&&(activesData=actives.data("bs.collapse"),activesData&&activesData.transitioning))){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){actives&&actives.length&&(Plugin.call(actives,"hide"),activesData||actives.data("bs.collapse",null));var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return $.support.transition?void this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION):complete.call(this)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},Collapse.prototype.getParent=function(){return $(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each($.proxy(function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)},this)).end()},Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen),$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin,$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var $this=$(this);$this.attr("data-target")||e.preventDefault();var $target=getTargetFromTrigger($this),data=$target.data("bs.collapse"),option=data?"toggle":$this.data();Plugin.call($target,option)})}(jQuery),+function($){"use strict";function clearMenus(e){e&&3===e.which||($(backdrop).remove(),$(toggle).each(function(){var $this=$(this),$parent=getParent($this),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||($this.attr("aria-expanded","false"),$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget)))}))}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})}var backdrop=".dropdown-backdrop",toggle='[data-toggle="dropdown"]',Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.VERSION="3.3.4",Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$this.trigger("focus").attr("aria-expanded","true"),$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget)}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive&&27!=e.which||isActive&&27==e.which)return 27==e.which&&$parent.find(toggle).trigger("focus"),$this.trigger("click");var desc=" li:not(.disabled):visible a",$items=$parent.find('[role="menu"]'+desc+', [role="listbox"]'+desc);if($items.length){var index=$items.index(e.target);38==e.which&&index>0&&index--,40==e.which&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).trigger("focus")}}}};var old=$.fn.dropdown;$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle,Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',Dropdown.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',Dropdown.prototype.keydown)}(jQuery),+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options,this.$body=$(document.body),this.$element=$(element),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.3.4",Modal.TRANSITION_DURATION=300,Modal.BACKDROP_TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){that.$element.one("mouseup.dismiss.bs.modal",function(e){$(e.target).is(that.$element)&&(that.ignoreBackdropClick=!0)})}),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body),that.$element.show().scrollTop(0),that.adjustDialog(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$dialog.one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.$body.removeClass("modal-open"),that.resetAdjustments(),that.resetScrollbar(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop(),callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()}else callback&&callback()},Modal.prototype.handleUpdate=function(){this.adjustDialog()},Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})},Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},Modal.prototype.checkScrollbar=function(){var fullWindowWidth=window.innerWidth;if(!fullWindowWidth){var documentElementRect=document.documentElement.getBoundingClientRect();fullWindowWidth=documentElementRect.right-Math.abs(documentElementRect.left)}this.bodyIsOverflowing=document.body.clientWidth<fullWindowWidth,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var bodyPad=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",bodyPad+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},Modal.prototype.measureScrollbar=function(){var scrollDiv=document.createElement("div");scrollDiv.className="modal-scrollbar-measure",this.$body.append(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;return this.$body[0].removeChild(scrollDiv),scrollbarWidth};var old=$.fn.modal;$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})}),Plugin.call($target,option,this)})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||!/destroy|hide/.test(option))&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})}var Tooltip=function(element,options){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",element,options)};Tooltip.VERSION="3.3.4",Tooltip.TRANSITION_DURATION=150,Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},Tooltip.prototype.init=function(type,element,options){if(this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.$viewport=this.options.viewport&&$(this.options.viewport.selector||this.options.viewport),this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self&&self.$tip&&self.$tip.is(":visible")?void(self.hoverState="in"):(self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show())},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget).data("bs."+this.type);return self||(self=new this.constructor(obj.currentTarget,this.getDelegateOptions()),$(obj.currentTarget).data("bs."+this.type,self)),clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var inDom=$.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!inDom)return;var that=this,$tip=this.tip(),tipId=this.getUID(this.type);this.setContent(),$tip.attr("id",tipId),this.$element.attr("aria-describedby",tipId),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement).data("bs."+this.type,this),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var orgPlacement=placement,$container=this.options.container?$(this.options.container):this.$element.parent(),containerDim=this.getPosition($container);placement="bottom"==placement&&pos.bottom+actualHeight>containerDim.bottom?"top":"top"==placement&&pos.top-actualHeight<containerDim.top?"bottom":"right"==placement&&pos.right+actualWidth>containerDim.width?"left":"left"==placement&&pos.left-actualWidth<containerDim.left?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement);var complete=function(){var prevHoverState=that.hoverState;that.$element.trigger("shown.bs."+that.type),that.hoverState=null,"out"==prevHoverState&&that.leave(that)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var $tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight);var delta=this.getViewportAdjustedDelta(placement,offset,actualWidth,actualHeight);delta.left?offset.left+=delta.left:offset.top+=delta.top;var isVertical=/top|bottom/.test(placement),arrowDelta=isVertical?2*delta.left-width+actualWidth:2*delta.top-height+actualHeight,arrowOffsetPosition=isVertical?"offsetWidth":"offsetHeight";$tip.offset(offset),this.replaceArrow(arrowDelta,$tip[0][arrowOffsetPosition],isVertical)},Tooltip.prototype.replaceArrow=function(delta,dimension,isVertical){this.arrow().css(isVertical?"left":"top",50*(1-delta/dimension)+"%").css(isVertical?"top":"left","")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(callback){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.removeAttr("aria-describedby").trigger("hidden.bs."+that.type),callback&&callback()}var that=this,$tip=$(this.$tip),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&$tip.hasClass("fade")?$tip.one("bsTransitionEnd",complete).emulateTransitionEnd(Tooltip.TRANSITION_DURATION):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function($element){$element=$element||this.$element;var el=$element[0],isBody="BODY"==el.tagName,elRect=el.getBoundingClientRect();null==elRect.width&&(elRect=$.extend({},elRect,{width:elRect.right-elRect.left,height:elRect.bottom-elRect.top}));var elOffset=isBody?{top:0,left:0}:$element.offset(),scroll={scroll:isBody?document.documentElement.scrollTop||document.body.scrollTop:$element.scrollTop()},outerDims=isBody?{width:$(window).width(),height:$(window).height()}:null;return $.extend({},elRect,scroll,outerDims,elOffset)},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getViewportAdjustedDelta=function(placement,pos,actualWidth,actualHeight){var delta={top:0,left:0};if(!this.$viewport)return delta;var viewportPadding=this.options.viewport&&this.options.viewport.padding||0,viewportDimensions=this.getPosition(this.$viewport);if(/right|left/.test(placement)){var topEdgeOffset=pos.top-viewportPadding-viewportDimensions.scroll,bottomEdgeOffset=pos.top+viewportPadding-viewportDimensions.scroll+actualHeight;
topEdgeOffset<viewportDimensions.top?delta.top=viewportDimensions.top-topEdgeOffset:bottomEdgeOffset>viewportDimensions.top+viewportDimensions.height&&(delta.top=viewportDimensions.top+viewportDimensions.height-bottomEdgeOffset)}else{var leftEdgeOffset=pos.left-viewportPadding,rightEdgeOffset=pos.left+viewportPadding+actualWidth;leftEdgeOffset<viewportDimensions.left?delta.left=viewportDimensions.left-leftEdgeOffset:rightEdgeOffset>viewportDimensions.width&&(delta.left=viewportDimensions.left+viewportDimensions.width-rightEdgeOffset)}return delta},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.getUID=function(prefix){do prefix+=~~(1e6*Math.random());while(document.getElementById(prefix));return prefix},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=this;e&&(self=$(e.currentTarget).data("bs."+this.type),self||(self=new this.constructor(e.currentTarget,this.getDelegateOptions()),$(e.currentTarget).data("bs."+this.type,self))),self.tip().hasClass("in")?self.leave(self):self.enter(self)},Tooltip.prototype.destroy=function(){var that=this;clearTimeout(this.timeout),this.hide(function(){that.$element.off("."+that.type).removeData("bs."+that.type)})};var old=$.fn.tooltip;$.fn.tooltip=Plugin,$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.popover"),options="object"==typeof option&&option;(data||!/destroy|hide/.test(option))&&(data||$this.data("bs.popover",data=new Popover(this,options)),"string"==typeof option&&data[option]())})}var Popover=function(element,options){this.init("popover",element,options)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");Popover.VERSION="3.3.4",Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),Popover.prototype.constructor=Popover,Popover.prototype.getDefaults=function(){return Popover.DEFAULTS},Popover.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof content?"html":"append":"text"](content),$tip.removeClass("fade top bottom left right in"),$tip.find(".popover-title").html()||$tip.find(".popover-title").hide()},Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()},Popover.prototype.getContent=function(){var $e=this.$element,o=this.options;return $e.attr("data-content")||("function"==typeof o.content?o.content.call($e[0]):o.content)},Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var old=$.fn.popover;$.fn.popover=Plugin,$.fn.popover.Constructor=Popover,$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(jQuery),+function($){"use strict";function ScrollSpy(element,options){this.$body=$(document.body),this.$scrollElement=$($(element).is(document.body)?window:element),this.options=$.extend({},ScrollSpy.DEFAULTS,options),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",$.proxy(this.process,this)),this.refresh(),this.process()}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.scrollspy"),options="object"==typeof option&&option;data||$this.data("bs.scrollspy",data=new ScrollSpy(this,options)),"string"==typeof option&&data[option]()})}ScrollSpy.VERSION="3.3.4",ScrollSpy.DEFAULTS={offset:10},ScrollSpy.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},ScrollSpy.prototype.refresh=function(){var that=this,offsetMethod="offset",offsetBase=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),$.isWindow(this.$scrollElement[0])||(offsetMethod="position",offsetBase=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var $el=$(this),href=$el.data("target")||$el.attr("href"),$href=/^#./.test(href)&&$(href);return $href&&$href.length&&$href.is(":visible")&&[[$href[offsetMethod]().top+offsetBase,href]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){that.offsets.push(this[0]),that.targets.push(this[1])})},ScrollSpy.prototype.process=function(){var i,scrollTop=this.$scrollElement.scrollTop()+this.options.offset,scrollHeight=this.getScrollHeight(),maxScroll=this.options.offset+scrollHeight-this.$scrollElement.height(),offsets=this.offsets,targets=this.targets,activeTarget=this.activeTarget;if(this.scrollHeight!=scrollHeight&&this.refresh(),scrollTop>=maxScroll)return activeTarget!=(i=targets[targets.length-1])&&this.activate(i);if(activeTarget&&scrollTop<offsets[0])return this.activeTarget=null,this.clear();for(i=offsets.length;i--;)activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(void 0===offsets[i+1]||scrollTop<offsets[i+1])&&this.activate(targets[i])},ScrollSpy.prototype.activate=function(target){this.activeTarget=target,this.clear();var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]',active=$(selector).parents("li").addClass("active");active.parent(".dropdown-menu").length&&(active=active.closest("li.dropdown").addClass("active")),active.trigger("activate.bs.scrollspy")},ScrollSpy.prototype.clear=function(){$(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var old=$.fn.scrollspy;$.fn.scrollspy=Plugin,$.fn.scrollspy.Constructor=ScrollSpy,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=old,this},$(window).on("load.bs.scrollspy.data-api",function(){$('[data-spy="scroll"]').each(function(){var $spy=$(this);Plugin.call($spy,$spy.data())})})}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tab");data||$this.data("bs.tab",data=new Tab(this)),"string"==typeof option&&data[option]()})}var Tab=function(element){this.element=$(element)};Tab.VERSION="3.3.4",Tab.TRANSITION_DURATION=150,Tab.prototype.show=function(){var $this=this.element,$ul=$this.closest("ul:not(.dropdown-menu)"),selector=$this.data("target");if(selector||(selector=$this.attr("href"),selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,"")),!$this.parent("li").hasClass("active")){var $previous=$ul.find(".active:last a"),hideEvent=$.Event("hide.bs.tab",{relatedTarget:$this[0]}),showEvent=$.Event("show.bs.tab",{relatedTarget:$previous[0]});if($previous.trigger(hideEvent),$this.trigger(showEvent),!showEvent.isDefaultPrevented()&&!hideEvent.isDefaultPrevented()){var $target=$(selector);this.activate($this.closest("li"),$ul),this.activate($target,$target.parent(),function(){$previous.trigger({type:"hidden.bs.tab",relatedTarget:$this[0]}),$this.trigger({type:"shown.bs.tab",relatedTarget:$previous[0]})})}}},Tab.prototype.activate=function(element,container,callback){function next(){$active.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),element.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),transition?(element[0].offsetWidth,element.addClass("in")):element.removeClass("fade"),element.parent(".dropdown-menu").length&&element.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),callback&&callback()}var $active=container.find("> .active"),transition=callback&&$.support.transition&&($active.length&&$active.hasClass("fade")||!!container.find("> .fade").length);$active.length&&transition?$active.one("bsTransitionEnd",next).emulateTransitionEnd(Tab.TRANSITION_DURATION):next(),$active.removeClass("in")};var old=$.fn.tab;$.fn.tab=Plugin,$.fn.tab.Constructor=Tab,$.fn.tab.noConflict=function(){return $.fn.tab=old,this};var clickHandler=function(e){e.preventDefault(),Plugin.call($(this),"show")};$(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',clickHandler).on("click.bs.tab.data-api",'[data-toggle="pill"]',clickHandler)}(jQuery),+function($){"use strict";function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.affix"),options="object"==typeof option&&option;data||$this.data("bs.affix",data=new Affix(this,options)),"string"==typeof option&&data[option]()})}var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(element),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};Affix.VERSION="3.3.4",Affix.RESET="affix affix-top affix-bottom",Affix.DEFAULTS={offset:0,target:window},Affix.prototype.getState=function(scrollHeight,height,offsetTop,offsetBottom){var scrollTop=this.$target.scrollTop(),position=this.$element.offset(),targetHeight=this.$target.height();if(null!=offsetTop&&"top"==this.affixed)return offsetTop>scrollTop?"top":!1;if("bottom"==this.affixed)return null!=offsetTop?scrollTop+this.unpin<=position.top?!1:"bottom":scrollHeight-offsetBottom>=scrollTop+targetHeight?!1:"bottom";var initializing=null==this.affixed,colliderTop=initializing?scrollTop:position.top,colliderHeight=initializing?targetHeight:height;return null!=offsetTop&&offsetTop>=scrollTop?"top":null!=offsetBottom&&colliderTop+colliderHeight>=scrollHeight-offsetBottom?"bottom":!1},Affix.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(Affix.RESET).addClass("affix");var scrollTop=this.$target.scrollTop(),position=this.$element.offset();return this.pinnedOffset=position.top-scrollTop},Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},Affix.prototype.checkPosition=function(){if(this.$element.is(":visible")){var height=this.$element.height(),offset=this.options.offset,offsetTop=offset.top,offsetBottom=offset.bottom,scrollHeight=$(document.body).height();"object"!=typeof offset&&(offsetBottom=offsetTop=offset),"function"==typeof offsetTop&&(offsetTop=offset.top(this.$element)),"function"==typeof offsetBottom&&(offsetBottom=offset.bottom(this.$element));var affix=this.getState(scrollHeight,height,offsetTop,offsetBottom);if(this.affixed!=affix){null!=this.unpin&&this.$element.css("top","");var affixType="affix"+(affix?"-"+affix:""),e=$.Event(affixType+".bs.affix");if(this.$element.trigger(e),e.isDefaultPrevented())return;this.affixed=affix,this.unpin="bottom"==affix?this.getPinnedOffset():null,this.$element.removeClass(Affix.RESET).addClass(affixType).trigger(affixType.replace("affix","affixed")+".bs.affix")}"bottom"==affix&&this.$element.offset({top:scrollHeight-height-offsetBottom})}};var old=$.fn.affix;$.fn.affix=Plugin,$.fn.affix.Constructor=Affix,$.fn.affix.noConflict=function(){return $.fn.affix=old,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var $spy=$(this),data=$spy.data();data.offset=data.offset||{},null!=data.offsetBottom&&(data.offset.bottom=data.offsetBottom),null!=data.offsetTop&&(data.offset.top=data.offsetTop),Plugin.call($spy,data)})})}(jQuery),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports?module.exports=factory(require("jquery")):root.bootbox=factory(root.jQuery)}(this,function init($,undefined){"use strict";function _t(key){var locale=locales[defaults.locale];return locale?locale[key]:locales.en[key]}function processCallback(e,dialog,callback){e.stopPropagation(),e.preventDefault();var preserveDialog=$.isFunction(callback)&&callback.call(dialog,e)===!1;preserveDialog||dialog.modal("hide")}function getKeyLength(obj){var k,t=0;for(k in obj)t++;return t}function each(collection,iterator){var index=0;$.each(collection,function(key,value){iterator(key,value,index++)})}function sanitize(options){var buttons,total;if("object"!=typeof options)throw new Error("Please supply an object of options");if(!options.message)throw new Error("Please specify a message");return options=$.extend({},defaults,options),options.buttons||(options.buttons={}),buttons=options.buttons,total=getKeyLength(buttons),each(buttons,function(key,button,index){if($.isFunction(button)&&(button=buttons[key]={callback:button}),"object"!==$.type(button))throw new Error("button with key "+key+" must be an object");button.label||(button.label=key),button.className||(2>=total&&index===total-1?button.className="btn-primary":button.className="btn-default")}),options}function mapArguments(args,properties){var argn=args.length,options={};if(1>argn||argn>2)throw new Error("Invalid argument length");return 2===argn||"string"==typeof args[0]?(options[properties[0]]=args[0],options[properties[1]]=args[1]):options=args[0],options}function mergeArguments(defaults,args,properties){return $.extend(!0,{},defaults,mapArguments(args,properties))}function mergeDialogOptions(className,labels,properties,args){var baseOptions={className:"bootbox-"+className,buttons:createLabels.apply(null,labels)};return validateButtons(mergeArguments(baseOptions,args,properties),labels)}function createLabels(){for(var buttons={},i=0,j=arguments.length;j>i;i++){var argument=arguments[i],key=argument.toLowerCase(),value=argument.toUpperCase();buttons[key]={label:_t(value)}}return buttons}function validateButtons(options,buttons){var allowedButtons={};return each(buttons,function(key,value){allowedButtons[value]=!0}),each(options.buttons,function(key){if(allowedButtons[key]===undefined)throw new Error("button key "+key+" is not allowed (options are "+buttons.join("\n")+")")}),options}var templates={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},defaults={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body"},exports={};exports.alert=function(){var options;if(options=mergeDialogOptions("alert",["ok"],["message","callback"],arguments),options.callback&&!$.isFunction(options.callback))throw new Error("alert requires callback property to be a function when provided");return options.buttons.ok.callback=options.onEscape=function(){return $.isFunction(options.callback)?options.callback.call(this):!0},exports.dialog(options)},exports.confirm=function(){var options;if(options=mergeDialogOptions("confirm",["cancel","confirm"],["message","callback"],arguments),options.buttons.cancel.callback=options.onEscape=function(){return options.callback.call(this,!1)},options.buttons.confirm.callback=function(){return options.callback.call(this,!0)},!$.isFunction(options.callback))throw new Error("confirm requires a callback");return exports.dialog(options)},exports.prompt=function(){var options,defaults,dialog,form,input,shouldShow,inputOptions;if(form=$(templates.form),defaults={className:"bootbox-prompt",buttons:createLabels("cancel","confirm"),value:"",inputType:"text"},options=validateButtons(mergeArguments(defaults,arguments,["title","callback"]),["cancel","confirm"]),shouldShow=options.show===undefined?!0:options.show,options.message=form,options.buttons.cancel.callback=options.onEscape=function(){return options.callback.call(this,null)},options.buttons.confirm.callback=function(){var value;switch(options.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":value=input.val();break;case"checkbox":var checkedItems=input.find("input:checked");value=[],each(checkedItems,function(_,item){value.push($(item).val())})}return options.callback.call(this,value)},options.show=!1,!options.title)throw new Error("prompt requires a title");if(!$.isFunction(options.callback))throw new Error("prompt requires a callback");if(!templates.inputs[options.inputType])throw new Error("invalid prompt type");switch(input=$(templates.inputs[options.inputType]),options.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":input.val(options.value);break;case"select":var groups={};if(inputOptions=options.inputOptions||[],!$.isArray(inputOptions))throw new Error("Please pass an array of input options");if(!inputOptions.length)throw new Error("prompt with select requires options");each(inputOptions,function(_,option){var elem=input;if(option.value===undefined||option.text===undefined)throw new Error("given options in wrong format");option.group&&(groups[option.group]||(groups[option.group]=$("<optgroup/>").attr("label",option.group)),elem=groups[option.group]),elem.append("<option value='"+option.value+"'>"+option.text+"</option>")}),each(groups,function(_,group){input.append(group)}),input.val(options.value);break;case"checkbox":var values=$.isArray(options.value)?options.value:[options.value];if(inputOptions=options.inputOptions||[],!inputOptions.length)throw new Error("prompt with checkbox requires options");if(!inputOptions[0].value||!inputOptions[0].text)throw new Error("given options in wrong format");input=$("<div/>"),each(inputOptions,function(_,option){var checkbox=$(templates.inputs[options.inputType]);checkbox.find("input").attr("value",option.value),checkbox.find("label").append(option.text),each(values,function(_,value){value===option.value&&checkbox.find("input").prop("checked",!0)}),input.append(checkbox)})}return options.placeholder&&input.attr("placeholder",options.placeholder),options.pattern&&input.attr("pattern",options.pattern),options.maxlength&&input.attr("maxlength",options.maxlength),form.append(input),form.on("submit",function(e){e.preventDefault(),e.stopPropagation(),dialog.find(".btn-primary").click()}),dialog=exports.dialog(options),dialog.off("shown.bs.modal"),dialog.on("shown.bs.modal",function(){input.focus()}),shouldShow===!0&&dialog.modal("show"),dialog},exports.dialog=function(options){options=sanitize(options);var dialog=$(templates.dialog),innerDialog=dialog.find(".modal-dialog"),body=dialog.find(".modal-body"),buttons=options.buttons,buttonStr="",callbacks={onEscape:options.onEscape};if($.fn.modal===undefined)throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.");if(each(buttons,function(key,button){buttonStr+="<button data-bb-handler='"+key+"' type='button' class='btn "+button.className+"'>"+button.label+"</button>",callbacks[key]=button.callback}),body.find(".bootbox-body").html(options.message),options.animate===!0&&dialog.addClass("fade"),options.className&&dialog.addClass(options.className),"large"===options.size?innerDialog.addClass("modal-lg"):"small"===options.size&&innerDialog.addClass("modal-sm"),options.title&&body.before(templates.header),options.closeButton){var closeButton=$(templates.closeButton);options.title?dialog.find(".modal-header").prepend(closeButton):closeButton.css("margin-top","-10px").prependTo(body)}return options.title&&dialog.find(".modal-title").html(options.title),buttonStr.length&&(body.after(templates.footer),dialog.find(".modal-footer").html(buttonStr)),dialog.on("hidden.bs.modal",function(e){e.target===this&&dialog.remove()}),dialog.on("shown.bs.modal",function(){dialog.find(".btn-primary:first").focus()}),"static"!==options.backdrop&&dialog.on("click.dismiss.bs.modal",function(e){dialog.children(".modal-backdrop").length&&(e.currentTarget=dialog.children(".modal-backdrop").get(0)),e.target===e.currentTarget&&dialog.trigger("escape.close.bb")}),dialog.on("escape.close.bb",function(e){callbacks.onEscape&&processCallback(e,dialog,callbacks.onEscape)}),dialog.on("click",".modal-footer button",function(e){var callbackKey=$(this).data("bb-handler");processCallback(e,dialog,callbacks[callbackKey])}),dialog.on("click",".bootbox-close-button",function(e){processCallback(e,dialog,callbacks.onEscape)}),dialog.on("keyup",function(e){27===e.which&&dialog.trigger("escape.close.bb")}),$(options.container).append(dialog),dialog.modal({backdrop:options.backdrop?"static":!1,keyboard:!1,show:!1}),options.show&&dialog.modal("show"),dialog},exports.setDefaults=function(){var values={};2===arguments.length?values[arguments[0]]=arguments[1]:values=arguments[0],$.extend(defaults,values)},exports.hideAll=function(){return $(".bootbox").modal("hide"),exports};var locales={bg_BG:{OK:"",CANCEL:"",CONFIRM:""},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zruit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"",CANCEL:"",CONFIRM:""},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"",CANCEL:"",CONFIRM:""},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"",CANCEL:"",CONFIRM:""},hu:{OK:"OK",CANCEL:"Mgsem",CONFIRM:"Megerst"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"",CONFIRM:""},lt:{OK:"Gerai",CANCEL:"Ataukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprint"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierd"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"",CONFIRM:""},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},th:{OK:"",CANCEL:"",CONFIRM:""},tr:{OK:"Tamam",CANCEL:"ptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"",CONFIRM:""},zh_TW:{OK:"OK",CANCEL:"",CONFIRM:""}};return exports.addLocale=function(name,values){return $.each(["OK","CANCEL","CONFIRM"],function(_,v){if(!values[v])throw new Error("Please supply a translation for '"+v+"'")}),locales[name]={OK:values.OK,CANCEL:values.CANCEL,CONFIRM:values.CONFIRM},exports},exports.removeLocale=function(name){return delete locales[name],exports},exports.setLocale=function(name){return exports.setDefaults("locale",name)},exports.init=function(_$){return init(_$||$)},exports}),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory("object"==typeof exports?require("jquery"):jQuery)}(function(jQuery){var S2=function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var S2=jQuery.fn.select2.amd;var S2;return function(){if(!S2||!S2.requirejs){S2?require=S2:S2={};var requirejs,require,define;!function(undef){function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name&&"."===name.charAt(0))if(baseName){for(baseParts=baseParts.slice(0,baseParts.length-1),name=name.split("/"),lastIndex=name.length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),name=baseParts.concat(name),i=0;i<name.length;i+=1)if(part=name[i],"."===part)name.splice(i,1),i-=1;else if(".."===part){if(1===i&&(".."===name[2]||".."===name[0]))break;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}else 0===name.indexOf("./")&&(name=name.substring(2));if((baseParts||starMap)&&map){for(nameParts=name.split("/"),i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=map[baseParts.slice(0,j).join("/")],mapValue&&(mapValue=mapValue[nameSegment])){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name))throw new Error("No "+name);return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];return name=parts[1],prefix&&(prefix=normalize(prefix,relName),plugin=callDep(prefix)),prefix?name=plugin&&plugin.normalize?plugin.normalize(name,makeNormalize(relName)):normalize(name,relName):(name=normalize(name,relName),parts=splitPrefix(name),prefix=parts[0],name=parts[1],prefix&&(plugin=callDep(prefix))),{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}},handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];return"undefined"!=typeof e?e:defined[name]={}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}},main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,usingExports,args=[],callbackType=typeof callback;if(relName=relName||name,"undefined"===callbackType||"function"===callbackType){for(deps=!deps.length&&callback.length?["require","exports","module"]:deps,i=0;i<deps.length;i+=1)if(map=makeMap(deps[i],relName),depName=map.f,"require"===depName)args[i]=handlers.require(name);else if("exports"===depName)args[i]=handlers.exports(name),usingExports=!0;else if("module"===depName)cjsModule=args[i]=handlers.module(name);else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName))args[i]=callDep(depName);else{if(!map.p)throw new Error(name+" missing "+depName);map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName]}ret=callback?callback.apply(defined[name],args):void 0,name&&(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]?defined[name]=cjsModule.exports:ret===undef&&usingExports||(defined[name]=ret))}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync,alt){if("string"==typeof deps)return handlers[deps]?handlers[deps](callback):callDep(makeMap(deps,callback).f);if(!deps.splice){if(config=deps,config.deps&&req(config.deps,config.callback),!callback)return;callback.splice?(deps=callback,callback=relName,relName=null):deps=undef}return callback=callback||function(){},"function"==typeof relName&&(relName=forceSync,forceSync=alt),forceSync?main(undef,deps,callback,relName):setTimeout(function(){main(undef,deps,callback,relName)},4),req},req.config=function(cfg){return req(cfg)},requirejs._defined=defined,define=function(name,deps,callback){deps.splice||(callback=deps,deps=[]),hasProp(defined,name)||hasProp(waiting,name)||(waiting[name]=[name,deps,callback])},define.amd={jQuery:!0}}(),S2.requirejs=requirejs,S2.require=require,S2.define=define}}(),S2.define("almond",function(){}),S2.define("jquery",[],function(){var _$=jQuery||$;return null==_$&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),_$}),S2.define("select2/utils",["jquery"],function($){function getMethods(theClass){var proto=theClass.prototype,methods=[];for(var methodName in proto){var m=proto[methodName];"function"==typeof m&&"constructor"!==methodName&&methods.push(methodName)}return methods}var Utils={};Utils.Extend=function(ChildClass,SuperClass){function BaseConstructor(){this.constructor=ChildClass}var __hasProp={}.hasOwnProperty;for(var key in SuperClass)__hasProp.call(SuperClass,key)&&(ChildClass[key]=SuperClass[key]);return BaseConstructor.prototype=SuperClass.prototype,ChildClass.prototype=new BaseConstructor,ChildClass.__super__=SuperClass.prototype,ChildClass},Utils.Decorate=function(SuperClass,DecoratorClass){function DecoratedClass(){var unshift=Array.prototype.unshift,argCount=DecoratorClass.prototype.constructor.length,calledConstructor=SuperClass.prototype.constructor;argCount>0&&(unshift.call(arguments,SuperClass.prototype.constructor),calledConstructor=DecoratorClass.prototype.constructor),calledConstructor.apply(this,arguments)}function ctr(){this.constructor=DecoratedClass}var decoratedMethods=getMethods(DecoratorClass),superMethods=getMethods(SuperClass);DecoratorClass.displayName=SuperClass.displayName,DecoratedClass.prototype=new ctr;for(var m=0;m<superMethods.length;m++){var superMethod=superMethods[m];DecoratedClass.prototype[superMethod]=SuperClass.prototype[superMethod]}for(var calledMethod=(function(methodName){var originalMethod=function(){};methodName in DecoratedClass.prototype&&(originalMethod=DecoratedClass.prototype[methodName]);var decoratedMethod=DecoratorClass.prototype[methodName];return function(){var unshift=Array.prototype.unshift;return unshift.call(arguments,originalMethod),decoratedMethod.apply(this,arguments)}}),d=0;d<decoratedMethods.length;d++){var decoratedMethod=decoratedMethods[d];DecoratedClass.prototype[decoratedMethod]=calledMethod(decoratedMethod)}return DecoratedClass;
};var Observable=function(){this.listeners={}};return Observable.prototype.on=function(event,callback){this.listeners=this.listeners||{},event in this.listeners?this.listeners[event].push(callback):this.listeners[event]=[callback]},Observable.prototype.trigger=function(event){var slice=Array.prototype.slice;this.listeners=this.listeners||{},event in this.listeners&&this.invoke(this.listeners[event],slice.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},Observable.prototype.invoke=function(listeners,params){for(var i=0,len=listeners.length;len>i;i++)listeners[i].apply(this,params)},Utils.Observable=Observable,Utils.generateChars=function(length){for(var chars="",i=0;length>i;i++){var randomChar=Math.floor(36*Math.random());chars+=randomChar.toString(36)}return chars},Utils.bind=function(func,context){return function(){func.apply(context,arguments)}},Utils._convertData=function(data){for(var originalKey in data){var keys=originalKey.split("-"),dataLevel=data;if(1!==keys.length){for(var k=0;k<keys.length;k++){var key=keys[k];key=key.substring(0,1).toLowerCase()+key.substring(1),key in dataLevel||(dataLevel[key]={}),k==keys.length-1&&(dataLevel[key]=data[originalKey]),dataLevel=dataLevel[key]}delete data[originalKey]}}return data},Utils.hasScroll=function(index,el){var $el=$(el),overflowX=el.style.overflowX,overflowY=el.style.overflowY;return overflowX!==overflowY||"hidden"!==overflowY&&"visible"!==overflowY?"scroll"===overflowX||"scroll"===overflowY?!0:$el.innerHeight()<el.scrollHeight||$el.innerWidth()<el.scrollWidth:!1},Utils.escapeMarkup=function(markup){var replaceMap={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof markup?markup:String(markup).replace(/[&<>"'\/\\]/g,function(match){return replaceMap[match]})},Utils.appendMany=function($element,$nodes){if("1.7"===$.fn.jquery.substr(0,3)){var $jqNodes=$();$.map($nodes,function(node){$jqNodes=$jqNodes.add(node)}),$nodes=$jqNodes}$element.append($nodes)},Utils}),S2.define("select2/results",["jquery","./utils"],function($,Utils){function Results($element,options,dataAdapter){this.$element=$element,this.data=dataAdapter,this.options=options,Results.__super__.constructor.call(this)}return Utils.Extend(Results,Utils.Observable),Results.prototype.render=function(){var $results=$('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&$results.attr("aria-multiselectable","true"),this.$results=$results,$results},Results.prototype.clear=function(){this.$results.empty()},Results.prototype.displayMessage=function(params){var escapeMarkup=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var $message=$('<li role="treeitem" class="select2-results__option"></li>'),message=this.options.get("translations").get(params.message);$message.append(escapeMarkup(message(params.args))),this.$results.append($message)},Results.prototype.append=function(data){this.hideLoading();var $options=[];if(null==data.results||0===data.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));data.results=this.sort(data.results);for(var d=0;d<data.results.length;d++){var item=data.results[d],$option=this.option(item);$options.push($option)}this.$results.append($options)},Results.prototype.position=function($results,$dropdown){var $resultsContainer=$dropdown.find(".select2-results");$resultsContainer.append($results)},Results.prototype.sort=function(data){var sorter=this.options.get("sorter");return sorter(data)},Results.prototype.setClasses=function(){var self=this;this.data.current(function(selected){var selectedIds=$.map(selected,function(s){return s.id.toString()}),$options=self.$results.find(".select2-results__option[aria-selected]");$options.each(function(){var $option=$(this),item=$.data(this,"data"),id=""+item.id;null!=item.element&&item.element.selected||null==item.element&&$.inArray(id,selectedIds)>-1?$option.attr("aria-selected","true"):$option.attr("aria-selected","false")});var $selected=$options.filter("[aria-selected=true]");$selected.length>0?$selected.first().trigger("mouseenter"):$options.first().trigger("mouseenter")})},Results.prototype.showLoading=function(params){this.hideLoading();var loadingMore=this.options.get("translations").get("searching"),loading={disabled:!0,loading:!0,text:loadingMore(params)},$loading=this.option(loading);$loading.className+=" loading-results",this.$results.prepend($loading)},Results.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},Results.prototype.option=function(data){var option=document.createElement("li");option.className="select2-results__option";var attrs={role:"treeitem","aria-selected":"false"};data.disabled&&(delete attrs["aria-selected"],attrs["aria-disabled"]="true"),null==data.id&&delete attrs["aria-selected"],null!=data._resultId&&(option.id=data._resultId),data.title&&(option.title=data.title),data.children&&(attrs.role="group",attrs["aria-label"]=data.text,delete attrs["aria-selected"]);for(var attr in attrs){var val=attrs[attr];option.setAttribute(attr,val)}if(data.children){var $option=$(option),label=document.createElement("strong");label.className="select2-results__group";$(label);this.template(data,label);for(var $children=[],c=0;c<data.children.length;c++){var child=data.children[c],$child=this.option(child);$children.push($child)}var $childrenContainer=$("<ul></ul>",{"class":"select2-results__options select2-results__options--nested"});$childrenContainer.append($children),$option.append(label),$option.append($childrenContainer)}else this.template(data,option);return $.data(option,"data",data),option},Results.prototype.bind=function(container,$container){var self=this,id=container.id+"-results";this.$results.attr("id",id),container.on("results:all",function(params){self.clear(),self.append(params.data),container.isOpen()&&self.setClasses()}),container.on("results:append",function(params){self.append(params.data),container.isOpen()&&self.setClasses()}),container.on("query",function(params){self.showLoading(params)}),container.on("select",function(){container.isOpen()&&self.setClasses()}),container.on("unselect",function(){container.isOpen()&&self.setClasses()}),container.on("open",function(){self.$results.attr("aria-expanded","true"),self.$results.attr("aria-hidden","false"),self.setClasses(),self.ensureHighlightVisible()}),container.on("close",function(){self.$results.attr("aria-expanded","false"),self.$results.attr("aria-hidden","true"),self.$results.removeAttr("aria-activedescendant")}),container.on("results:toggle",function(){var $highlighted=self.getHighlightedResults();0!==$highlighted.length&&$highlighted.trigger("mouseup")}),container.on("results:select",function(){var $highlighted=self.getHighlightedResults();if(0!==$highlighted.length){var data=$highlighted.data("data");"true"==$highlighted.attr("aria-selected")?self.trigger("close"):self.trigger("select",{data:data})}}),container.on("results:previous",function(){var $highlighted=self.getHighlightedResults(),$options=self.$results.find("[aria-selected]"),currentIndex=$options.index($highlighted);if(0!==currentIndex){var nextIndex=currentIndex-1;0===$highlighted.length&&(nextIndex=0);var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top,nextTop=$next.offset().top,nextOffset=self.$results.scrollTop()+(nextTop-currentOffset);0===nextIndex?self.$results.scrollTop(0):0>nextTop-currentOffset&&self.$results.scrollTop(nextOffset)}}),container.on("results:next",function(){var $highlighted=self.getHighlightedResults(),$options=self.$results.find("[aria-selected]"),currentIndex=$options.index($highlighted),nextIndex=currentIndex+1;if(!(nextIndex>=$options.length)){var $next=$options.eq(nextIndex);$next.trigger("mouseenter");var currentOffset=self.$results.offset().top+self.$results.outerHeight(!1),nextBottom=$next.offset().top+$next.outerHeight(!1),nextOffset=self.$results.scrollTop()+nextBottom-currentOffset;0===nextIndex?self.$results.scrollTop(0):nextBottom>currentOffset&&self.$results.scrollTop(nextOffset)}}),container.on("results:focus",function(params){params.element.addClass("select2-results__option--highlighted")}),container.on("results:message",function(params){self.displayMessage(params)}),$.fn.mousewheel&&this.$results.on("mousewheel",function(e){var top=self.$results.scrollTop(),bottom=self.$results.get(0).scrollHeight-self.$results.scrollTop()+e.deltaY,isAtTop=e.deltaY>0&&top-e.deltaY<=0,isAtBottom=e.deltaY<0&&bottom<=self.$results.height();isAtTop?(self.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):isAtBottom&&(self.$results.scrollTop(self.$results.get(0).scrollHeight-self.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(evt){var $this=$(this),data=$this.data("data");return"true"===$this.attr("aria-selected")?void(self.options.get("multiple")?self.trigger("unselect",{originalEvent:evt,data:data}):self.trigger("close")):void self.trigger("select",{originalEvent:evt,data:data})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(evt){var data=$(this).data("data");self.getHighlightedResults().removeClass("select2-results__option--highlighted"),self.trigger("results:focus",{data:data,element:$(this)})})},Results.prototype.getHighlightedResults=function(){var $highlighted=this.$results.find(".select2-results__option--highlighted");return $highlighted},Results.prototype.destroy=function(){this.$results.remove()},Results.prototype.ensureHighlightVisible=function(){var $highlighted=this.getHighlightedResults();if(0!==$highlighted.length){var $options=this.$results.find("[aria-selected]"),currentIndex=$options.index($highlighted),currentOffset=this.$results.offset().top,nextTop=$highlighted.offset().top,nextOffset=this.$results.scrollTop()+(nextTop-currentOffset),offsetDelta=nextTop-currentOffset;nextOffset-=2*$highlighted.outerHeight(!1),2>=currentIndex?this.$results.scrollTop(0):(offsetDelta>this.$results.outerHeight()||0>offsetDelta)&&this.$results.scrollTop(nextOffset)}},Results.prototype.template=function(result,container){var template=this.options.get("templateResult"),escapeMarkup=this.options.get("escapeMarkup"),content=template(result);null==content?container.style.display="none":"string"==typeof content?container.innerHTML=escapeMarkup(content):$(container).append(content)},Results}),S2.define("select2/keys",[],function(){var KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return KEYS}),S2.define("select2/selection/base",["jquery","../utils","../keys"],function($,Utils,KEYS){function BaseSelection($element,options){this.$element=$element,this.options=options,BaseSelection.__super__.constructor.call(this)}return Utils.Extend(BaseSelection,Utils.Observable),BaseSelection.prototype.render=function(){var $selection=$('<span class="select2-selection" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),$selection.attr("title",this.$element.attr("title")),$selection.attr("tabindex",this._tabindex),this.$selection=$selection,$selection},BaseSelection.prototype.bind=function(container,$container){var self=this,resultsId=(container.id+"-container",container.id+"-results");this.container=container,this.$selection.on("focus",function(evt){self.trigger("focus",evt)}),this.$selection.on("blur",function(evt){self.trigger("blur",evt)}),this.$selection.on("keydown",function(evt){self.trigger("keypress",evt),evt.which===KEYS.SPACE&&evt.preventDefault()}),container.on("results:focus",function(params){self.$selection.attr("aria-activedescendant",params.data._resultId)}),container.on("selection:update",function(params){self.update(params.data)}),container.on("open",function(){self.$selection.attr("aria-expanded","true"),self.$selection.attr("aria-owns",resultsId),self._attachCloseHandler(container)}),container.on("close",function(){self.$selection.attr("aria-expanded","false"),self.$selection.removeAttr("aria-activedescendant"),self.$selection.removeAttr("aria-owns"),self.$selection.focus(),self._detachCloseHandler(container)}),container.on("enable",function(){self.$selection.attr("tabindex",self._tabindex)}),container.on("disable",function(){self.$selection.attr("tabindex","-1")})},BaseSelection.prototype._attachCloseHandler=function(container){$(document.body).on("mousedown.select2."+container.id,function(e){var $target=$(e.target),$select=$target.closest(".select2"),$all=$(".select2.select2-container--open");$all.each(function(){var $this=$(this);if(this!=$select[0]){var $element=$this.data("element");$element.select2("close")}})})},BaseSelection.prototype._detachCloseHandler=function(container){$(document.body).off("mousedown.select2."+container.id)},BaseSelection.prototype.position=function($selection,$container){var $selectionContainer=$container.find(".selection");$selectionContainer.append($selection)},BaseSelection.prototype.destroy=function(){this._detachCloseHandler(this.container)},BaseSelection.prototype.update=function(data){throw new Error("The `update` method must be defined in child classes.")},BaseSelection}),S2.define("select2/selection/single",["jquery","./base","../utils","../keys"],function($,BaseSelection,Utils,KEYS){function SingleSelection(){SingleSelection.__super__.constructor.apply(this,arguments)}return Utils.Extend(SingleSelection,BaseSelection),SingleSelection.prototype.render=function(){var $selection=SingleSelection.__super__.render.call(this);return $selection.addClass("select2-selection--single"),$selection.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),$selection},SingleSelection.prototype.bind=function(container,$container){var self=this;SingleSelection.__super__.bind.apply(this,arguments);var id=container.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",id),this.$selection.attr("aria-labelledby",id),this.$selection.on("mousedown",function(evt){1===evt.which&&self.trigger("toggle",{originalEvent:evt})}),this.$selection.on("focus",function(evt){}),this.$selection.on("blur",function(evt){}),container.on("selection:update",function(params){self.update(params.data)})},SingleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},SingleSelection.prototype.display=function(data){var template=this.options.get("templateSelection"),escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data))},SingleSelection.prototype.selectionContainer=function(){return $("<span></span>")},SingleSelection.prototype.update=function(data){if(0===data.length)return void this.clear();var selection=data[0],formatted=this.display(selection),$rendered=this.$selection.find(".select2-selection__rendered");$rendered.empty().append(formatted),$rendered.prop("title",selection.title||selection.text)},SingleSelection}),S2.define("select2/selection/multiple",["jquery","./base","../utils"],function($,BaseSelection,Utils){function MultipleSelection($element,options){MultipleSelection.__super__.constructor.apply(this,arguments)}return Utils.Extend(MultipleSelection,BaseSelection),MultipleSelection.prototype.render=function(){var $selection=MultipleSelection.__super__.render.call(this);return $selection.addClass("select2-selection--multiple"),$selection.html('<ul class="select2-selection__rendered"></ul>'),$selection},MultipleSelection.prototype.bind=function(container,$container){var self=this;MultipleSelection.__super__.bind.apply(this,arguments),this.$selection.on("click",function(evt){self.trigger("toggle",{originalEvent:evt})}),this.$selection.on("click",".select2-selection__choice__remove",function(evt){var $remove=$(this),$selection=$remove.parent(),data=$selection.data("data");self.trigger("unselect",{originalEvent:evt,data:data})})},MultipleSelection.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},MultipleSelection.prototype.display=function(data){var template=this.options.get("templateSelection"),escapeMarkup=this.options.get("escapeMarkup");return escapeMarkup(template(data))},MultipleSelection.prototype.selectionContainer=function(){var $container=$('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return $container},MultipleSelection.prototype.update=function(data){if(this.clear(),0!==data.length){for(var $selections=[],d=0;d<data.length;d++){var selection=data[d],formatted=this.display(selection),$selection=this.selectionContainer();$selection.append(formatted),$selection.prop("title",selection.title||selection.text),$selection.data("data",selection),$selections.push($selection)}var $rendered=this.$selection.find(".select2-selection__rendered");Utils.appendMany($rendered,$selections)}},MultipleSelection}),S2.define("select2/selection/placeholder",["../utils"],function(Utils){function Placeholder(decorated,$element,options){this.placeholder=this.normalizePlaceholder(options.get("placeholder")),decorated.call(this,$element,options)}return Placeholder.prototype.normalizePlaceholder=function(_,placeholder){return"string"==typeof placeholder&&(placeholder={id:"",text:placeholder}),placeholder},Placeholder.prototype.createPlaceholder=function(decorated,placeholder){var $placeholder=this.selectionContainer();return $placeholder.html(this.display(placeholder)),$placeholder.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),$placeholder},Placeholder.prototype.update=function(decorated,data){var singlePlaceholder=1==data.length&&data[0].id!=this.placeholder.id,multipleSelections=data.length>1;if(multipleSelections||singlePlaceholder)return decorated.call(this,data);this.clear();var $placeholder=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append($placeholder)},Placeholder}),S2.define("select2/selection/allowClear",["jquery","../keys"],function($,KEYS){function AllowClear(){}return AllowClear.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(evt){self._handleClear(evt)}),container.on("keypress",function(evt){self._handleKeyboardClear(evt,container)})},AllowClear.prototype._handleClear=function(_,evt){if(!this.options.get("disabled")){var $clear=this.$selection.find(".select2-selection__clear");if(0!==$clear.length){evt.stopPropagation();for(var data=$clear.data("data"),d=0;d<data.length;d++){var unselectData={data:data[d]};if(this.trigger("unselect",unselectData),unselectData.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle")}}},AllowClear.prototype._handleKeyboardClear=function(_,evt,container){container.isOpen()||(evt.which==KEYS.DELETE||evt.which==KEYS.BACKSPACE)&&this._handleClear(evt)},AllowClear.prototype.update=function(decorated,data){if(decorated.call(this,data),!(this.$selection.find(".select2-selection__placeholder").length>0||0===data.length)){var $remove=$('<span class="select2-selection__clear">&times;</span>');$remove.data("data",data),this.$selection.find(".select2-selection__rendered").prepend($remove)}},AllowClear}),S2.define("select2/selection/search",["jquery","../utils","../keys"],function($,Utils,KEYS){function Search(decorated,$element,options){decorated.call(this,$element,options)}return Search.prototype.render=function(decorated){var $search=$('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></li>');this.$searchContainer=$search,this.$search=$search.find("input");var $rendered=decorated.call(this);return $rendered},Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("open",function(){self.$search.attr("tabindex",0),self.$search.focus()}),container.on("close",function(){self.$search.attr("tabindex",-1),self.$search.val(""),self.$search.focus()}),container.on("enable",function(){self.$search.prop("disabled",!1)}),container.on("disable",function(){self.$search.prop("disabled",!0)}),this.$selection.on("focusin",".select2-search--inline",function(evt){self.trigger("focus",evt)}),this.$selection.on("focusout",".select2-search--inline",function(evt){self.trigger("blur",evt)}),this.$selection.on("keydown",".select2-search--inline",function(evt){evt.stopPropagation(),self.trigger("keypress",evt),self._keyUpPrevented=evt.isDefaultPrevented();var key=evt.which;if(key===KEYS.BACKSPACE&&""===self.$search.val()){var $previousChoice=self.$searchContainer.prev(".select2-selection__choice");if($previousChoice.length>0){var item=$previousChoice.data("data");self.searchRemoveChoice(item),evt.preventDefault()}}}),this.$selection.on("input",".select2-search--inline",function(evt){self.$selection.off("keyup.search")}),this.$selection.on("keyup.search input",".select2-search--inline",function(evt){self.handleSearch(evt)})},Search.prototype.createPlaceholder=function(decorated,placeholder){this.$search.attr("placeholder",placeholder.text)},Search.prototype.update=function(decorated,data){this.$search.attr("placeholder",""),decorated.call(this,data),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch()},Search.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input})}this._keyUpPrevented=!1},Search.prototype.searchRemoveChoice=function(decorated,item){this.trigger("unselect",{data:item}),this.trigger("open"),this.$search.val(item.text+" ")},Search.prototype.resizeSearch=function(){this.$search.css("width","25px");var width="";if(""!==this.$search.attr("placeholder"))width=this.$selection.find(".select2-selection__rendered").innerWidth();else{var minimumWidth=this.$search.val().length+1;width=.75*minimumWidth+"em"}this.$search.css("width",width)},Search}),S2.define("select2/selection/eventRelay",["jquery"],function($){function EventRelay(){}return EventRelay.prototype.bind=function(decorated,container,$container){var self=this,relayEvents=["open","opening","close","closing","select","selecting","unselect","unselecting"],preventableEvents=["opening","closing","selecting","unselecting"];decorated.call(this,container,$container),container.on("*",function(name,params){if(-1!==$.inArray(name,relayEvents)){params=params||{};var evt=$.Event("select2:"+name,{params:params});self.$element.trigger(evt),-1!==$.inArray(name,preventableEvents)&&(params.prevented=evt.isDefaultPrevented())}})},EventRelay}),S2.define("select2/translation",["jquery","require"],function($,require){function Translation(dict){this.dict=dict||{}}return Translation.prototype.all=function(){return this.dict},Translation.prototype.get=function(key){return this.dict[key]},Translation.prototype.extend=function(translation){this.dict=$.extend({},translation.all(),this.dict)},Translation._cache={},Translation.loadPath=function(path){if(!(path in Translation._cache)){var translations=require(path);Translation._cache[path]=translations}return new Translation(Translation._cache[path])},Translation}),S2.define("select2/diacritics",[],function(){var diacritics={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};return diacritics}),S2.define("select2/data/base",["../utils"],function(Utils){function BaseAdapter($element,options){BaseAdapter.__super__.constructor.call(this)}return Utils.Extend(BaseAdapter,Utils.Observable),BaseAdapter.prototype.current=function(callback){throw new Error("The `current` method must be defined in child classes.")},BaseAdapter.prototype.query=function(params,callback){throw new Error("The `query` method must be defined in child classes.")},BaseAdapter.prototype.bind=function(container,$container){},BaseAdapter.prototype.destroy=function(){},BaseAdapter.prototype.generateResultId=function(container,data){var id=container.id+"-result-";return id+=Utils.generateChars(4),id+=null!=data.id?"-"+data.id.toString():"-"+Utils.generateChars(4)},BaseAdapter}),S2.define("select2/data/select",["./base","../utils","jquery"],function(BaseAdapter,Utils,$){function SelectAdapter($element,options){this.$element=$element,this.options=options,SelectAdapter.__super__.constructor.call(this)}return Utils.Extend(SelectAdapter,BaseAdapter),SelectAdapter.prototype.current=function(callback){var data=[],self=this;this.$element.find(":selected").each(function(){
var $option=$(this),option=self.item($option);data.push(option)}),callback(data)},SelectAdapter.prototype.select=function(data){var self=this;if(data.selected=!0,$(data.element).is("option"))return data.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(currentData){var val=[];data=[data],data.push.apply(data,currentData);for(var d=0;d<data.length;d++){var id=data[d].id;-1===$.inArray(id,val)&&val.push(id)}self.$element.val(val),self.$element.trigger("change")});else{var val=data.id;this.$element.val(val),this.$element.trigger("change")}},SelectAdapter.prototype.unselect=function(data){var self=this;if(this.$element.prop("multiple"))return data.selected=!1,$(data.element).is("option")?(data.element.selected=!1,void this.$element.trigger("change")):void this.current(function(currentData){for(var val=[],d=0;d<currentData.length;d++){var id=currentData[d].id;id!==data.id&&-1===$.inArray(id,val)&&val.push(id)}self.$element.val(val),self.$element.trigger("change")})},SelectAdapter.prototype.bind=function(container,$container){var self=this;this.container=container,container.on("select",function(params){self.select(params.data)}),container.on("unselect",function(params){self.unselect(params.data)})},SelectAdapter.prototype.destroy=function(){this.$element.find("*").each(function(){$.removeData(this,"data")})},SelectAdapter.prototype.query=function(params,callback){var data=[],self=this,$options=this.$element.children();$options.each(function(){var $option=$(this);if($option.is("option")||$option.is("optgroup")){var option=self.item($option),matches=self.matches(params,option);null!==matches&&data.push(matches)}}),callback({results:data})},SelectAdapter.prototype.addOptions=function($options){Utils.appendMany(this.$element,$options)},SelectAdapter.prototype.option=function(data){var option;data.children?(option=document.createElement("optgroup"),option.label=data.text):(option=document.createElement("option"),void 0!==option.textContent?option.textContent=data.text:option.innerText=data.text),data.id&&(option.value=data.id),data.disabled&&(option.disabled=!0),data.selected&&(option.selected=!0),data.title&&(option.title=data.title);var $option=$(option),normalizedData=this._normalizeItem(data);return normalizedData.element=option,$.data(option,"data",normalizedData),$option},SelectAdapter.prototype.item=function($option){var data={};if(data=$.data($option[0],"data"),null!=data)return data;if($option.is("option"))data={id:$option.val(),text:$option.text(),disabled:$option.prop("disabled"),selected:$option.prop("selected"),title:$option.prop("title")};else if($option.is("optgroup")){data={text:$option.prop("label"),children:[],title:$option.prop("title")};for(var $children=$option.children("option"),children=[],c=0;c<$children.length;c++){var $child=$($children[c]),child=this.item($child);children.push(child)}data.children=children}return data=this._normalizeItem(data),data.element=$option[0],$.data($option[0],"data",data),data},SelectAdapter.prototype._normalizeItem=function(item){$.isPlainObject(item)||(item={id:item,text:item}),item=$.extend({},{text:""},item);var defaults={selected:!1,disabled:!1};return null!=item.id&&(item.id=item.id.toString()),null!=item.text&&(item.text=item.text.toString()),null==item._resultId&&item.id&&null!=this.container&&(item._resultId=this.generateResultId(this.container,item)),$.extend({},defaults,item)},SelectAdapter.prototype.matches=function(params,data){var matcher=this.options.get("matcher");return matcher(params,data)},SelectAdapter}),S2.define("select2/data/array",["./select","../utils","jquery"],function(SelectAdapter,Utils,$){function ArrayAdapter($element,options){var data=options.get("data")||[];ArrayAdapter.__super__.constructor.call(this,$element,options),this.addOptions(this.convertToOptions(data))}return Utils.Extend(ArrayAdapter,SelectAdapter),ArrayAdapter.prototype.select=function(data){var $option=this.$element.find("option").filter(function(i,elm){return elm.value==data.id.toString()});0===$option.length&&($option=this.option(data),this.addOptions($option)),ArrayAdapter.__super__.select.call(this,data)},ArrayAdapter.prototype.convertToOptions=function(data){function onlyItem(item){return function(){return $(this).val()==item.id}}for(var self=this,$existing=this.$element.find("option"),existingIds=$existing.map(function(){return self.item($(this)).id}).get(),$options=[],d=0;d<data.length;d++){var item=this._normalizeItem(data[d]);if($.inArray(item.id,existingIds)>=0){var $existingOption=$existing.filter(onlyItem(item)),existingData=this.item($existingOption),$newOption=($.extend(!0,{},existingData,item),this.option(existingData));$existingOption.replaceWith($newOption)}else{var $option=this.option(item);if(item.children){var $children=this.convertToOptions(item.children);Utils.appendMany($option,$children)}$options.push($option)}}return $options},ArrayAdapter}),S2.define("select2/data/ajax",["./array","../utils","jquery"],function(ArrayAdapter,Utils,$){function AjaxAdapter($element,options){this.ajaxOptions=this._applyDefaults(options.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),ArrayAdapter.__super__.constructor.call(this,$element,options)}return Utils.Extend(AjaxAdapter,ArrayAdapter),AjaxAdapter.prototype._applyDefaults=function(options){var defaults={data:function(params){return{q:params.term}},transport:function(params,success,failure){var $request=$.ajax(params);return $request.then(success),$request.fail(failure),$request}};return $.extend({},defaults,options,!0)},AjaxAdapter.prototype.processResults=function(results){return results},AjaxAdapter.prototype.query=function(params,callback){function request(){var $request=options.transport(options,function(data){var results=self.processResults(data,params);self.options.get("debug")&&window.console&&console.error&&(results&&results.results&&$.isArray(results.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),callback(results)},function(){});self._request=$request}var self=this;null!=this._request&&($.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var options=$.extend({type:"GET"},this.ajaxOptions);"function"==typeof options.url&&(options.url=options.url(params)),"function"==typeof options.data&&(options.data=options.data(params)),this.ajaxOptions.delay&&""!==params.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(request,this.ajaxOptions.delay)):request()},AjaxAdapter}),S2.define("select2/data/tags",["jquery"],function($){function Tags(decorated,$element,options){var tags=options.get("tags"),createTag=options.get("createTag");if(void 0!==createTag&&(this.createTag=createTag),decorated.call(this,$element,options),$.isArray(tags))for(var t=0;t<tags.length;t++){var tag=tags[t],item=this._normalizeItem(tag),$option=this.option(item);this.$element.append($option)}}return Tags.prototype.query=function(decorated,params,callback){function wrapper(obj,child){for(var data=obj.results,i=0;i<data.length;i++){var option=data[i],checkChildren=null!=option.children&&!wrapper({results:option.children},!0),checkText=option.text===params.term;if(checkText||checkChildren)return child?!1:(obj.data=data,void callback(obj))}if(child)return!0;var tag=self.createTag(params);if(null!=tag){var $option=self.option(tag);$option.attr("data-select2-tag",!0),self.addOptions([$option]),self.insertTag(data,tag)}obj.results=data,callback(obj)}var self=this;return this._removeOldTags(),null==params.term||null!=params.page?void decorated.call(this,params,callback):void decorated.call(this,params,wrapper)},Tags.prototype.createTag=function(decorated,params){var term=$.trim(params.term);return""===term?null:{id:term,text:term}},Tags.prototype.insertTag=function(_,data,tag){data.unshift(tag)},Tags.prototype._removeOldTags=function(_){var $options=(this._lastTag,this.$element.find("option[data-select2-tag]"));$options.each(function(){this.selected||$(this).remove()})},Tags}),S2.define("select2/data/tokenizer",["jquery"],function($){function Tokenizer(decorated,$element,options){var tokenizer=options.get("tokenizer");void 0!==tokenizer&&(this.tokenizer=tokenizer),decorated.call(this,$element,options)}return Tokenizer.prototype.bind=function(decorated,container,$container){decorated.call(this,container,$container),this.$search=container.dropdown.$search||container.selection.$search||$container.find(".select2-search__field")},Tokenizer.prototype.query=function(decorated,params,callback){function select(data){self.select(data)}var self=this;params.term=params.term||"";var tokenData=this.tokenizer(params,this.options,select);tokenData.term!==params.term&&(this.$search.length&&(this.$search.val(tokenData.term),this.$search.focus()),params.term=tokenData.term),decorated.call(this,params,callback)},Tokenizer.prototype.tokenizer=function(_,params,options,callback){for(var separators=options.get("tokenSeparators")||[],term=params.term,i=0,createTag=this.createTag||function(params){return{id:params.term,text:params.term}};i<term.length;){var termChar=term[i];if(-1!==$.inArray(termChar,separators)){var part=term.substr(0,i),partParams=$.extend({},params,{term:part}),data=createTag(partParams);callback(data),term=term.substr(i+1)||"",i=0}else i++}return{term:term}},Tokenizer}),S2.define("select2/data/minimumInputLength",[],function(){function MinimumInputLength(decorated,$e,options){this.minimumInputLength=options.get("minimumInputLength"),decorated.call(this,$e,options)}return MinimumInputLength.prototype.query=function(decorated,params,callback){return params.term=params.term||"",params.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:params.term,params:params}}):void decorated.call(this,params,callback)},MinimumInputLength}),S2.define("select2/data/maximumInputLength",[],function(){function MaximumInputLength(decorated,$e,options){this.maximumInputLength=options.get("maximumInputLength"),decorated.call(this,$e,options)}return MaximumInputLength.prototype.query=function(decorated,params,callback){return params.term=params.term||"",this.maximumInputLength>0&&params.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:params.term,params:params}}):void decorated.call(this,params,callback)},MaximumInputLength}),S2.define("select2/data/maximumSelectionLength",[],function(){function MaximumSelectionLength(decorated,$e,options){this.maximumSelectionLength=options.get("maximumSelectionLength"),decorated.call(this,$e,options)}return MaximumSelectionLength.prototype.query=function(decorated,params,callback){var self=this;this.current(function(currentData){var count=null!=currentData?currentData.length:0;return self.maximumSelectionLength>0&&count>=self.maximumSelectionLength?void self.trigger("results:message",{message:"maximumSelected",args:{maximum:self.maximumSelectionLength}}):void decorated.call(self,params,callback)})},MaximumSelectionLength}),S2.define("select2/dropdown",["jquery","./utils"],function($,Utils){function Dropdown($element,options){this.$element=$element,this.options=options,Dropdown.__super__.constructor.call(this)}return Utils.Extend(Dropdown,Utils.Observable),Dropdown.prototype.render=function(){var $dropdown=$('<span class="select2-dropdown"><span class="select2-results"></span></span>');return $dropdown.attr("dir",this.options.get("dir")),this.$dropdown=$dropdown,$dropdown},Dropdown.prototype.position=function($dropdown,$container){},Dropdown.prototype.destroy=function(){this.$dropdown.remove()},Dropdown}),S2.define("select2/dropdown/search",["jquery","../utils"],function($,Utils){function Search(){}return Search.prototype.render=function(decorated){var $rendered=decorated.call(this),$search=$('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=$search,this.$search=$search.find("input"),$rendered.prepend($search),$rendered},Search.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),this.$search.on("keydown",function(evt){self.trigger("keypress",evt),self._keyUpPrevented=evt.isDefaultPrevented()}),this.$search.on("input",function(evt){$(this).off("keyup")}),this.$search.on("keyup input",function(evt){self.handleSearch(evt)}),container.on("open",function(){self.$search.attr("tabindex",0),self.$search.focus(),window.setTimeout(function(){self.$search.focus()},0)}),container.on("close",function(){self.$search.attr("tabindex",-1),self.$search.val("")}),container.on("results:all",function(params){if(null==params.query.term||""===params.query.term){var showSearch=self.showSearch(params);showSearch?self.$searchContainer.removeClass("select2-search--hide"):self.$searchContainer.addClass("select2-search--hide")}})},Search.prototype.handleSearch=function(evt){if(!this._keyUpPrevented){var input=this.$search.val();this.trigger("query",{term:input})}this._keyUpPrevented=!1},Search.prototype.showSearch=function(_,params){return!0},Search}),S2.define("select2/dropdown/hidePlaceholder",[],function(){function HidePlaceholder(decorated,$element,options,dataAdapter){this.placeholder=this.normalizePlaceholder(options.get("placeholder")),decorated.call(this,$element,options,dataAdapter)}return HidePlaceholder.prototype.append=function(decorated,data){data.results=this.removePlaceholder(data.results),decorated.call(this,data)},HidePlaceholder.prototype.normalizePlaceholder=function(_,placeholder){return"string"==typeof placeholder&&(placeholder={id:"",text:placeholder}),placeholder},HidePlaceholder.prototype.removePlaceholder=function(_,data){for(var modifiedData=data.slice(0),d=data.length-1;d>=0;d--){var item=data[d];this.placeholder.id===item.id&&modifiedData.splice(d,1)}return modifiedData},HidePlaceholder}),S2.define("select2/dropdown/infiniteScroll",["jquery"],function($){function InfiniteScroll(decorated,$element,options,dataAdapter){this.lastParams={},decorated.call(this,$element,options,dataAdapter),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return InfiniteScroll.prototype.append=function(decorated,data){this.$loadingMore.remove(),this.loading=!1,decorated.call(this,data),this.showLoadingMore(data)&&this.$results.append(this.$loadingMore)},InfiniteScroll.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("query",function(params){self.lastParams=params,self.loading=!0}),container.on("query:append",function(params){self.lastParams=params,self.loading=!0}),this.$results.on("scroll",function(){var isLoadMoreVisible=$.contains(document.documentElement,self.$loadingMore[0]);if(!self.loading&&isLoadMoreVisible){var currentOffset=self.$results.offset().top+self.$results.outerHeight(!1),loadingMoreOffset=self.$loadingMore.offset().top+self.$loadingMore.outerHeight(!1);currentOffset+50>=loadingMoreOffset&&self.loadMore()}})},InfiniteScroll.prototype.loadMore=function(){this.loading=!0;var params=$.extend({},{page:1},this.lastParams);params.page++,this.trigger("query:append",params)},InfiniteScroll.prototype.showLoadingMore=function(_,data){return data.pagination&&data.pagination.more},InfiniteScroll.prototype.createLoadingMore=function(){var $option=$('<li class="option load-more" role="treeitem"></li>'),message=this.options.get("translations").get("loadingMore");return $option.html(message(this.lastParams)),$option},InfiniteScroll}),S2.define("select2/dropdown/attachBody",["jquery","../utils"],function($,Utils){function AttachBody(decorated,$element,options){this.$dropdownParent=options.get("dropdownParent")||document.body,decorated.call(this,$element,options)}return AttachBody.prototype.bind=function(decorated,container,$container){var self=this,setupResultsEvents=!1;decorated.call(this,container,$container),container.on("open",function(){self._showDropdown(),self._attachPositioningHandler(container),setupResultsEvents||(setupResultsEvents=!0,container.on("results:all",function(){self._positionDropdown(),self._resizeDropdown()}),container.on("results:append",function(){self._positionDropdown(),self._resizeDropdown()}))}),container.on("close",function(){self._hideDropdown(),self._detachPositioningHandler(container)}),this.$dropdownContainer.on("mousedown",function(evt){evt.stopPropagation()})},AttachBody.prototype.position=function(decorated,$dropdown,$container){$dropdown.attr("class",$container.attr("class")),$dropdown.removeClass("select2"),$dropdown.addClass("select2-container--open"),$dropdown.css({position:"absolute",top:-999999}),this.$container=$container},AttachBody.prototype.render=function(decorated){var $container=$("<span></span>"),$dropdown=decorated.call(this);return $container.append($dropdown),this.$dropdownContainer=$container,$container},AttachBody.prototype._hideDropdown=function(decorated){this.$dropdownContainer.detach()},AttachBody.prototype._attachPositioningHandler=function(container){var self=this,scrollEvent="scroll.select2."+container.id,resizeEvent="resize.select2."+container.id,orientationEvent="orientationchange.select2."+container.id,$watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.each(function(){$(this).data("select2-scroll-position",{x:$(this).scrollLeft(),y:$(this).scrollTop()})}),$watchers.on(scrollEvent,function(ev){var position=$(this).data("select2-scroll-position");$(this).scrollTop(position.y)}),$(window).on(scrollEvent+" "+resizeEvent+" "+orientationEvent,function(e){self._positionDropdown(),self._resizeDropdown()})},AttachBody.prototype._detachPositioningHandler=function(container){var scrollEvent="scroll.select2."+container.id,resizeEvent="resize.select2."+container.id,orientationEvent="orientationchange.select2."+container.id,$watchers=this.$container.parents().filter(Utils.hasScroll);$watchers.off(scrollEvent),$(window).off(scrollEvent+" "+resizeEvent+" "+orientationEvent)},AttachBody.prototype._positionDropdown=function(){var $window=$(window),isCurrentlyAbove=this.$dropdown.hasClass("select2-dropdown--above"),isCurrentlyBelow=this.$dropdown.hasClass("select2-dropdown--below"),newDirection=null,offset=(this.$container.position(),this.$container.offset());offset.bottom=offset.top+this.$container.outerHeight(!1);var container={height:this.$container.outerHeight(!1)};container.top=offset.top,container.bottom=offset.top+container.height;var dropdown={height:this.$dropdown.outerHeight(!1)},viewport={top:$window.scrollTop(),bottom:$window.scrollTop()+$window.height()},enoughRoomAbove=viewport.top<offset.top-dropdown.height,enoughRoomBelow=viewport.bottom>offset.bottom+dropdown.height,css={left:offset.left,top:container.bottom};isCurrentlyAbove||isCurrentlyBelow||(newDirection="below"),enoughRoomBelow||!enoughRoomAbove||isCurrentlyAbove?!enoughRoomAbove&&enoughRoomBelow&&isCurrentlyAbove&&(newDirection="below"):newDirection="above",("above"==newDirection||isCurrentlyAbove&&"below"!==newDirection)&&(css.top=container.top-dropdown.height),null!=newDirection&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+newDirection),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+newDirection)),this.$dropdownContainer.css(css)},AttachBody.prototype._resizeDropdown=function(){this.$dropdownContainer.width();var css={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(css.minWidth=css.width,css.width="auto"),this.$dropdown.css(css)},AttachBody.prototype._showDropdown=function(decorated){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},AttachBody}),S2.define("select2/dropdown/minimumResultsForSearch",[],function(){function countResults(data){for(var count=0,d=0;d<data.length;d++){var item=data[d];item.children?count+=countResults(item.children):count++}return count}function MinimumResultsForSearch(decorated,$element,options,dataAdapter){this.minimumResultsForSearch=options.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),decorated.call(this,$element,options,dataAdapter)}return MinimumResultsForSearch.prototype.showSearch=function(decorated,params){return countResults(params.data.results)<this.minimumResultsForSearch?!1:decorated.call(this,params)},MinimumResultsForSearch}),S2.define("select2/dropdown/selectOnClose",[],function(){function SelectOnClose(){}return SelectOnClose.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("close",function(){self._handleSelectOnClose()})},SelectOnClose.prototype._handleSelectOnClose=function(){var $highlightedResults=this.getHighlightedResults();$highlightedResults.length<1||this.trigger("select",{data:$highlightedResults.data("data")})},SelectOnClose}),S2.define("select2/dropdown/closeOnSelect",[],function(){function CloseOnSelect(){}return CloseOnSelect.prototype.bind=function(decorated,container,$container){var self=this;decorated.call(this,container,$container),container.on("select",function(evt){self._selectTriggered(evt)}),container.on("unselect",function(evt){self._selectTriggered(evt)})},CloseOnSelect.prototype._selectTriggered=function(_,evt){var originalEvent=evt.originalEvent;originalEvent&&originalEvent.ctrlKey||this.trigger("close")},CloseOnSelect}),S2.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(args){var overChars=args.input.length-args.maximum,message="Please delete "+overChars+" character";return 1!=overChars&&(message+="s"),message},inputTooShort:function(args){var remainingChars=args.minimum-args.input.length,message="Please enter "+remainingChars+" or more characters";return message},loadingMore:function(){return"Loading more results"},maximumSelected:function(args){var message="You can only select "+args.maximum+" item";return 1!=args.maximum&&(message+="s"),message},noResults:function(){return"No results found"},searching:function(){return"Searching"}}}),S2.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function($,require,ResultsList,SingleSelection,MultipleSelection,Placeholder,AllowClear,SelectionSearch,EventRelay,Utils,Translation,DIACRITICS,SelectData,ArrayData,AjaxData,Tags,Tokenizer,MinimumInputLength,MaximumInputLength,MaximumSelectionLength,Dropdown,DropdownSearch,HidePlaceholder,InfiniteScroll,AttachBody,MinimumResultsForSearch,SelectOnClose,CloseOnSelect,EnglishTranslation){function Defaults(){this.reset()}Defaults.prototype.apply=function(options){if(options=$.extend({},this.defaults,options),null==options.dataAdapter){if(null!=options.ajax?options.dataAdapter=AjaxData:null!=options.data?options.dataAdapter=ArrayData:options.dataAdapter=SelectData,options.minimumInputLength>0&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,MinimumInputLength)),options.maximumInputLength>0&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumInputLength)),options.maximumSelectionLength>0&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,MaximumSelectionLength)),options.tags&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,Tags)),(null!=options.tokenSeparators||null!=options.tokenizer)&&(options.dataAdapter=Utils.Decorate(options.dataAdapter,Tokenizer)),null!=options.query){var Query=require(options.amdBase+"compat/query");options.dataAdapter=Utils.Decorate(options.dataAdapter,Query)}if(null!=options.initSelection){var InitSelection=require(options.amdBase+"compat/initSelection");options.dataAdapter=Utils.Decorate(options.dataAdapter,InitSelection)}}if(null==options.resultsAdapter&&(options.resultsAdapter=ResultsList,null!=options.ajax&&(options.resultsAdapter=Utils.Decorate(options.resultsAdapter,InfiniteScroll)),null!=options.placeholder&&(options.resultsAdapter=Utils.Decorate(options.resultsAdapter,HidePlaceholder)),options.selectOnClose&&(options.resultsAdapter=Utils.Decorate(options.resultsAdapter,SelectOnClose))),null==options.dropdownAdapter){if(options.multiple)options.dropdownAdapter=Dropdown;else{var SearchableDropdown=Utils.Decorate(Dropdown,DropdownSearch);options.dropdownAdapter=SearchableDropdown}if(0!==options.minimumResultsForSearch&&(options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,MinimumResultsForSearch)),options.closeOnSelect&&(options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,CloseOnSelect)),null!=options.dropdownCssClass||null!=options.dropdownCss||null!=options.adaptDropdownCssClass){var DropdownCSS=require(options.amdBase+"compat/dropdownCss");options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,DropdownCSS)}options.dropdownAdapter=Utils.Decorate(options.dropdownAdapter,AttachBody)}if(null==options.selectionAdapter){if(options.multiple?options.selectionAdapter=MultipleSelection:options.selectionAdapter=SingleSelection,null!=options.placeholder&&(options.selectionAdapter=Utils.Decorate(options.selectionAdapter,Placeholder)),options.allowClear&&(options.selectionAdapter=Utils.Decorate(options.selectionAdapter,AllowClear)),options.multiple&&(options.selectionAdapter=Utils.Decorate(options.selectionAdapter,SelectionSearch)),null!=options.containerCssClass||null!=options.containerCss||null!=options.adaptContainerCssClass){var ContainerCSS=require(options.amdBase+"compat/containerCss");options.selectionAdapter=Utils.Decorate(options.selectionAdapter,ContainerCSS)}options.selectionAdapter=Utils.Decorate(options.selectionAdapter,EventRelay)}if("string"==typeof options.language)if(options.language.indexOf("-")>0){var languageParts=options.language.split("-"),baseLanguage=languageParts[0];options.language=[options.language,baseLanguage]}else options.language=[options.language];if($.isArray(options.language)){var languages=new Translation;options.language.push("en");for(var languageNames=options.language,l=0;l<languageNames.length;l++){var name=languageNames[l],language={};try{language=Translation.loadPath(name)}catch(e){try{name=this.defaults.amdLanguageBase+name,language=Translation.loadPath(name)}catch(ex){options.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+name+'" could not be automatically loaded. A fallback will be used instead.');continue}}languages.extend(language)}options.translations=languages}else{var baseTranslation=Translation.loadPath(this.defaults.amdLanguageBase+"en"),customTranslation=new Translation(options.language);customTranslation.extend(baseTranslation),options.translations=customTranslation}return options},Defaults.prototype.reset=function(){function stripDiacritics(text){function match(a){return DIACRITICS[a]||a}return text.replace(/[^\u0000-\u007E]/g,match)}function matcher(params,data){if(""===$.trim(params.term))return data;if(data.children&&data.children.length>0){for(var match=$.extend(!0,{},data),c=data.children.length-1;c>=0;c--){var child=data.children[c],matches=matcher(params,child);null==matches&&match.children.splice(c,1)}return match.children.length>0?match:matcher(params,match)}var original=stripDiacritics(data.text).toUpperCase(),term=stripDiacritics(params.term).toUpperCase();return original.indexOf(term)>-1?data:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:Utils.escapeMarkup,language:EnglishTranslation,matcher:matcher,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(data){return data},templateResult:function(result){return result.text},templateSelection:function(selection){return selection.text},theme:"default",width:"resolve"}},Defaults.prototype.set=function(key,value){var camelKey=$.camelCase(key),data={};data[camelKey]=value;var convertedData=Utils._convertData(data);$.extend(this.defaults,convertedData)};var defaults=new Defaults;return defaults}),S2.define("select2/options",["require","jquery","./defaults","./utils"],function(require,$,Defaults,Utils){function Options(options,$element){if(this.options=options,null!=$element&&this.fromElement($element),this.options=Defaults.apply(this.options),$element&&$element.is("input")){var InputCompat=require(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=Utils.Decorate(this.options.dataAdapter,InputCompat)}}return Options.prototype.fromElement=function($e){var excludedData=["select2"];null==this.options.multiple&&(this.options.multiple=$e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=$e.prop("disabled")),null==this.options.language&&($e.prop("lang")?this.options.language=$e.prop("lang").toLowerCase():$e.closest("[lang]").prop("lang")&&(this.options.language=$e.closest("[lang]").prop("lang"))),null==this.options.dir&&($e.prop("dir")?this.options.dir=$e.prop("dir"):$e.closest("[dir]").prop("dir")?this.options.dir=$e.closest("[dir]").prop("dir"):this.options.dir="ltr"),$e.prop("disabled",this.options.disabled),$e.prop("multiple",this.options.multiple),$e.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),$e.data("data",$e.data("select2Tags")),$e.data("tags",!0)),$e.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),$e.attr("ajax--url",$e.data("ajaxUrl")),$e.data("ajax--url",$e.data("ajaxUrl")));var dataset={};dataset=$.fn.jquery&&"1."==$.fn.jquery.substr(0,2)&&$e[0].dataset?$.extend(!0,{},$e[0].dataset,$e.data()):$e.data();var data=$.extend(!0,{},dataset);data=Utils._convertData(data);for(var key in data)$.inArray(key,excludedData)>-1||($.isPlainObject(this.options[key])?$.extend(this.options[key],data[key]):this.options[key]=data[key]);return this},Options.prototype.get=function(key){return this.options[key]},Options.prototype.set=function(key,val){this.options[key]=val},Options}),S2.define("select2/core",["jquery","./options","./utils","./keys"],function($,Options,Utils,KEYS){var Select2=function($element,options){null!=$element.data("select2")&&$element.data("select2").destroy(),this.$element=$element,this.id=this._generateId($element),options=options||{},this.options=new Options(options,$element),Select2.__super__.constructor.call(this);var tabindex=$element.attr("tabindex")||0;$element.data("old-tabindex",tabindex),$element.attr("tabindex","-1");var DataAdapter=this.options.get("dataAdapter");this.dataAdapter=new DataAdapter($element,this.options);var $container=this.render();this._placeContainer($container);var SelectionAdapter=this.options.get("selectionAdapter");this.selection=new SelectionAdapter($element,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,$container);
var DropdownAdapter=this.options.get("dropdownAdapter");this.dropdown=new DropdownAdapter($element,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,$container);var ResultsAdapter=this.options.get("resultsAdapter");this.results=new ResultsAdapter($element,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var self=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(initialData){self.trigger("selection:update",{data:initialData})}),$element.addClass("select2-hidden-accessible"),$element.attr("aria-hidden","true"),this._syncAttributes(),$element.data("select2",this)};return Utils.Extend(Select2,Utils.Observable),Select2.prototype._generateId=function($element){var id="";return id=null!=$element.attr("id")?$element.attr("id"):null!=$element.attr("name")?$element.attr("name")+"-"+Utils.generateChars(2):Utils.generateChars(4),id="select2-"+id},Select2.prototype._placeContainer=function($container){$container.insertAfter(this.$element);var width=this._resolveWidth(this.$element,this.options.get("width"));null!=width&&$container.css("width",width)},Select2.prototype._resolveWidth=function($element,method){var WIDTH=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==method){var styleWidth=this._resolveWidth($element,"style");return null!=styleWidth?styleWidth:this._resolveWidth($element,"element")}if("element"==method){var elementWidth=$element.outerWidth(!1);return 0>=elementWidth?"auto":elementWidth+"px"}if("style"==method){var style=$element.attr("style");if("string"!=typeof style)return null;for(var attrs=style.split(";"),i=0,l=attrs.length;l>i;i+=1){var attr=attrs[i].replace(/\s/g,""),matches=attr.match(WIDTH);if(null!==matches&&matches.length>=1)return matches[1]}return null}return method},Select2.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},Select2.prototype._registerDomEvents=function(){var self=this;this.$element.on("change.select2",function(){self.dataAdapter.current(function(data){self.trigger("selection:update",{data:data})})}),this._sync=Utils.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var observer=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=observer?(this._observer=new observer(function(mutations){$.each(mutations,self._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",self._sync,!1)},Select2.prototype._registerDataEvents=function(){var self=this;this.dataAdapter.on("*",function(name,params){self.trigger(name,params)})},Select2.prototype._registerSelectionEvents=function(){var self=this,nonRelayEvents=["toggle"];this.selection.on("toggle",function(){self.toggleDropdown()}),this.selection.on("*",function(name,params){-1===$.inArray(name,nonRelayEvents)&&self.trigger(name,params)})},Select2.prototype._registerDropdownEvents=function(){var self=this;this.dropdown.on("*",function(name,params){self.trigger(name,params)})},Select2.prototype._registerResultsEvents=function(){var self=this;this.results.on("*",function(name,params){self.trigger(name,params)})},Select2.prototype._registerEvents=function(){var self=this;this.on("open",function(){self.$container.addClass("select2-container--open")}),this.on("close",function(){self.$container.removeClass("select2-container--open")}),this.on("enable",function(){self.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){self.$container.addClass("select2-container--disabled")}),this.on("focus",function(){self.$container.addClass("select2-container--focus")}),this.on("blur",function(){self.$container.removeClass("select2-container--focus")}),this.on("query",function(params){self.isOpen()||self.trigger("open"),this.dataAdapter.query(params,function(data){self.trigger("results:all",{data:data,query:params})})}),this.on("query:append",function(params){this.dataAdapter.query(params,function(data){self.trigger("results:append",{data:data,query:params})})}),this.on("keypress",function(evt){var key=evt.which;self.isOpen()?key===KEYS.ENTER?(self.trigger("results:select"),evt.preventDefault()):key===KEYS.SPACE&&evt.ctrlKey?(self.trigger("results:toggle"),evt.preventDefault()):key===KEYS.UP?(self.trigger("results:previous"),evt.preventDefault()):key===KEYS.DOWN?(self.trigger("results:next"),evt.preventDefault()):(key===KEYS.ESC||key===KEYS.TAB)&&(self.close(),evt.preventDefault()):(key===KEYS.ENTER||key===KEYS.SPACE||(key===KEYS.DOWN||key===KEYS.UP)&&evt.altKey)&&(self.open(),evt.preventDefault())})},Select2.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable")):this.trigger("enable")},Select2.prototype.trigger=function(name,args){var actualTrigger=Select2.__super__.trigger,preTriggerMap={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(name in preTriggerMap){var preTriggerName=preTriggerMap[name],preTriggerArgs={prevented:!1,name:name,args:args};if(actualTrigger.call(this,preTriggerName,preTriggerArgs),preTriggerArgs.prevented)return void(args.prevented=!0)}actualTrigger.call(this,name,args)},Select2.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},Select2.prototype.open=function(){this.isOpen()||(this.trigger("query",{}),this.trigger("open"))},Select2.prototype.close=function(){this.isOpen()&&this.trigger("close")},Select2.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},Select2.prototype.enable=function(args){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),(null==args||0===args.length)&&(args=[!0]);var disabled=!args[0];this.$element.prop("disabled",disabled)},Select2.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var data=[];return this.dataAdapter.current(function(currentData){data=currentData}),data},Select2.prototype.val=function(args){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==args||0===args.length)return this.$element.val();var newVal=args[0];$.isArray(newVal)&&(newVal=$.map(newVal,function(obj){return obj.toString()})),this.$element.val(newVal).trigger("change")},Select2.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},Select2.prototype.render=function(){var $container=$('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return $container.attr("dir",this.options.get("dir")),this.$container=$container,this.$container.addClass("select2-container--"+this.options.get("theme")),$container.data("element",this.$element),$container},Select2}),S2.define("jquery.select2",["jquery","require","./select2/core","./select2/defaults"],function($,require,Select2,Defaults){if(require("jquery.mousewheel"),null==$.fn.select2){var thisMethods=["open","close","destroy"];$.fn.select2=function(options){if(options=options||{},"object"==typeof options)return this.each(function(){var instanceOptions=$.extend({},options,!0);new Select2($(this),instanceOptions)}),this;if("string"==typeof options){var instance=this.data("select2");null==instance&&window.console&&console.error&&console.error("The select2('"+options+"') method was called on an element that is not using Select2.");var args=Array.prototype.slice.call(arguments,1),ret=instance[options](args);return $.inArray(options,thisMethods)>-1?this:ret}throw new Error("Invalid arguments for Select2: "+options)}}return null==$.fn.select2.defaults&&($.fn.select2.defaults=Defaults),Select2}),S2.define("jquery.mousewheel",["jquery"],function($){return $}),{define:S2.define,require:S2.require}}(),select2=S2.require("jquery.select2");return jQuery.fn.select2.amd=S2,select2}),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function refresh(){var data=prepareData(this),$s=$t.settings;return isNaN(data.datetime)||(0==$s.cutoff||Math.abs(distance(data.datetime))<$s.cutoff)&&$(this).text(inWords(data.datetime)),this}function prepareData(element){if(element=$(element),!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());$t.settings.localeTitle?element.attr("title",element.data("timeago").datetime.toLocaleString()):!(text.length>0)||$t.isTime(element)&&element.attr("title")||element.attr("title",text)}return element.data("timeago")}function inWords(date){return $t.inWords(distance(date))}function distance(date){return(new Date).getTime()-date.getTime()}$.timeago=function(timestamp){return inWords(timestamp instanceof Date?timestamp:"string"==typeof timestamp?$.timeago.parse(timestamp):"number"==typeof timestamp?new Date(timestamp):$.timeago.datetime(timestamp))};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",inPast:"any moment now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(distanceMillis){function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction,value=$l.numbers&&$l.numbers[number]||number;return string.replace(/%d/i,value)}if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var $l=this.settings.strings,prefix=$l.prefixAgo,suffix=$l.suffixAgo;if(this.settings.allowFuture&&0>distanceMillis&&(prefix=$l.prefixFromNow,suffix=$l.suffixFromNow),!this.settings.allowPast&&distanceMillis>=0)return this.settings.strings.inPast;var seconds=Math.abs(distanceMillis)/1e3,minutes=seconds/60,hours=minutes/60,days=hours/24,years=days/365,words=45>seconds&&substitute($l.seconds,Math.round(seconds))||90>seconds&&substitute($l.minute,1)||45>minutes&&substitute($l.minutes,Math.round(minutes))||90>minutes&&substitute($l.hour,1)||24>hours&&substitute($l.hours,Math.round(hours))||42>hours&&substitute($l.day,1)||30>days&&substitute($l.days,Math.round(days))||45>days&&substitute($l.month,1)||365>days&&substitute($l.months,Math.round(days/30))||1.5>years&&substitute($l.year,1)||substitute($l.years,Math.round(years)),separator=$l.wordSeparator||"";return void 0===$l.wordSeparator&&(separator=" "),$.trim([prefix,words,suffix].join(separator))},parse:function(iso8601){var s=$.trim(iso8601);return s=s.replace(/\.\d+/,""),s=s.replace(/-/,"/").replace(/-/,"/"),s=s.replace(/T/," ").replace(/Z/," UTC"),s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),s=s.replace(/([\+\-]\d\d)$/," $100"),new Date(s)},datetime:function(elem){var iso8601=$(elem).attr($t.isTime(elem)?"datetime":"title");return $t.parse(iso8601)},isTime:function(elem){return"time"===$(elem).get(0).tagName.toLowerCase()}});var functions={init:function(){var refresh_el=$.proxy(refresh,this);refresh_el();var $s=$t.settings;$s.refreshMillis>0&&(this._timeagoInterval=setInterval(refresh_el,$s.refreshMillis))},update:function(time){var parsedTime=$t.parse(time);$(this).data("timeago",{datetime:parsedTime}),$t.settings.localeTitle&&$(this).attr("title",parsedTime.toLocaleString()),refresh.apply(this)},updateFromDOM:function(){$(this).data("timeago",{datetime:$t.parse($(this).attr($t.isTime(this)?"datetime":"title"))}),refresh.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};$.fn.timeago=function(action,options){var fn=action?functions[action]:functions.init;if(!fn)throw new Error("Unknown function name '"+action+"' for timeago");return this.each(function(){fn.call(this,options)}),this},document.createElement("abbr"),document.createElement("time")}),"function"!=typeof Object.create&&(Object.create=function(obj){function F(){}return F.prototype=obj,new F}),function($,window,console,bootbox){"use strict";var Comment={init:function(options,elem){var self=this;self.$elem=$(elem),self.options=$.extend({},$.fn.comment.options,options),self.cursor=-1,self.errors={},self.frameHeaderGroup=$('<div class="btn-group btn-group-xs pull-right comment-frame-header" role="group"></div>').append($('<i class="fa fa-circle-o-notch fa-spin"></i>')),self.drawFrame(),self.pullCommentsAndRender(null,!0)},loadingSpinner:function(){return'<h3 class="text-center"><i class="fa fa-circle-o-notch fa-spin"></i> Loading...</h3>'},pullCommentsAndRender:function(cursor,topLevel){var objectId,self=this,url=self.options.url,dataToSend={},limit=10,depth=0,objectType=self.options.object_type,loader=$(self.loadingSpinner());self.innerPanel.append(loader),"top"===self.options.display&&(limit=1,depth=1),"message"===self.options.object_type?(objectId=self.options.object_id,objectType=self.options.object_type,url=self.options.url+objectId+"/"):(objectId=self.options.object_id,objectType=self.options.object_type),dataToSend={type_id:objectId,type:objectType,limit:limit,cursor:cursor,depth:depth},$.ajax({url:url,dataType:"json",data:dataToSend,success:function(data){data.success?(self.options.canCreate=data.result.can_create,self.options.user=data.result.user,self.cursor=data.result.cursor,self.subscribed=data.result.subscribed,self.canSubscribe=data.result.can_subscribe,topLevel&&(self.drawFrameHeader(),self.drawPostBox()),self.drawTopLevelComments(self.buildList(data.result.messages,!0,null),topLevel),loader.remove()):self.drawError(self.validationError(data.result))},error:function(){self.drawError(self.connectionError())}})},buildError:function(text){return'<div class="alert alert-danger" role="alert">'+text+"</div>"},buildForm:function(commentId,parentId,textareaValue){var self=this,formElem=$("<form></form>").addClass("comment-postbox"),textarea=$("<textarea></textarea>").addClass("form-control"),button=$("<button>Post</button>").addClass("btn btn-default").click(function(e){e.preventDefault();var text=$(textarea).val();text?commentId?self.editComment(commentId,text,formElem,e.target):self.submitForm(parentId,text,e.target):(void 0!==self.errors[parentId]&&self.errors[parentId].remove(),self.errors[parentId]=$(self.validationError("You have not entered any text.")),formElem.prepend(self.errors[parentId]))});return commentId&&button.text("Save"),textareaValue&&textarea.val(textareaValue),formElem.append(textarea).append(button),formElem},submitForm:function(parentId,text,event){var self=this,postbox=$(event).parent().hide(),loader=$(self.loadingSpinner());postbox.after(loader),$.ajax({url:self.options.url,dataType:"json",method:"POST",data:{id:parentId,type_id:self.options.object_id,type:self.options.object_type,message:text},success:function(data){if(data.success){"top"===self.options.display&&window.location.reload();var item=self.buildItemList(data.result.messages[0],!$(event).parents(".comment").first().hasClass("dark"));$(".no-messages-error").remove(),"top"!==self.options.display&&(parentId?$(event).parents(".comment").first().children(".replies").prepend(item):self.$rootList.prepend(item)),loader.remove(),self.errors[parentId]&&self.errors[parentId].remove(),postbox.find(".redactor-editor").html(""),parentId||postbox.show()}else postbox.before(self.validationError(data.result)),loader.remove(),parentId||postbox.show()},error:function(){self.innerPanel.html(self.connectionError())}})},buildList:function(data,dark,parentId){if(0===data.length)return this.noMessagesError();var self=this,list=$.map(data,function(obj){return self.buildItemList(obj,dark)});return void 0!==self.moreButton&&self.moreButton.remove(),self.moreButton=$("<button>Load More Comments</button>").addClass("btn btn-default").on("click",function(){self.moreButton.hide(),self.pullCommentsAndRender(self.cursor,!1)}),null===self.cursor||parentId||list.push(self.moreButton),list},buildItemList:function(data,dark){var editbox,replybox,self=this,item=$("<li></li>").addClass("comment").attr("id","comment-"+data.id),commentFooter=$("<footer></footer>"),replies=$("<ul></ul>").addClass("replies"),create_time_obj=new Date(data.create_time),modified_time_obj=new Date(data.modified_time),timeBox=$("<span></span>"),subscribeText=data.subscribed?"Unsubscribe":"Subscribe";return timeBox.append($("<abbr>"+create_time_obj.toString()+"</abbr>").attr("title",data.create_time).timeago()),data.modified_time&&timeBox.append(", last modified ").append($("<abbr>"+modified_time_obj.toString()+"</abbr>").attr("title",data.modified_time).timeago()),self.options.canCreate&&(replybox=self.buildForm(null,data.id),replybox.hide(),commentFooter.append($("<a>Reply</a>").attr("href","#").on("click",function(e){e.preventDefault(),self.options.canCreate&&editbox&&editbox.hide(),replybox.is(":hidden")&&!replybox.find(".redactor-editor").length?(replybox.toggle().find("textarea").redactor({imageUpload:"/files/redactor/upload",plugins:["table","fontsize","fontcolor","video"]}),replybox.find(".redactor-editor").focus()):replybox.toggle().find(".redactor-editor").focus()}))),data.can_modify&&(editbox=self.buildForm(data.id,null,data.body),editbox.hide(),commentFooter.append($("<a>Edit</a>").attr("href","#").on("click",function(e){e.preventDefault(),self.options.canCreate&&replybox.hide(),editbox.is(":hidden")&&!editbox.find(".redactor-editor").length?(editbox.toggle().find("textarea").redactor({focus:!0,imageUpload:"/files/redactor/upload",plugins:["table","fontsize","fontcolor","video"]}),editbox.find(".redactor-editor").focus()):editbox.toggle().find(".redactor-editor").focus()})).append($("<a>Delete</a>").attr("href","#").on("click",function(e){e.preventDefault(),self.deleteComment(data.id,e.target)}))),self.canSubscribe&&commentFooter.append($("<a></a>").attr("href","#").on("click",function(e){e.preventDefault(),self.subscribe(data.id,e.target,!("Subscribe"!==e.target.text))}).text(subscribeText)),item.append($("<div></div").addClass("profile-mask").append($("<img/>").addClass("comment-profile").attr("src",data.user.picture))),item.append($("<div></div>").addClass("comment-content").append($("<header></header").append($("<a>"+data.user.name+"</a>").attr("href","/users/"+data.user.zid)).append($("<small></small>").append(timeBox))).append($("<div></div>").addClass("comment-body").html(data.body)).append(commentFooter)),data.can_modify&&item.append(editbox),self.options.canCreate&&item.append(replybox),data.children.length>0&&replies.append(self.buildList(data.children,!dark,data.id)),item.append(replies),item.addClass(dark?"dark":"light"),item[0]},subscribe:function(id,event,subscribe){var self=this,type="message";null===id&&(id=self.options.object_id,type=self.options.object_type),$.ajax({url:self.options.url+type+"/"+id+"/subscribe",dataType:"json",method:subscribe?"PUT":"DELETE",success:function(data){data.success?"message"===type?$(event).text("Subscribe"===$(event).text()?"Unsubscribe":"Subscribe"):$(event).find(".fa-bookmark-o").length?($(event).html('<i class="fa fa-bookmark"></i>'),$(event).attr("title","Click to Unsubscribe")):($(event).html('<i class="fa fa-bookmark-o"></i>'),$(event).attr("title","Click to Subscribe")):self.drawError(self.validationError(data.result))},error:function(){self.innerPanel.html(self.connectionError())}})},deleteComment:function(id,event){var self=this;bootbox.confirm("Are you sure you want to delete this comment?",function(confirmed){confirmed&&($(event).parents(".comment").first().children(".replies").children().length?self.editComment(id,"<p>[deleted]</p>",null,event):$.ajax({url:self.options.url+id+"/",dataType:"json",method:"DELETE",success:function(data){data.success?($(event).parents(".comment").first().remove(),0===$(".comment-wrapper").find(".comment").length&&$(".comment-wrapper").append(self.noMessagesError)):self.drawError(self.validationError(data.result))},error:function(){self.innerPanel.html(self.connectionError())}}))})},connectionError:function(){return this.buildError("Error getting response from server. Try refreshing the page.")},noMessagesError:function(){return"<span class='no-messages-error'>There are no comments yet.</span>"},validationError:function(error){return this.buildError("Invalid message: "+error)},editComment:function(id,text,form_elem,event){var self=this,commentText=$(event).parents(".comment").first().find(".comment-body").first();$.ajax({url:self.options.url+id+"/",dataType:"json",method:"PUT",data:{message:text},success:function(data){data.success?(commentText.html(text),null!==form_elem&&form_elem.toggle().find(".redactor-editor").focus()):self.drawError(self.validationError(data.result))},error:function(){self.innerPanel.html(self.connectionError())}})},drawFrameHeader:function(){var self=this,linkToForum="/"+window.location.pathname.split("/").slice(1,3).join("/")+"/forums/"+self.options.object_type+"/"+self.options.object_id,linkToSearch="/"+window.location.pathname.split("/").slice(1,3).join("/")+"/forums/search?forum_choice="+self.options.object_type+"/"+self.options.object_id,linkToSubscribe=$('<a title="Click to Subscribe"><i class="fa fa-bookmark-o"></i></a>').addClass("btn").addClass("btn-default").addClass("btn-xs").on("click",function(e){var subscribe=!1;$(e.target).find(".fa-bookmark-o").length&&(subscribe=!0),self.subscribe(null,e.target,subscribe)});self.subscribed&&linkToSubscribe.attr("title","Click to Unsubscribe").html('<i class="fa fa-bookmark"></i>'),self.frameHeaderGroup.empty(),"bottom"!==self.options.display&&(self.canSubscribe&&self.frameHeaderGroup.append(linkToSubscribe),self.frameHeaderGroup.append($('<a title="Search"><i class="fa fa-search"></i></a>').addClass("btn").addClass("btn-default").addClass("btn-xs").attr("href",linkToSearch))),"all"===self.options.display&&self.frameHeaderGroup.append($('<a title="Forum View"><i class="fa fa-comments"></i></a>').addClass("btn").addClass("btn-default").addClass("btn-xs").attr("href",linkToForum))},drawFrame:function(){var self=this,panelHeading=$("<div></div>");self.innerPanel=$("<div></div>"),self.panel_box=$("<div></div>"),self.$elem.html($("<div></div>").addClass("panel panel-default").append(panelHeading.addClass("panel-heading clearfix").append($("<h3></h3>").addClass("panel-title").text("top"===self.options.display?"New Comment":"Comments"))).append($('<div class="panel-body"></div>').append(self.panel_box).append(self.innerPanel))),panelHeading.find("h3").append(self.frameHeaderGroup)},drawPostBox:function(){var self=this;if(self.options.canCreate&&"bottom"!==self.options.display){var form=self.buildForm();form.find("textarea").redactor({imageUpload:"/files/redactor/upload",plugins:["table","fontsize","fontcolor","video"]}),self.panel_box.append(form)}},drawTopLevelComments:function(comments,topLevel){var self=this;"top"!==self.options.display&&("bottom"!==self.options.display&&topLevel&&self.options.canCreate&&self.innerPanel.append("<hr>"),void 0!==self.$rootList?self.$rootList.append(comments):(self.$rootList=$("<ul></ul>").addClass("comment-wrapper").append(comments),self.innerPanel.append(self.$rootList)))},drawError:function(error){var self=this;self.innerPanel.html(error)}};$.fn.comment=function(options){return this.each(function(){var comment=Object.create(Comment);comment.init(options,this),$.data(this,"comment",comment)})},$.fn.comment.options={object_type:"",object_id:-1,url:"#",user:{},display:"all"}}(jQuery,window,console,bootbox),$.ajaxSetup({beforeSend:function(xhr,settings){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)||this.crossDomain||xhr.setRequestHeader("X-CSRFToken",$("meta[name=csrf-token]").attr("content"))}});var stIsIE=!1;if(sorttable={init:function(){arguments.callee.done||(arguments.callee.done=!0,_timer&&clearInterval(_timer),document.createElement&&document.getElementsByTagName&&(sorttable.DATE_RE=/^(\d\d?)[\/\.-](\d\d?)[\/\.-]((\d\d)?\d\d)$/,forEach(document.getElementsByTagName("table"),function(t){-1!=t.className.search(/\bsortable\b/)&&sorttable.makeSortable(t)})))},makeSortable:function(t){if(0==t.getElementsByTagName("thead").length&&(the=document.createElement("thead"),the.appendChild(t.rows[0]),t.insertBefore(the,t.firstChild)),null==t.tHead&&(t.tHead=t.getElementsByTagName("thead")[0]),1==t.tHead.rows.length){sortbottomrows=[];for(var e=0;e<t.rows.length;e++)-1!=t.rows[e].className.search(/\bsortbottom\b/)&&(sortbottomrows[sortbottomrows.length]=t.rows[e]);if(sortbottomrows){null==t.tFoot&&(tfo=document.createElement("tfoot"),t.appendChild(tfo));for(var e=0;e<sortbottomrows.length;e++)tfo.appendChild(sortbottomrows[e]);delete sortbottomrows}headrow=t.tHead.rows[0].cells;for(var e=0;e<headrow.length;e++)headrow[e].className.match(/\bsorttable_nosort\b/)||(mtch=headrow[e].className.match(/\bsorttable_([a-z0-9]+)\b/),mtch&&(override=mtch[1]),headrow[e].sorttable_sortfunction=mtch&&"function"==typeof sorttable["sort_"+override]?sorttable["sort_"+override]:sorttable.guessType(t,e),headrow[e].sorttable_columnindex=e,headrow[e].sorttable_tbody=t.tBodies[0],dean_addEvent(headrow[e],"click",sorttable.innerSortFunction=function(){if(-1!=this.className.search(/\bsorttable_sorted\b/))return sorttable.reverse(this.sorttable_tbody),this.className=this.className.replace("sorttable_sorted","sorttable_sorted_reverse"),this.removeChild(document.getElementById("sorttable_sortfwdind")),sortrevind=document.createElement("span"),sortrevind.id="sorttable_sortrevind",sortrevind.innerHTML=stIsIE?'&nbsp<font face="webdings">5</font>':"&nbsp;&#x25B4;",void this.appendChild(sortrevind);if(-1!=this.className.search(/\bsorttable_sorted_reverse\b/))return sorttable.reverse(this.sorttable_tbody),this.className=this.className.replace("sorttable_sorted_reverse","sorttable_sorted"),this.removeChild(document.getElementById("sorttable_sortrevind")),sortfwdind=document.createElement("span"),sortfwdind.id="sorttable_sortfwdind",sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;",void this.appendChild(sortfwdind);theadrow=this.parentNode,forEach(theadrow.childNodes,function(t){1==t.nodeType&&(t.className=t.className.replace("sorttable_sorted_reverse",""),t.className=t.className.replace("sorttable_sorted",""))}),sortfwdind=document.getElementById("sorttable_sortfwdind"),sortfwdind&&sortfwdind.parentNode.removeChild(sortfwdind),sortrevind=document.getElementById("sorttable_sortrevind"),sortrevind&&sortrevind.parentNode.removeChild(sortrevind),this.className+=" sorttable_sorted",sortfwdind=document.createElement("span"),sortfwdind.id="sorttable_sortfwdind",sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':"&nbsp;&#x25BE;",this.appendChild(sortfwdind),row_array=[],col=this.sorttable_columnindex,rows=this.sorttable_tbody.rows;for(var t=0;t<rows.length;t++)row_array[row_array.length]=[sorttable.getInnerText(rows[t].cells[col]),rows[t]];row_array.sort(this.sorttable_sortfunction),tb=this.sorttable_tbody;for(var t=0;t<row_array.length;t++)tb.appendChild(row_array[t][1]);delete row_array}))}},guessType:function(t,e){sortfn=sorttable.sort_alpha;for(var r=0;r<t.tBodies[0].rows.length;r++)if(text=sorttable.getInnerText(t.tBodies[0].rows[r].cells[e]),""!=text){if(text.match(/^-?[$]?[\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1]),second=parseInt(possdate[2]),first>12)return sorttable.sort_ddmm;if(second>12)return sorttable.sort_mmdd;sortfn=sorttable.sort_ddmm}}return sortfn},getInnerText:function(t){if(!t)return"";if(hasInputs="function"==typeof t.getElementsByTagName&&t.getElementsByTagName("input").length,null!=t.getAttribute("sorttable_customkey"))return t.getAttribute("sorttable_customkey");if("undefined"!=typeof t.textContent&&!hasInputs)return t.textContent.replace(/^\s+|\s+$/g,"");if("undefined"!=typeof t.innerText&&!hasInputs)return t.innerText.replace(/^\s+|\s+$/g,"");if("undefined"!=typeof t.text&&!hasInputs)return t.text.replace(/^\s+|\s+$/g,"");switch(t.nodeType){case 3:if("input"==t.nodeName.toLowerCase())return t.value.replace(/^\s+|\s+$/g,"");case 4:return t.nodeValue.replace(/^\s+|\s+$/g,"");case 1:case 11:for(var e="",r=0;r<t.childNodes.length;r++)e+=sorttable.getInnerText(t.childNodes[r]);return e.replace(/^\s+|\s+$/g,"");default:return""}},reverse:function(t){newrows=[];for(var e=0;e<t.rows.length;e++)newrows[newrows.length]=t.rows[e];for(var e=newrows.length-1;e>=0;e--)t.appendChild(newrows[e]);delete newrows},sort_numeric:function(t,e){return aa=parseFloat(t[0].replace(/[^0-9.-]/g,"")),isNaN(aa)&&(aa=0),bb=parseFloat(e[0].replace(/[^0-9.-]/g,"")),isNaN(bb)&&(bb=0),aa-bb},sort_alpha:function(t,e){return t[0]==e[0]?0:t[0]<e[0]?-1:1},sort_ddmm:function(t,e){return mtch=t[0].match(sorttable.DATE_RE),y=mtch[3],m=mtch[2],d=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt1=y+m+d,mtch=e[0].match(sorttable.DATE_RE),y=mtch[3],m=mtch[2],d=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt2=y+m+d,dt1==dt2?0:dt1<dt2?-1:1},sort_mmdd:function(t,e){return mtch=t[0].match(sorttable.DATE_RE),y=mtch[3],d=mtch[2],m=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt1=y+m+d,mtch=e[0].match(sorttable.DATE_RE),y=mtch[3],d=mtch[2],m=mtch[1],1==m.length&&(m="0"+m),1==d.length&&(d="0"+d),dt2=y+m+d,dt1==dt2?0:dt1<dt2?-1:1},shaker_sort:function(t,e){for(var r=0,o=t.length-1,n=!0;n;){n=!1;for(var s=r;o>s;++s)if(e(t[s],t[s+1])>0){var a=t[s];t[s]=t[s+1],t[s+1]=a,n=!0}if(o--,!n)break;for(var s=o;s>r;--s)if(e(t[s],t[s-1])<0){var a=t[s];t[s]=t[s-1],t[s-1]=a,n=!0}r++}}},document.addEventListener&&document.addEventListener("DOMContentLoaded",sorttable.init,!1),/WebKit/i.test(navigator.userAgent))var _timer=setInterval(function(){/loaded|complete/.test(document.readyState)&&sorttable.init()},10);window.onload=sorttable.init,dean_addEvent.guid=1,fixEvent.preventDefault=function(){this.returnValue=!1},fixEvent.stopPropagation=function(){this.cancelBubble=!0},Array.forEach||(Array.forEach=function(t,e,r){for(var o=0;o<t.length;o++)e.call(r,t[o],o,t)}),Function.prototype.forEach=function(t,e,r){for(var o in t)"undefined"==typeof this.prototype[o]&&e.call(r,t[o],o,t)},String.forEach=function(t,e,r){Array.forEach(t.split(""),function(o,n){
e.call(r,o,n,t)})};var forEach=function(t,e,r){if(t){var o=Object;if(t instanceof Function)o=Function;else{if(t.forEach instanceof Function)return void t.forEach(e,r);"string"==typeof t?o=String:"number"==typeof t.length&&(o=Array)}o.forEach(t,e,r)}};if(function($){"use strict";function Redactor(el,options){return new Redactor.prototype.init(el,options)}Function.prototype.bind||(Function.prototype.bind=function(scope){var fn=this;return function(){return fn.apply(scope)}});var uuid=0;$.fn.redactor=function(options){var val=[],args=Array.prototype.slice.call(arguments,1);return this.each("string"==typeof options?function(){var func,instance=$.data(this,"redactor");if("-1"!=options.search(/\./)?(func=options.split("."),"undefined"!=typeof instance[func[0]]&&(func=instance[func[0]][func[1]])):func=instance[options],"undefined"!=typeof instance&&$.isFunction(func)){var methodVal=func.apply(instance,args);void 0!==methodVal&&methodVal!==instance&&val.push(methodVal)}else $.error('No such method "'+options+'" for Redactor')}:function(){$.data(this,"redactor",{}),$.data(this,"redactor",Redactor(this,options))}),0===val.length?this:1===val.length?val[0]:val},$.Redactor=Redactor,$.Redactor.VERSION="10.1.0",$.Redactor.modules=["alignment","autosave","block","buffer","build","button","caret","clean","code","core","dropdown","file","focus","image","indent","inline","insert","keydown","keyup","lang","line","link","list","modal","observe","paragraphize","paste","placeholder","progress","selection","shortcuts","tabifier","tidy","toolbar","upload","utils","linkify"],$.Redactor.opts={lang:"en",direction:"ltr",plugins:!1,focus:!1,focusEnd:!1,placeholder:!1,visual:!0,tabindex:!1,minHeight:!1,maxHeight:!1,linebreaks:!1,replaceDivs:!0,paragraphize:!0,cleanStyleOnEnter:!1,enterKey:!0,cleanOnPaste:!0,cleanSpaces:!0,pastePlainText:!1,autosave:!1,autosaveName:!1,autosaveInterval:60,autosaveOnChange:!1,autosaveFields:!1,linkTooltip:!0,linkProtocol:"http",linkNofollow:!1,linkSize:50,imageEditable:!0,imageLink:!0,imagePosition:!0,imageFloatMargin:"10px",imageResizable:!0,imageUpload:null,imageUploadParam:"file",uploadImageField:!1,dragImageUpload:!0,fileUpload:null,fileUploadParam:"file",dragFileUpload:!0,s3:!1,convertLinks:!0,convertUrlLinks:!0,convertImageLinks:!0,convertVideoLinks:!0,preSpaces:4,tabAsSpaces:!1,tabKey:!0,scrollTarget:!1,toolbar:!0,toolbarFixed:!0,toolbarFixedTarget:document,toolbarFixedTopOffset:0,toolbarExternal:!1,toolbarOverflow:!1,source:!0,buttons:["html","formatting","bold","italic","deleted","unorderedlist","orderedlist","outdent","indent","image","file","link","alignment","horizontalrule"],buttonsHide:[],buttonsHideOnMobile:[],formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,tabifier:!0,deniedTags:["script","style"],allowedTags:!1,removeComments:!1,replaceTags:[["strike","del"]],replaceStyles:[["font-weight:\\s?bold","strong"],["font-style:\\s?italic","em"],["text-decoration:\\s?underline","u"],["text-decoration:\\s?line-through","del"]],removeDataAttr:!1,removeAttr:!1,allowedAttr:!1,removeWithoutAttr:["span"],removeEmpty:["p"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","justify"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},shortcuts:{"ctrl+shift+m, meta+shift+m":{func:"inline.removeFormat"},"ctrl+b, meta+b":{func:"inline.format",params:["bold"]},"ctrl+i, meta+i":{func:"inline.format",params:["italic"]},"ctrl+h, meta+h":{func:"inline.format",params:["superscript"]},"ctrl+l, meta+l":{func:"inline.format",params:["subscript"]},"ctrl+k, meta+k":{func:"link.show"},"ctrl+shift+7":{func:"list.toggle",params:["orderedlist"]},"ctrl+shift+8":{func:"list.toggle",params:["unorderedlist"]}},shortcutsAdd:!1,buffer:[],rebuffer:[],emptyHtml:"<p>&#x200b;</p>",invisibleSpace:"&#x200b;",imageTypes:["image/png","image/jpeg","image/gif"],indentValue:20,verifiedTags:["a","img","b","strong","sub","sup","i","em","u","small","strike","del","cite","ul","ol","li"],inlineTags:["strong","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small"],alignmentTags:["P","H1","H2","H3","H4","H5","H6","DL","DT","DD","DIV","TD","BLOCKQUOTE","OUTPUT","FIGCAPTION","ADDRESS","SECTION","HEADER","FOOTER","ASIDE","ARTICLE"],blockLevelElements:["PRE","UL","OL","LI"],langs:{en:{html:"HTML",video:"Insert Video",image:"Insert Image",table:"Table",link:"Link",link_insert:"Insert link",link_edit:"Edit link",unlink:"Unlink",formatting:"Formatting",paragraph:"Normal text",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",header5:"Header 5",bold:"Bold",italic:"Italic",fontcolor:"Font Color",backcolor:"Back Color",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table",insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",center:"Center",image_web_link:"Image Web Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video Embed Code or Youtube/Vimeo Link",file:"Insert File",upload:"Upload",download:"Download",choose:"Choose",or_choose:"Or choose",drop_file_here:"Drop file here",align_left:"Align text to the left",align_center:"Center text",align_right:"Align text to the right",align_justify:"Justify text",horizontalrule:"Insert Horizontal Rule",deleted:"Deleted",anchor:"Anchor",link_new_tab:"Open link in new tab",underline:"Underline",alignment:"Alignment",filename:"Name (optional)",edit:"Edit",upload_label:"Drop file here or "}},linkify:{regexps:{youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.\-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,image:/((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/gi,url:/((?:http[s]?:\/\/(?:www\.)?|www\.){1}(?:[0-9A-Za-z\-%_]+\.)+[a-zA-Z]{2,}(?::[0-9]+)?(?:(?:\/[0-9A-Za-z\-#\.%\+_]*)+)?(?:\?(?:[0-9A-Za-z\-\.%_]+(?:=[0-9A-Za-z\-\.%_\+]*)?)?(?:&(?:[0-9A-Za-z\-\.%_]+(?:=[0-9A-Za-z\-\.%_\+]*)?)?)*)?(?:#[0-9A-Za-z\-\.%_\+=\?&;]*)?)/gi}},codemirror:!1},Redactor.fn=$.Redactor.prototype={keyCode:{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37,LEFT_WIN:91},init:function(el,options){if(this.$element=$(el),this.uuid=uuid++,this.rtePaste=!1,this.$pasteBox=!1,this.loadOptions(options),this.loadModules(),this.formatting={},$.merge(this.opts.blockLevelElements,this.opts.alignmentTags),this.reIsBlock=new RegExp("^("+this.opts.blockLevelElements.join("|")+")$","i"),this.tidy.setupAllowed(),this.opts.deniedTags!==!1)for(var tags=["html","head","link","body","meta","applet"],i=0;i<tags.length;i++)this.opts.deniedTags.push(tags[i]);this.lang.load(),$.extend(this.opts.shortcuts,this.opts.shortcutsAdd),this.core.setCallback("start"),this.start=!0,this.build.run()},loadOptions:function(options){this.opts=$.extend({},$.extend(!0,{},$.Redactor.opts),this.$element.data(),options)},getModuleMethods:function(object){return Object.getOwnPropertyNames(object).filter(function(property){return"function"==typeof object[property]})},loadModules:function(){for(var len=$.Redactor.modules.length,i=0;len>i;i++)this.bindModuleMethods($.Redactor.modules[i])},bindModuleMethods:function(module){if("undefined"!=typeof this[module]){this[module]=this[module]();for(var methods=this.getModuleMethods(this[module]),len=methods.length,z=0;len>z;z++)this[module][methods[z]]=this[module][methods[z]].bind(this)}},alignment:function(){return{left:function(){this.alignment.set("")},right:function(){this.alignment.set("right")},center:function(){this.alignment.set("center")},justify:function(){this.alignment.set("justify")},set:function(type){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save(),this.alignment.blocks=this.selection.getBlocks(),this.alignment.type=type,this.alignment.isLinebreaksOrNoBlocks()?this.alignment.setText():this.alignment.setBlocks(),this.selection.restore(),this.code.sync()},setText:function(){var wrapper=this.selection.wrap("div");$(wrapper).attr("data-tagblock","redactor").css("text-align",this.alignment.type)},setBlocks:function(){$.each(this.alignment.blocks,$.proxy(function(i,el){var $el=this.utils.getAlignmentElement(el);$el&&(this.alignment.isNeedReplaceElement($el)?this.alignment.replaceElement($el):this.alignment.alignElement($el))},this))},isLinebreaksOrNoBlocks:function(){return this.opts.linebreaks&&this.alignment.blocks[0]===!1},isNeedReplaceElement:function($el){return""===this.alignment.type&&"undefined"!=typeof $el.data("tagblock")},replaceElement:function($el){$el.replaceWith($el.html())},alignElement:function($el){$el.css("text-align",this.alignment.type),this.utils.removeEmptyAttr($el,"style")}}},autosave:function(){return{html:!1,enable:function(){this.opts.autosave&&(this.autosave.name=this.opts.autosaveName?this.opts.autosaveName:this.$textarea.attr("name"),this.opts.autosaveOnChange||(this.autosaveInterval=setInterval(this.autosave.load,1e3*this.opts.autosaveInterval)))},onChange:function(){this.opts.autosaveOnChange&&this.autosave.load()},load:function(){if(this.autosave.source=this.code.get(),this.autosave.html!==this.autosave.source){var data={};data.name=this.autosave.name,data[this.autosave.name]=this.autosave.source,data=this.autosave.getHiddenFields(data);var jsxhr=$.ajax({url:this.opts.autosave,type:"post",data:data});jsxhr.done(this.autosave.success)}},getHiddenFields:function(data){return this.opts.autosaveFields===!1||"object"!=typeof this.opts.autosaveFields?data:($.each(this.opts.autosaveFields,$.proxy(function(k,v){null!==v&&0===v.toString().indexOf("#")&&(v=$(v).val()),data[k]=v},this)),data)},success:function(data){var json;try{json=$.parseJSON(data)}catch(e){json=data}var callbackName="undefined"==typeof json.error?"autosave":"autosaveError";this.core.setCallback(callbackName,this.autosave.name,json),this.autosave.html=this.autosave.source},disable:function(){clearInterval(this.autosaveInterval)}}},block:function(){return{formatting:function(name){this.block.clearStyle=!1;var type,value;"undefined"!=typeof this.formatting[name].data?type="data":"undefined"!=typeof this.formatting[name].attr?type="attr":"undefined"!=typeof this.formatting[name]["class"]&&(type="class"),"undefined"!=typeof this.formatting[name].clear&&(this.block.clearStyle=!0),type&&(value=this.formatting[name][type]),this.block.format(this.formatting[name].tag,type,value)},format:function(tag,type,value){"quote"==tag&&(tag="blockquote");var formatTags=["p","pre","blockquote","h1","h2","h3","h4","h5","h6"];-1!=$.inArray(tag,formatTags)&&(this.block.isRemoveInline="pre"==tag||-1!=tag.search(/h[1-6]/i),this.utils.browser("msie")||this.$editor.focus(),this.block.blocks=this.selection.getBlocks(),this.block.blocksSize=this.block.blocks.length,this.block.type=type,this.block.value=value,this.buffer.set(),this.selection.save(),this.block.set(tag),this.selection.restore(),this.code.sync())},set:function(tag){this.selection.get(),this.block.containerTag=this.range.commonAncestorContainer.tagName,this.range.collapsed?this.block.setCollapsed(tag):this.block.setMultiple(tag)},setCollapsed:function(tag){var block=this.block.blocks[0];if(block!==!1){if("LI"==block.tagName){if("blockquote"!=tag)return;return void this.block.formatListToBlockquote()}var isContainerTable="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(isContainerTable&&!this.opts.linebreaks)document.execCommand("formatblock",!1,"<"+tag+">"),block=this.selection.getBlock(),this.block.toggle($(block));else if(block.tagName.toLowerCase()!=tag)if(this.opts.linebreaks&&"p"==tag)$(block).prepend("<br>").append("<br>"),this.utils.replaceWithContents(block);else{var $formatted=this.utils.replaceToTag(block,tag);this.block.toggle($formatted),"p"!=tag&&"blockquote"!=tag&&$formatted.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags($formatted),("p"==tag||this.block.headTag)&&$formatted.find("p").contents().unwrap(),this.block.formatTableWrapping($formatted)}else if("blockquote"==tag&&block.tagName.toLowerCase()==tag)if(this.opts.linebreaks)$(block).prepend("<br>").append("<br>"),this.utils.replaceWithContents(block);else{var $el=this.utils.replaceToTag(block,"p");this.block.toggle($el)}else block.tagName.toLowerCase()==tag&&this.block.toggle($(block));"undefined"==typeof this.block.type&&"undefined"==typeof this.block.value&&$(block).removeAttr("class").removeAttr("style")}},setMultiple:function(tag){var block=this.block.blocks[0],isContainerTable="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(block!==!1&&1===this.block.blocksSize)if(block.tagName.toLowerCase()==tag&&"blockquote"==tag)if(this.opts.linebreaks)$(block).prepend("<br>").append("<br>"),this.utils.replaceWithContents(block);else{var $el=this.utils.replaceToTag(block,"p");this.block.toggle($el)}else if("LI"==block.tagName){if("blockquote"!=tag)return;this.block.formatListToBlockquote()}else if("BLOCKQUOTE"==this.block.containerTag)this.block.formatBlockquote(tag);else if(this.opts.linebreaks&&(isContainerTable||this.range.commonAncestorContainer!=block))this.block.formatWrap(tag);else if(this.opts.linebreaks&&"p"==tag)$(block).prepend("<br>").append("<br>"),this.utils.replaceWithContents(block);else if("TD"===block.tagName)this.block.formatWrap(tag);else{var $formatted=this.utils.replaceToTag(block,tag);this.block.toggle($formatted),this.block.isRemoveInline&&this.utils.removeInlineTags($formatted),("p"==tag||this.block.headTag)&&$formatted.find("p").contents().unwrap()}else if(this.opts.linebreaks||"p"!=tag){if("blockquote"==tag){for(var count=0,i=0;i<this.block.blocksSize;i++)"BLOCKQUOTE"==this.block.blocks[i].tagName&&count++;if(count==this.block.blocksSize)return void $.each(this.block.blocks,$.proxy(function(i,s){var $formatted=!1;this.opts.linebreaks?($(s).prepend("<br>").append("<br>"),$formatted=this.utils.replaceWithContents(s)):$formatted=this.utils.replaceToTag(s,"p"),$formatted&&"undefined"==typeof this.block.type&&"undefined"==typeof this.block.value&&$formatted.removeAttr("class").removeAttr("style")},this))}this.block.formatWrap(tag)}else{var classSize=0,toggleType=!1;"class"==this.block.type&&(toggleType="toggle",classSize=$(this.block.blocks).filter("."+this.block.value).length,this.block.blocksSize==classSize?toggleType="toggle":this.block.blocksSize>classSize?toggleType="set":0===classSize&&(toggleType="set"));var exceptTags=["ul","ol","li","td","th","dl","dt","dd"];$.each(this.block.blocks,$.proxy(function(i,s){if(-1==$.inArray(s.tagName.toLowerCase(),exceptTags)){var $formatted=this.utils.replaceToTag(s,tag);toggleType?"toggle"==toggleType?this.block.toggle($formatted):"remove"==toggleType?this.block.remove($formatted):"set"==toggleType&&this.block.setForce($formatted):this.block.toggle($formatted),"p"!=tag&&"blockquote"!=tag&&$formatted.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags($formatted),("p"==tag||this.block.headTag)&&$formatted.find("p").contents().unwrap(),"undefined"==typeof this.block.type&&"undefined"==typeof this.block.value&&$formatted.removeAttr("class").removeAttr("style")}},this))}},setForce:function($el){return this.block.clearStyle&&$el.removeAttr("class").removeAttr("style"),"class"==this.block.type?void $el.addClass(this.block.value):"attr"==this.block.type||"data"==this.block.type?void $el.attr(this.block.value.name,this.block.value.value):void 0},toggle:function($el){return this.block.clearStyle&&$el.removeAttr("class").removeAttr("style"),"class"==this.block.type?void $el.toggleClass(this.block.value):"attr"==this.block.type||"data"==this.block.type?void($el.attr(this.block.value.name)==this.block.value.value?$el.removeAttr(this.block.value.name):$el.attr(this.block.value.name,this.block.value.value)):void $el.removeAttr("style class")},remove:function($el){$el.removeClass(this.block.value)},formatListToBlockquote:function(){var block=$(this.block.blocks[0]).closest("ul, ol",this.$editor[0]);$(block).find("ul, ol").contents().unwrap(),$(block).find("li").append($("<br>")).contents().unwrap();var $el=this.utils.replaceToTag(block,"blockquote");this.block.toggle($el)},formatBlockquote:function(tag){document.execCommand("outdent"),document.execCommand("formatblock",!1,tag),this.clean.clearUnverified(),this.$editor.find("p:empty").remove();var formatted=this.selection.getBlock();"p"!=tag&&$(formatted).find("img").remove(),this.opts.linebreaks||this.block.toggle($(formatted)),this.$editor.find("ul, ol, tr, blockquote, p").each($.proxy(this.utils.removeEmpty,this)),this.opts.linebreaks&&"p"==tag&&this.utils.replaceWithContents(formatted)},formatWrap:function(tag){if("UL"==this.block.containerTag||"OL"==this.block.containerTag){if("blockquote"!=tag)return;this.block.formatListToBlockquote()}var formatted=this.selection.wrap(tag);if(formatted!==!1){var $formatted=$(formatted);this.block.formatTableWrapping($formatted);var $elements=$formatted.find(this.opts.blockLevelElements.join(",")+", td, table, thead, tbody, tfoot, th, tr");(this.opts.linebreaks&&"p"==tag||"pre"==tag||"blockquote"==tag)&&$elements.append("<br />"),$elements.contents().unwrap(),"p"!=tag&&"blockquote"!=tag&&$formatted.find("img").remove(),$.each(this.block.blocks,$.proxy(this.utils.removeEmpty,this)),$formatted.append(this.selection.getMarker(2)),this.opts.linebreaks||this.block.toggle($formatted),this.$editor.find("ul, ol, tr, blockquote, p").each($.proxy(this.utils.removeEmpty,this)),$formatted.find("blockquote:empty").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags($formatted),this.opts.linebreaks&&"p"==tag&&this.utils.replaceWithContents($formatted)}},formatTableWrapping:function($formatted){0!==$formatted.closest("table",this.$editor[0]).length&&(0===$formatted.closest("tr",this.$editor[0]).length&&$formatted.wrap("<tr>"),0===$formatted.closest("td",this.$editor[0]).length&&0===$formatted.closest("th").length&&$formatted.wrap("<td>"))},removeData:function(name,value){var blocks=this.selection.getBlocks();$(blocks).removeAttr("data-"+name),this.code.sync()},setData:function(name,value){var blocks=this.selection.getBlocks();$(blocks).attr("data-"+name,value),this.code.sync()},toggleData:function(name,value){var blocks=this.selection.getBlocks();$.each(blocks,function(){$(this).attr("data-"+name)?$(this).removeAttr("data-"+name):$(this).attr("data-"+name,value)})},removeAttr:function(attr,value){var blocks=this.selection.getBlocks();$(blocks).removeAttr(attr),this.code.sync()},setAttr:function(attr,value){var blocks=this.selection.getBlocks();$(blocks).attr(attr,value),this.code.sync()},toggleAttr:function(attr,value){var blocks=this.selection.getBlocks();$.each(blocks,function(){$(this).attr(name)?$(this).removeAttr(name):$(this).attr(name,value)})},removeClass:function(className){var blocks=this.selection.getBlocks();$(blocks).removeClass(className),this.utils.removeEmptyAttr(blocks,"class"),this.code.sync()},setClass:function(className){var blocks=this.selection.getBlocks();$(blocks).addClass(className),this.code.sync()},toggleClass:function(className){var blocks=this.selection.getBlocks();$(blocks).toggleClass(className),this.code.sync()}}},buffer:function(){return{set:function(type){"undefined"==typeof type||"undo"==type?this.buffer.setUndo():this.buffer.setRedo()},setUndo:function(){this.selection.save(),this.opts.buffer.push(this.$editor.html()),this.selection.restore()},setRedo:function(){this.selection.save(),this.opts.rebuffer.push(this.$editor.html()),this.selection.restore()},getUndo:function(){this.$editor.html(this.opts.buffer.pop())},getRedo:function(){this.$editor.html(this.opts.rebuffer.pop())},add:function(){this.opts.buffer.push(this.$editor.html())},undo:function(){0!==this.opts.buffer.length&&(this.buffer.set("redo"),this.buffer.getUndo(),this.selection.restore(),setTimeout($.proxy(this.observe.load,this),50))},redo:function(){0!==this.opts.rebuffer.length&&(this.buffer.set("undo"),this.buffer.getRedo(),this.selection.restore(),setTimeout($.proxy(this.observe.load,this),50))}}},build:function(){return{run:function(){this.build.createContainerBox(),this.build.loadContent(),this.build.loadEditor(),this.build.enableEditor(),this.build.setCodeAndCall()},isTextarea:function(){return"TEXTAREA"===this.$element[0].tagName},createContainerBox:function(){this.$box=$('<div class="redactor-box" />')},createTextarea:function(){this.$textarea=$("<textarea />").attr("name",this.build.getTextareaName())},getTextareaName:function(){return"undefined"==typeof name?"content-"+this.uuid:this.$element.attr("id")},loadContent:function(){var func=this.build.isTextarea()?"val":"html";this.content=$.trim(this.$element[func]())},enableEditor:function(){this.$editor.attr({contenteditable:!0,dir:this.opts.direction})},loadEditor:function(){var func=this.build.isTextarea()?"fromTextarea":"fromElement";this.build[func]()},fromTextarea:function(){this.$editor=$("<div />"),this.$textarea=this.$element,this.$box.insertAfter(this.$element).append(this.$editor).append(this.$element),this.$editor.addClass("redactor-editor"),this.$element.hide()},fromElement:function(){this.$editor=this.$element,this.build.createTextarea(),this.$box.insertAfter(this.$editor).append(this.$editor).append(this.$textarea),this.$editor.addClass("redactor-editor"),this.$textarea.hide()},setCodeAndCall:function(){this.code.set(this.content),this.build.setOptions(),this.build.callEditor(),this.opts.visual||setTimeout($.proxy(this.code.showCode,this),200)},callEditor:function(){this.build.disableMozillaEditing(),this.build.setEvents(),this.build.setHelpers(),this.opts.toolbar&&(this.opts.toolbar=this.toolbar.init(),this.toolbar.build()),this.modal.loadTemplates(),this.build.plugins(),setTimeout($.proxy(this.observe.load,this),4),this.core.setCallback("init")},setOptions:function(){$(this.$textarea).attr("dir",this.opts.direction),this.opts.linebreaks&&this.$editor.addClass("redactor-linebreaks"),this.opts.tabindex&&this.$editor.attr("tabindex",this.opts.tabindex),this.opts.minHeight&&this.$editor.css("minHeight",this.opts.minHeight),this.opts.maxHeight&&this.$editor.css("maxHeight",this.opts.maxHeight)},setEventDropUpload:function(e){if(e.preventDefault(),this.opts.dragImageUpload&&this.opts.dragFileUpload){var files=e.dataTransfer.files;this.upload.directUpload(files[0],e)}},setEventDrop:function(e){this.code.sync(),setTimeout(this.clean.clearUnverified,1),this.core.setCallback("drop",e)},setEvents:function(){this.$editor.on("drop.redactor",$.proxy(function(e){return e=e.originalEvent||e,void 0!==window.FormData&&e.dataTransfer?0===e.dataTransfer.files.length?this.build.setEventDrop(e):(this.build.setEventDropUpload(e),setTimeout(this.clean.clearUnverified,1),void this.core.setCallback("drop",e)):!0},this)),this.$editor.on("click.redactor",$.proxy(function(e){var event=this.core.getEvent(),type="click"==event||"arrow"==event?!1:"click";this.core.addEvent(type),this.utils.disableSelectAll(),this.core.setCallback("click",e)},this)),this.$editor.on("paste.redactor",$.proxy(this.paste.init,this)),this.$editor.on("keydown.redactor",$.proxy(this.keydown.init,this)),this.$editor.on("keyup.redactor",$.proxy(this.keyup.init,this)),$.isFunction(this.opts.codeKeydownCallback)&&this.$textarea.on("keydown.redactor-textarea",$.proxy(this.opts.codeKeydownCallback,this)),$.isFunction(this.opts.codeKeyupCallback)&&this.$textarea.on("keyup.redactor-textarea",$.proxy(this.opts.codeKeyupCallback,this)),$.isFunction(this.opts.focusCallback)&&this.$editor.on("focus.redactor",$.proxy(this.opts.focusCallback,this));var clickedElement;$(document).on("mousedown",function(e){clickedElement=e.target}),this.$editor.on("blur.redactor",$.proxy(function(e){this.rtePaste||this.build.isBlured(clickedElement)&&(this.utils.disableSelectAll(),$.isFunction(this.opts.blurCallback)&&this.core.setCallback("blur",e))},this))},isBlured:function(clickedElement){var $el=$(clickedElement);return!$el.hasClass("redactor-toolbar, redactor-dropdown")&&!$el.is("#redactor-modal")&&0===$el.parents(".redactor-toolbar, .redactor-dropdown, #redactor-modal").length},setHelpers:function(){this.linkify.isEnabled()&&this.linkify.format(),this.placeholder.enable(),this.opts.focus&&setTimeout(this.focus.setStart,100),this.opts.focusEnd&&setTimeout(this.focus.setEnd,100)},plugins:function(){this.opts.plugins&&RedactorPlugins&&$.each(this.opts.plugins,$.proxy(function(i,s){if("undefined"!=typeof RedactorPlugins[s]){if(-1!==$.inArray(s,$.Redactor.modules))return void $.error('Plugin name "'+s+"\" matches the name of the Redactor's module.");if($.isFunction(RedactorPlugins[s])){this[s]=RedactorPlugins[s]();for(var methods=this.getModuleMethods(this[s]),len=methods.length,z=0;len>z;z++)this[s][methods[z]]=this[s][methods[z]].bind(this);$.isFunction(this[s].init)&&this[s].init()}}},this))},disableMozillaEditing:function(){if(this.utils.browser("mozilla"))try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}}}},button:function(){return{build:function(btnName,btnObject){var $button=$('<a href="#" class="re-icon re-'+btnName+'" rel="'+btnName+'" />').attr("tabindex","-1");if((btnObject.func||btnObject.command||btnObject.dropdown)&&this.button.setEvent($button,btnName,btnObject),btnObject.dropdown){var $dropdown=$('<div class="redactor-dropdown redactor-dropdown-'+this.uuid+" redactor-dropdown-box-"+btnName+'" style="display: none;">');$button.data("dropdown",$dropdown),this.dropdown.build(btnName,$dropdown,btnObject.dropdown)}return this.utils.isDesktop()&&this.button.createTooltip($button,btnName,btnObject.title),$button},setEvent:function($button,btnName,btnObject){$button.on("touchstart click",$.proxy(function(e){if($button.hasClass("redactor-button-disabled"))return!1;var type="func",callback=btnObject.func;btnObject.command?(type="command",callback=btnObject.command):btnObject.dropdown&&(type="dropdown",callback=!1),this.button.onClick(e,btnName,type,callback)},this))},createTooltip:function($button,name,title){var $tooltip=$("<span>").addClass("redactor-toolbar-tooltip redactor-toolbar-tooltip-"+name).hide().html(title);$tooltip.appendTo("body"),$button.on("mouseover",function(){if(!$(this).hasClass("redactor-button-disabled")){var pos=$button.offset();$tooltip.show(),$tooltip.css({top:pos.top+$button.innerHeight()+"px",left:pos.left+$button.innerWidth()/2-$tooltip.innerWidth()/2+"px"})}}),$button.on("mouseout",function(){$tooltip.hide()})},onClick:function(e,btnName,type,callback){this.button.caretOffset=this.caret.getOffset(),e.preventDefault(),this.utils.browser("msie")&&(e.returnValue=!1),"command"==type?this.inline.format(callback):"dropdown"==type?this.dropdown.show(e,btnName):this.button.onClickCallback(e,callback,btnName)},onClickCallback:function(e,callback,btnName){var func;if($.isFunction(callback))callback.call(this,btnName);else if("-1"!=callback.search(/\./)){if(func=callback.split("."),"undefined"==typeof this[func[0]])return;this[func[0]][func[1]](btnName)}else this[callback](btnName);this.observe.buttons(e,btnName)},get:function(key){return this.$toolbar.find("a.re-"+key)},setActive:function(key){this.button.get(key).addClass("redactor-act")},setInactive:function(key){this.button.get(key).removeClass("redactor-act")},setInactiveAll:function(key){"undefined"==typeof key?this.$toolbar.find("a.re-icon").removeClass("redactor-act"):this.$toolbar.find("a.re-icon").not(".re-"+key).removeClass("redactor-act")},setActiveInVisual:function(){this.$toolbar.find("a.re-icon").not("a.re-html").removeClass("redactor-button-disabled")},setInactiveInCode:function(){this.$toolbar.find("a.re-icon").not("a.re-html").addClass("redactor-button-disabled")},changeIcon:function(key,classname){this.button.get(key).addClass("re-"+classname)},removeIcon:function(key,classname){this.button.get(key).removeClass("re-"+classname)},setAwesome:function(key,name){var $button=this.button.get(key);$button.removeClass("redactor-btn-image").addClass("fa-redactor-btn"),$button.html('<i class="fa '+name+'"></i>')},addCallback:function($btn,callback){var type="dropdown"==callback?"dropdown":"func",key=$btn.attr("rel");$btn.on("touchstart click",$.proxy(function(e){return $btn.hasClass("redactor-button-disabled")?!1:void this.button.onClick(e,key,type,callback)},this))},addDropdown:function($btn,dropdown){var key=$btn.attr("rel");this.button.addCallback($btn,"dropdown");var $dropdown=$('<div class="redactor-dropdown redactor-dropdown-'+this.uuid+" redactor-dropdown-box-"+key+'" style="display: none;">');return $btn.data("dropdown",$dropdown),dropdown&&this.dropdown.build(key,$dropdown,dropdown),$dropdown},add:function(key,title){if(this.opts.toolbar){var btn=this.button.build(key,{title:title});return btn.addClass("redactor-btn-image"),this.$toolbar.append($("<li>").append(btn)),btn}},addFirst:function(key,title){if(this.opts.toolbar){var btn=this.button.build(key,{title:title});return btn.addClass("redactor-btn-image"),this.$toolbar.prepend($("<li>").append(btn)),btn}},addAfter:function(afterkey,key,title){if(this.opts.toolbar){var btn=this.button.build(key,{title:title});btn.addClass("redactor-btn-image");var $btn=this.button.get(afterkey);return 0!==$btn.length?$btn.parent().after($("<li>").append(btn)):this.$toolbar.append($("<li>").append(btn)),btn}},addBefore:function(beforekey,key,title){if(this.opts.toolbar){var btn=this.button.build(key,{title:title});btn.addClass("redactor-btn-image");var $btn=this.button.get(beforekey);return 0!==$btn.length?$btn.parent().before($("<li>").append(btn)):this.$toolbar.append($("<li>").append(btn)),btn}},remove:function(key){this.button.get(key).remove()}}},caret:function(){return{setStart:function(node){if(this.utils.isBlock(node))this.caret.set(node,0,node,0);else{var space=this.utils.createSpaceElement();$(node).prepend(space),this.caret.setEnd(space)}},setEnd:function(node){this.caret.set(node,1,node,1)},set:function(orgn,orgo,focn,foco){if(orgn=orgn[0]||orgn,focn=focn[0]||focn,this.utils.isBlockTag(orgn.tagName)&&""===orgn.innerHTML&&(orgn.innerHTML=this.opts.invisibleSpace),"BR"==orgn.tagName&&this.opts.linebreaks===!1){var parent=$(this.opts.emptyHtml)[0];$(orgn).replaceWith(parent),orgn=parent,focn=orgn}this.selection.get();try{this.range.setStart(orgn,orgo),this.range.setEnd(focn,foco)}catch(e){}this.selection.addRange()},setAfter:function(node){try{var tag=$(node)[0].tagName;if("BR"==tag||this.utils.isBlock(node))"BR"!=tag&&this.utils.browser("msie")?this.caret.setStart($(node).next()):this.caret.setAfterOrBefore(node,"after");else{var space=this.utils.createSpaceElement();$(node).after(space),this.caret.setEnd(space)}}catch(e){var space=this.utils.createSpaceElement();$(node).after(space),this.caret.setEnd(space)}},setBefore:function(node){this.utils.isBlock(node)?this.caret.setEnd($(node).prev()):this.caret.setAfterOrBefore(node,"before")},setAfterOrBefore:function(node,type){if(this.utils.browser("msie")||this.$editor.focus(),node=node[0]||node,this.selection.get(),"after"==type)try{this.range.setStartAfter(node),this.range.setEndAfter(node)}catch(e){}else try{this.range.setStartBefore(node),this.range.setEndBefore(node)}catch(e){}this.range.collapse(!1),this.selection.addRange()},getOffsetOfElement:function(node){node=node[0]||node,this.selection.get();var cloned=this.range.cloneRange();return cloned.selectNodeContents(node),cloned.setEnd(this.range.endContainer,this.range.endOffset),
$.trim(cloned.toString()).length},getOffset:function(){var offset=0,sel=window.getSelection();if(sel.rangeCount>0){var range=window.getSelection().getRangeAt(0),caretRange=range.cloneRange();caretRange.selectNodeContents(this.$editor[0]),caretRange.setEnd(range.endContainer,range.endOffset),offset=caretRange.toString().length}return offset},setOffset:function(start,end){"undefined"==typeof end&&(end=start),this.focus.isFocused()||this.focus.setStart();for(var node,offset=(this.selection.get(),0),walker=document.createTreeWalker(this.$editor[0],NodeFilter.SHOW_TEXT,null,null);node=walker.nextNode();)if(offset+=node.nodeValue.length,offset>start&&(this.range.setStart(node,node.nodeValue.length+start-offset),start=1/0),offset>=end){this.range.setEnd(node,node.nodeValue.length+end-offset);break}this.range.collapse(!1),this.selection.addRange()},setToPoint:function(start,end){this.caret.setOffset(start,end)},getCoords:function(){return this.caret.getOffset()}}},clean:function(){return{onSet:function(html){html=this.clean.savePreCode(html),html=html.replace(/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi,'<pre class="redactor-script-tag" style="display: none;" $1>$2</pre>'),html=html.replace(/\$/g,"&#36;"),html=html.replace(/<a href="(.*?[^>]?)(.*?[^>]?)">/gi,'<a href="$1&reg$2">'),this.opts.replaceDivs&&(html=this.clean.replaceDivs(html)),this.opts.linebreaks&&(html=this.clean.replaceParagraphsToBr(html)),html=this.clean.saveFormTags(html);var $div=$("<div>");$div.html(html);var fonts=$div.find("font[style]");return 0!==fonts.length&&(fonts.replaceWith(function(){var $el=$(this),$span=$("<span>").attr("style",$el.attr("style"));return $span.append($el.contents())}),html=$div.html()),$div.remove(),html=html.replace(/<font(.*?[^<])>/gi,""),html=html.replace(/<\/font>/gi,""),html=this.tidy.load(html),this.opts.paragraphize&&(html=this.paragraphize.load(html)),html=this.clean.setVerified(html),html=this.clean.convertInline(html)},onSync:function(html){if(html=html.replace(/[\u200B-\u200D\uFEFF]/g,""),html=html.replace(/&#x200b;/gi,""),this.opts.cleanSpaces&&(html=html.replace(/&nbsp;/gi," ")),-1!=html.search(/^<p>(||\s||<br\s?\/?>||&nbsp;)<\/p>$/i))return"";html=html.replace(/<pre class="redactor-script-tag" style="display: none;"(.*?[^>]?)>([\w\W]*?)<\/pre>/gi,"<script$1>$2</script>"),html=this.clean.restoreFormTags(html);var chars={"":"&trade;","":"&copy;","":"&hellip;","":"&mdash;","":"&dash;"};return $.each(chars,function(i,s){html=html.replace(new RegExp(i,"g"),s)}),html=html.replace(new RegExp("<br\\s?/?></li>","gi"),"</li>"),html=html.replace(new RegExp("</li><br\\s?/?>","gi"),"</li>"),html=html.replace(/<div(.*?[^>]) data-tagblock="redactor"(.*?[^>])>/gi,"<div$1$2>"),html=html.replace(/<(.*?) data-verified="redactor"(.*?[^>])>/gi,"<$1$2>"),html=html.replace(/<span(.*?[^>])\srel="(.*?[^>])"(.*?[^>])>/gi,"<span$1$3>"),html=html.replace(/<img(.*?[^>])\srel="(.*?[^>])"(.*?[^>])>/gi,"<img$1$3>"),html=html.replace(/<img(.*?[^>])\sstyle="" (.*?[^>])>'/gi,"<img$1 $2>"),html=html.replace(/<img(.*?[^>])\sstyle (.*?[^>])>'/gi,"<img$1 $2>"),html=html.replace(/<span class="redactor-invisible-space">(.*?)<\/span>/gi,"$1"),html=html.replace(/ data-save-url="(.*?[^>])"/gi,""),html=html.replace(/<span(.*?)id="redactor-image-box"(.*?[^>])>([\w\W]*?)<img(.*?)><\/span>/gi,"$3<img$4>"),html=html.replace(/<span(.*?)id="redactor-image-resizer"(.*?[^>])>(.*?)<\/span>/gi,""),html=html.replace(/<span(.*?)id="redactor-image-editter"(.*?[^>])>(.*?)<\/span>/gi,""),html=html.replace(/<font(.*?[^<])>/gi,""),html=html.replace(/<\/font>/gi,""),html=this.tidy.load(html),this.opts.linkNofollow&&(html=html.replace(/<a(.*?)rel="nofollow"(.*?[^>])>/gi,"<a$1$2>"),html=html.replace(/<a(.*?[^>])>/gi,'<a$1 rel="nofollow">')),html=html.replace(/\sdata-redactor-(tag|class|style)="(.*?[^>])"/gi,""),html=html.replace(new RegExp('<(.*?) data-verified="redactor"(.*?[^>])>',"gi"),"<$1$2>"),html=html.replace(new RegExp('<(.*?) data-verified="redactor">',"gi"),"<$1>")},onPaste:function(html,setMode){if(html=$.trim(html),html=html.replace(/\$/g,"&#36;"),html=html.replace(/<span class="s1">/gi,"<span>"),html=html.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),html=html.replace(/<span class="Apple-tab-span"[^>]*>\t<\/span>/gi,"	"),html=html.replace(/<span[^>]*>(\s|&nbsp;)<\/span>/gi," "),this.opts.pastePlainText)return this.clean.getPlainText(html);if(!this.utils.isSelectAll()&&"undefined"==typeof setMode){if(this.utils.isCurrentOrParent(["FIGCAPTION","A"]))return this.clean.getPlainText(html,!1);if(this.utils.isCurrentOrParent("PRE"))return html=html.replace(//g,'"'),html=html.replace(//g,'"'),html=html.replace(//g,"'"),html=html.replace(//g,"'"),this.clean.getPreCode(html);if(this.utils.isCurrentOrParent(["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"])){if(html=this.clean.getOnlyImages(html),!this.utils.browser("msie")){var block=this.selection.getBlock();block&&"P"==block.tagName&&(html=html.replace(/<img(.*?)>/gi,"<p><img$1></p>"))}return html}if(this.utils.isCurrentOrParent(["TD"]))return html=this.clean.onPasteTidy(html,"td"),this.opts.linebreaks&&(html=this.clean.replaceParagraphsToBr(html)),html=this.clean.replaceDivsToBr(html);if(this.utils.isCurrentOrParent(["LI"]))return this.clean.onPasteTidy(html,"li")}return html=this.clean.isSingleLine(html,setMode),this.clean.singleLine||(this.opts.linebreaks&&(html=this.clean.replaceParagraphsToBr(html)),this.opts.replaceDivs&&(html=this.clean.replaceDivs(html)),html=this.clean.saveFormTags(html)),html=this.clean.onPasteWord(html),html=this.clean.onPasteExtra(html),html=this.clean.onPasteTidy(html,"all"),!this.clean.singleLine&&this.opts.paragraphize&&(html=this.paragraphize.load(html)),html=this.clean.removeDirtyStyles(html),html=this.clean.onPasteRemoveSpans(html),html=this.clean.onPasteRemoveEmpty(html),html=this.clean.convertInline(html)},onPasteWord:function(html){return html=html.replace(/<!--[\s\S]*?-->/gi,""),html=html.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,""),/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(html)&&(html=this.clean.onPasteIeFixLinks(html),html=html.replace(/<img(.*?)v:shapes=(.*?)>/gi,""),html=html.replace(/src="file\:\/\/(.*?)"/,'src=""'),html=html.replace(/<p(.*?)class="MsoListParagraphCxSpFirst"([\w\W]*?)<\/p>/gi,"<ul><li$2</li>"),html=html.replace(/<p(.*?)class="MsoListParagraphCxSpMiddle"([\w\W]*?)<\/p>/gi,"<li$2</li>"),html=html.replace(/<p(.*?)class="MsoListParagraphCxSpLast"([\w\W]*?)<\/p>/gi,"<li$2</li></ul>"),html=html.replace(/<p(.*?)class="MsoListParagraph"([\w\W]*?)<\/p>/gi,"<ul><li$2</li></ul>"),html=html.replace(//g,""),html=html.replace(/<p class="Mso(.*?)"/gi,"<p"),html=html.replace(/ class=\"(mso[^\"]*)\"/gi,""),html=html.replace(/ class=(mso\w+)/gi,""),html=html.replace(/<o:p(.*?)>([\w\W]*?)<\/o:p>/gi,"$2"),html=html.replace(/\n/g," "),html=html.replace(/<p>\n?<li>/gi,"<li>")),this.opts.cleanSpaces&&(html=html.replace(/(\s|&nbsp;)+/g," ")),html},onPasteExtra:function(html){return html=html.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),html=html.replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3"),html=html.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi,'<span style="font-weight: bold;"><span style="font-style: italic;">'),html=html.replace(/<span[^>]*font-style: italic[^>]*>/gi,'<span style="font-style: italic;">'),html=html.replace(/<span[^>]*font-weight: bold[^>]*>/gi,'<span style="font-weight: bold;">'),html=html.replace(/<span[^>]*text-decoration: underline[^>]*>/gi,'<span style="text-decoration: underline;">'),html=html.replace(/<img>/gi,""),html=html.replace(/\n{3,}/gi,"\n"),html=html.replace(/<font(.*?)>([\w\W]*?)<\/font>/gi,"$2"),html=html.replace(/<p><p>/gi,"<p>"),html=html.replace(/<\/p><\/p>/gi,"</p>"),html=html.replace(/<li>(\s*|\t*|\n*)<p>/gi,"<li>"),html=html.replace(/<\/p>(\s*|\t*|\n*)<\/li>/gi,"</li>"),html=html.replace(/<\/p>\s<p/gi,"</p><p"),html=html.replace(/<img src="webkit-fake-url\:\/\/(.*?)"(.*?)>/gi,""),html=html.replace(/<p>([\w\W]*?)<\/p>/gi,"<li>$1</li>"),this.utils.browser("mozilla")&&(html=html.replace(/<br\s?\/?>$/gi,"")),html},onPasteTidy:function(html,type){var tags=["span","a","pre","blockquote","small","em","strong","code","kbd","mark","address","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","p","br","video","audio","iframe","embed","param","object","img","table","td","th","tr","tbody","tfoot","thead","h1","h2","h3","h4","h5","h6"],tagsEmpty=!1,attrAllowed=[["a","*"],["img",["src","alt"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]];"all"==type?(tagsEmpty=["p","span","h1","h2","h3","h4","h5","h6"],attrAllowed=[["table","class"],["td",["colspan","rowspan"]],["a","*"],["img",["src","alt","data-redactor-inserted-image"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]]):"td"==type?tags=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","br","iframe","video","audio","embed","param","object","img","h1","h2","h3","h4","h5","h6"]:"li"==type&&(tags=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","br","iframe","video","audio","embed","param","object","img"]);var options={deniedTags:!1,allowedTags:tags,removeComments:!0,removePhp:!0,removeAttr:!1,allowedAttr:attrAllowed,removeEmpty:tagsEmpty};return this.opts.deniedTags&&(options.deniedTags=this.opts.deniedTags),this.opts.allowedTags&&(options.allowedTags=this.opts.allowedTags),this.tidy.load(html,options)},onPasteRemoveEmpty:function(html){return html=html.replace(/<(p|h[1-6])>(|\s|\n|\t|<br\s?\/?>)<\/(p|h[1-6])>/gi,""),this.opts.linebreaks||(html=html.replace(/<br>$/i,"")),html},onPasteRemoveSpans:function(html){return html=html.replace(/<span>(.*?)<\/span>/gi,"$1"),html=html.replace(/<span[^>]*>\s|&nbsp;<\/span>/gi," ")},onPasteIeFixLinks:function(html){if(!this.utils.browser("msie"))return html;var tmp=$.trim(html);return 0===tmp.search(/^<a(.*?)>(.*?)<\/a>$/i)&&(html=html.replace(/^<a(.*?)>(.*?)<\/a>$/i,"$2")),html},isSingleLine:function(html,setMode){if(this.clean.singleLine=!1,!this.utils.isSelectAll()&&"undefined"==typeof setMode){var blocks=this.opts.blockLevelElements.join("|").replace("P|","").replace("DIV|",""),matchBlocks=html.match(new RegExp("</("+blocks+")>","gi")),matchContainers=html.match(/<\/(p|div)>/gi);if(!matchBlocks&&(null===matchContainers||matchContainers&&matchContainers.length<=1)){var matchBR=html.match(/<br\s?\/?>/gi),matchIMG=html.match(/<img(.*?[^>])>/gi);matchBR||matchIMG||(this.clean.singleLine=!0,html=html.replace(/<\/?(p|div)(.*?)>/gi,""))}}return html},stripTags:function(input,allowed){allowed=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return input.replace(tags,function($0,$1){return allowed.indexOf("<"+$1.toLowerCase()+">")>-1?$0:""})},savePreCode:function(html){return html=this.clean.savePreFormatting(html),html=this.clean.saveCodeFormatting(html)},savePreFormatting:function(html){var pre=html.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==pre&&$.each(pre,$.proxy(function(i,s){var arr=s.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);arr[2]=arr[2].replace(/<br\s?\/?>/g,"\n"),arr[2]=arr[2].replace(/&nbsp;/g," "),this.opts.preSpaces&&(arr[2]=arr[2].replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),arr[2]=this.clean.encodeEntities(arr[2]),arr[2]=arr[2].replace(/\$/g,"&#36;"),html=html.replace(s,"<pre"+arr[1]+">"+arr[2]+"</pre>")},this)),html},saveCodeFormatting:function(html){var code=html.match(/<code(.*?[^>])>(.*?)<\/code>/gi);return null!==code&&$.each(code,$.proxy(function(i,s){var arr=s.match(/<code(.*?[^>])>(.*?)<\/code>/i);arr[2]=arr[2].replace(/&nbsp;/g," "),arr[2]=this.clean.encodeEntities(arr[2]),arr[2]=arr[2].replace(/\$/g,"&#36;"),html=html.replace(s,"<code"+arr[1]+">"+arr[2]+"</code>")},this)),html},getTextFromHtml:function(html){html=html.replace(/<br\s?\/?>|<\/H[1-6]>|<\/p>|<\/div>|<\/li>|<\/td>/gi,"\n");var tmp=document.createElement("div");return tmp.innerHTML=html,html=tmp.textContent||tmp.innerText,$.trim(html)},getPlainText:function(html,paragraphize){return html=this.clean.getTextFromHtml(html),html=html.replace(/\n/g,"<br />"),this.opts.paragraphize&&"undefined"==typeof paragraphize&&!this.utils.browser("mozilla")&&(html=this.paragraphize.load(html)),html},getPreCode:function(html){return html=html.replace(/<img(.*?) style="(.*?)"(.*?[^>])>/gi,"<img$1$3>"),html=html.replace(/<img(.*?)>/gi,"&lt;img$1&gt;"),html=this.clean.getTextFromHtml(html),this.opts.preSpaces&&(html=html.replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),html=this.clean.encodeEntities(html)},getOnlyImages:function(html){return html=html.replace(/<img(.*?)>/gi,"[img$1]"),html=html.replace(/<([Ss]*?)>/gi,""),html=html.replace(/\[img(.*?)\]/gi,"<img$1>")},getOnlyLinksAndImages:function(html){return html=html.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),html=html.replace(/<img(.*?)>/gi,"[img$1]"),html=html.replace(/<(.*?)>/gi,""),html=html.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),html=html.replace(/\[img(.*?)\]/gi,"<img$1>")},encodeEntities:function(str){return str=String(str).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},removeDirtyStyles:function(html){if(this.utils.browser("msie"))return html;var div=document.createElement("div");return div.innerHTML=html,this.clean.clearUnverifiedRemove($(div)),html=div.innerHTML,$(div).remove(),html},clearUnverified:function(){if(!this.utils.browser("msie")){this.clean.clearUnverifiedRemove(this.$editor);var headers=this.$editor.find("h1, h2, h3, h4, h5, h6");headers.find("span").removeAttr("style"),headers.find(this.opts.verifiedTags.join(", ")).removeAttr("style"),this.code.sync()}},clearUnverifiedRemove:function($editor){$editor.find(this.opts.verifiedTags.join(", ")).removeAttr("style"),$editor.find("span").not('[data-verified="redactor"]').removeAttr("style"),$editor.find('span[data-verified="redactor"], img[data-verified="redactor"]').each(function(i,s){var $s=$(s);$s.attr("style",$s.attr("rel"))})},cleanEmptyParagraph:function(){var p=this.$editor.find("p").first();this.utils.isEmpty(p.html())&&p.remove()},setVerified:function(html){if(this.utils.browser("msie"))return html;html=html.replace(new RegExp("<img(.*?[^>])>","gi"),'<img$1 data-verified="redactor">'),html=html.replace(new RegExp("<span(.*?[^>])>","gi"),'<span$1 data-verified="redactor">');var matches=html.match(new RegExp('<(span|img)(.*?)style="(.*?)"(.*?[^>])>',"gi"));if(matches)for(var len=matches.length,i=0;len>i;i++)try{var newTag=matches[i].replace(/style="(.*?)"/i,'style="$1" rel="$1"');html=html.replace(matches[i],newTag)}catch(e){}return html},convertInline:function(html){var $div=$("<div />").html(html),tags=this.opts.inlineTags;return tags.push("span"),$div.find(tags.join(",")).each(function(){var $el=$(this),tag=this.tagName.toLowerCase();$el.attr("data-redactor-tag",tag),"span"==tag&&($el.attr("style")?$el.attr("data-redactor-style",$el.attr("style")):$el.attr("class")&&$el.attr("data-redactor-class",$el.attr("class")))}),html=$div.html(),$div.remove(),html},normalizeLists:function(){this.$editor.find("li").each(function(i,s){var $next=$(s).next();0===$next.length||"UL"!=$next[0].tagName&&"OL"!=$next[0].tagName||$(s).append($next)})},removeSpaces:function(html){return html=html.replace(/\n/g,""),html=html.replace(/[\t]*/g,""),html=html.replace(/\n\s*\n/g,"\n"),html=html.replace(/^[\s\n]*/g," "),html=html.replace(/[\s\n]*$/g," "),html=html.replace(/>\s{2,}</g,"> <"),html=html.replace(/\n\n/g,"\n"),html=html.replace(/[\u200B-\u200D\uFEFF]/g,"")},replaceDivs:function(html){return this.opts.linebreaks?(html=html.replace(/<div><br\s?\/?><\/div>/gi,"<br />"),html=html.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"$2<br />")):html=html.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p$1>$2</p>"),html=html.replace(/<div(.*?[^>])>/gi,""),html=html.replace(/<\/div>/gi,"")},replaceDivsToBr:function(html){return html=html.replace(/<div\s(.*?)>/gi,"<p>"),html=html.replace(/<div><br\s?\/?><\/div>/gi,"<br /><br />"),html=html.replace(/<div>([\w\W]*?)<\/div>/gi,"$1<br /><br />")},replaceParagraphsToBr:function(html){return html=html.replace(/<p\s(.*?)>/gi,"<p>"),html=html.replace(/<p><br\s?\/?><\/p>/gi,"<br />"),html=html.replace(/<p>([\w\W]*?)<\/p>/gi,"$1<br /><br />"),html=html.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>")},saveFormTags:function(html){return html.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi,'<section$1 rel="redactor-form-tag">$2</section>')},restoreFormTags:function(html){return html.replace(/<section(.*?) rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi,"<form$1$2>$3</form>")}}},code:function(){return{set:function(html){html=$.trim(html.toString()),html=this.clean.onSet(html),this.$editor.html(html),this.code.sync(),""!==html&&this.placeholder.remove(),setTimeout($.proxy(this.buffer.add,this),15),this.start===!1&&this.observe.load()},get:function(){var code=this.$textarea.val();return code=this.tabifier.get(code)},sync:function(){setTimeout($.proxy(this.code.startSync,this),10)},startSync:function(){var html=this.$editor.html();this.code.syncCode&&this.code.syncCode==html||(this.code.syncCode=html,html=this.core.setCallback("syncBefore",html),html=this.clean.onSync(html),this.$textarea.val(html),this.core.setCallback("sync",html),this.start===!1&&this.core.setCallback("change",html),this.start=!1,0==this.autosave.html&&(this.autosave.html=this.code.get()),this.autosave.onChange(),this.autosave.enable())},toggle:function(){this.opts.visual?this.code.showCode():this.code.showVisual()},showCode:function(){this.code.offset=this.caret.getOffset();var scroll=$(window).scrollTop(),width=this.$editor.innerWidth(),height=this.$editor.innerHeight();this.$editor.hide();var html=this.$textarea.val();this.modified=this.clean.removeSpaces(html),html=this.tabifier.get(html),this.$textarea.val(html),this.opts.codemirror?this.$textarea.next(".CodeMirror").each(function(i,el){$(el).show(),el.CodeMirror.setValue(html),el.CodeMirror.setSize(width,height),el.CodeMirror.refresh(),el.CodeMirror.focus()}):(this.$textarea.height(height).show().focus(),this.$textarea.on("keydown.redactor-textarea-indenting",this.code.textareaIndenting),$(window).scrollTop(scroll),this.$textarea[0].setSelectionRange&&this.$textarea[0].setSelectionRange(0,0),this.$textarea[0].scrollTop=0),this.opts.visual=!1,this.button.setInactiveInCode(),this.button.setActive("html"),this.core.setCallback("source",html)},showVisual:function(){var html;this.opts.visual||(this.opts.codemirror?this.$textarea.next(".CodeMirror").each(function(i,el){html=el.CodeMirror.getValue()}):html=this.$textarea.hide().val(),this.modified!==this.clean.removeSpaces(html)&&this.code.set(html),this.opts.codemirror&&this.$textarea.next(".CodeMirror").hide(),this.$editor.show(),this.utils.isEmpty(html)||this.placeholder.remove(),this.caret.setOffset(this.code.offset),this.$textarea.off("keydown.redactor-textarea-indenting"),this.button.setActiveInVisual(),this.button.setInactive("html"),this.observe.load(),this.opts.visual=!0,this.core.setCallback("visual",html))},textareaIndenting:function(e){if(9!==e.keyCode)return!0;var $el=this.$textarea,start=$el.get(0).selectionStart;return $el.val($el.val().substring(0,start)+"	"+$el.val().substring($el.get(0).selectionEnd)),$el.get(0).selectionStart=$el.get(0).selectionEnd=start+1,!1}}},core:function(){return{getObject:function(){return $.extend({},this)},getEditor:function(){return this.$editor},getBox:function(){return this.$box},getElement:function(){return this.$element},getTextarea:function(){return this.$textarea},getToolbar:function(){return this.$toolbar?this.$toolbar:!1},addEvent:function(name){this.core.event=name},getEvent:function(){return this.core.event},setCallback:function(type,e,data){var callback=this.opts[type+"Callback"];return $.isFunction(callback)?"undefined"==typeof data?callback.call(this,e):callback.call(this,e,data):"undefined"==typeof data?e:data},destroy:function(){this.core.setCallback("destroy"),this.$element.off(".redactor").removeData("redactor"),this.$editor.off(".redactor"),$(document).off("click.redactor-image-delete."+this.uuid),$(document).off("click.redactor-image-resize-hide."+this.uuid),$(document).off("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid),$("body").off("scroll.redactor."+this.uuid),$(this.opts.toolbarFixedTarget).off("scroll.redactor."+this.uuid),this.$editor.removeClass("redactor-editor redactor-linebreaks redactor-placeholder"),this.$editor.removeAttr("contenteditable");var html=this.code.get();this.$toolbar.find("a").each(function(){var $el=$(this);$el.data("dropdown")&&($el.data("dropdown").remove(),$el.data("dropdown",{}))}),this.build.isTextarea()?(this.$box.after(this.$element),this.$box.remove(),this.$element.val(html).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$element.html(html).show()),this.$pasteBox&&this.$pasteBox.remove(),this.$modalBox&&this.$modalBox.remove(),this.$modalOverlay&&this.$modalOverlay.remove(),$(".redactor-toolbar-tooltip").remove(),clearInterval(this.autosaveInterval)}}},dropdown:function(){return{build:function(name,$dropdown,dropdownObject){"formatting"==name&&this.opts.formattingAdd&&$.each(this.opts.formattingAdd,$.proxy(function(i,s){var func,name=s.tag;"undefined"!=typeof s["class"]&&(name=name+"-"+s["class"]),s.type=this.utils.isBlockTag(s.tag)?"block":"inline",func="undefined"!=typeof s.func?s.func:"inline"==s.type?"inline.formatting":"block.formatting",this.opts.linebreaks&&"block"==s.type&&"p"==s.tag||(this.formatting[name]={tag:s.tag,style:s.style,"class":s["class"],attr:s.attr,data:s.data,clear:s.clear},dropdownObject[name]={func:func,title:s.title})},this)),$.each(dropdownObject,$.proxy(function(btnName,btnObject){var $item=$('<a href="#" class="redactor-dropdown-'+btnName+'">'+btnObject.title+"</a>");"formatting"==name&&$item.addClass("redactor-formatting-"+btnName),$item.on("click",$.proxy(function(e){e.preventDefault();var type="func",callback=btnObject.func;btnObject.command?(type="command",callback=btnObject.command):btnObject.dropdown&&(type="dropdown",callback=btnObject.dropdown),this.button.onClick(e,btnName,type,callback),this.dropdown.hideAll()},this)),$dropdown.append($item)},this))},show:function(e,key){if(!this.opts.visual)return e.preventDefault(),!1;var $button=this.button.get(key),$dropdown=$button.data("dropdown").appendTo(document.body);if(this.utils.isMobile()&&!this.utils.browser("msie")&&document.activeElement.blur(),$button.hasClass("dropact"))this.dropdown.hideAll();else{this.dropdown.hideAll(),this.core.setCallback("dropdownShow",{dropdown:$dropdown,key:key,button:$button}),this.button.setActive(key),$button.addClass("dropact");var keyPosition=$button.offset(),dropdownWidth=$dropdown.width();keyPosition.left+dropdownWidth>$(document).width()&&(keyPosition.left=Math.max(0,keyPosition.left-dropdownWidth));var left=keyPosition.left+"px";if(this.$toolbar.hasClass("toolbar-fixed-box")){var top=this.$toolbar.innerHeight()+this.opts.toolbarFixedTopOffset,position="fixed";this.opts.toolbarFixedTarget!==document&&(top=this.$toolbar.innerHeight()+this.$toolbar.offset().top+this.opts.toolbarFixedTopOffset,position="absolute"),$dropdown.css({position:position,left:left,top:top+"px"}).show()}else{var top=$button.innerHeight()+keyPosition.top+"px";$dropdown.css({position:"absolute",left:left,top:top}).show()}this.core.setCallback("dropdownShown",{dropdown:$dropdown,key:key,button:$button})}$(document).one("click",$.proxy(this.dropdown.hide,this)),this.$editor.one("click",$.proxy(this.dropdown.hide,this));var $body=$(document.body),width=$body.width();$dropdown.on("mouseover",function(){$body.addClass("body-redactor-hidden"),$body.css("margin-right",$body.width()-width+"px")}),$dropdown.on("mouseout",function(){$body.removeClass("body-redactor-hidden").css("margin-right",0)}),e.stopPropagation()},hideAll:function(){this.$toolbar.find("a.dropact").removeClass("redactor-act").removeClass("dropact"),$(document.body).removeClass("body-redactor-hidden").css("margin-right",0),$(".redactor-dropdown-"+this.uuid).hide(),this.core.setCallback("dropdownHide")},hide:function(e){var $dropdown=$(e.target);$dropdown.hasClass("dropact")||($dropdown.removeClass("dropact"),this.dropdown.hideAll())}}},file:function(){return{show:function(){this.modal.load("file",this.lang.get("file"),700),this.upload.init("#redactor-modal-file-upload",this.opts.fileUpload,this.file.insert),this.selection.save(),this.selection.get();var text=this.sel.toString();$("#redactor-filename").val(text),this.modal.show()},insert:function(json,direct,e){if("undefined"!=typeof json.error)return this.modal.close(),this.selection.restore(),void this.core.setCallback("fileUploadError",json);var link;if("string"==typeof json)link=json;else{var text=$("#redactor-filename").val();("undefined"==typeof text||""===text)&&(text=json.filename),link='<a href="'+json.filelink+'" id="filelink-marker">'+text+"</a>"}if(direct){this.selection.removeMarkers();var marker=this.selection.getMarker();this.insert.nodeToCaretPositionFromPoint(e,marker)}else this.modal.close();if(this.selection.restore(),this.buffer.set(),this.insert.htmlWithoutClean(link),"string"!=typeof json){var linkmarker=$(this.$editor.find("a#filelink-marker"));0!==linkmarker.length?linkmarker.removeAttr("id").removeAttr("style"):linkmarker=!1,this.core.setCallback("fileUpload",linkmarker,json)}}}},focus:function(){return{setStart:function(){this.$editor.focus();var first=this.$editor.children().first();if(0!==first.length&&0!==first[0].length&&"BR"!=first[0].tagName&&3!=first[0].nodeType){if("UL"==first[0].tagName||"OL"==first[0].tagName){var child=first.find("li").first();if(!this.utils.isBlock(child)&&""===child.text())return void this.caret.setStart(child)}return this.opts.linebreaks&&!this.utils.isBlockTag(first[0].tagName)?(this.selection.get(),this.range.setStart(this.$editor[0],0),this.range.setEnd(this.$editor[0],0),void this.selection.addRange()):void this.caret.setStart(first)}},setEnd:function(){if(this.utils.browser("mozilla")||this.utils.browser("msie")){var last=this.$editor.children().last();this.$editor.focus(),this.caret.setEnd(last)}else{this.selection.get();try{this.range.selectNodeContents(this.$editor[0]),this.range.collapse(!1),this.selection.addRange()}catch(e){}}},isFocused:function(){var focusNode=document.getSelection().focusNode;return null===focusNode?!1:this.opts.linebreaks&&$(focusNode.parentNode).hasClass("redactor-linebreaks")?!0:this.utils.isRedactorParent(focusNode.parentNode)?this.$editor.is(":focus"):!1}}},image:function(){return{show:function(){this.modal.load("image",this.lang.get("image"),700),this.upload.init("#redactor-modal-image-droparea",this.opts.imageUpload,this.image.insert),this.selection.save(),this.modal.show()},showEdit:function($image){var $link=$image.closest("a",this.$editor[0]);if(this.modal.load("imageEdit",this.lang.get("edit"),705),this.modal.createCancelButton(),this.image.buttonDelete=this.modal.createDeleteButton(this.lang.get("_delete")),this.image.buttonSave=this.modal.createActionButton(this.lang.get("save")),this.image.buttonDelete.on("click",$.proxy(function(){this.image.remove($image)},this)),this.image.buttonSave.on("click",$.proxy(function(){this.image.update($image)},this)),$("#redactor-image-title").val($image.attr("alt")),this.opts.imageLink){var $redactorImageLink=$("#redactor-image-link");$redactorImageLink.attr("href",$image.attr("src")),0!==$link.length&&($redactorImageLink.val($link.attr("href")),"_blank"==$link.attr("target")&&$("#redactor-image-link-blank").prop("checked",!0))}else $(".redactor-image-link-option").hide();if(this.opts.imagePosition){var floatValue="block"==$image.css("display")&&"none"==$image.css("float")?"center":$image.css("float");$("#redactor-image-align").val(floatValue)}else $(".redactor-image-position-option").hide();this.modal.show()},setFloating:function($image){var floating=$("#redactor-image-align").val(),imageFloat="",imageDisplay="",imageMargin="";switch(floating){case"left":imageFloat="left",imageMargin="0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin+" 0";break;case"right":imageFloat="right",imageMargin="0 0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin;break;case"center":imageDisplay="block",imageMargin="auto"}$image.css({"float":imageFloat,display:imageDisplay,margin:imageMargin}),$image.attr("rel",$image.attr("style"))},update:function($image){this.image.hideResize(),this.buffer.set();var $link=$image.closest("a",this.$editor[0]);$image.attr("alt",$("#redactor-image-title").val()),this.image.setFloating($image);var link=$.trim($("#redactor-image-link").val());if(""!==link){var pattern="((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}",re=new RegExp("^(http|ftp|https)://"+pattern,"i"),re2=new RegExp("^"+pattern,"i");-1==link.search(re)&&0===link.search(re2)&&this.opts.linkProtocol&&(link=this.opts.linkProtocol+"://"+link);var target=$("#redactor-image-link-blank").prop("checked")?!0:!1;if(0===$link.length){var a=$('<a href="'+link+'">'+this.utils.getOuterHtml($image)+"</a>");target&&a.attr("target","_blank"),$image.replaceWith(a)}else $link.attr("href",link),target?$link.attr("target","_blank"):$link.removeAttr("target")}else 0!==$link.length&&$link.replaceWith(this.utils.getOuterHtml($image));this.modal.close(),this.observe.images(),this.code.sync()},setEditable:function($image){this.opts.imageEditable&&$image.on("dragstart",$.proxy(this.image.onDrag,this)),$image.on("mousedown",$.proxy(this.image.hideResize,this)),$image.on("click.redactor touchstart",$.proxy(function(e){return this.observe.image=$image,0!==this.$editor.find("#redactor-image-box").length?!1:(this.image.resizer=this.image.loadEditableControls($image),$(document).on("click.redactor-image-resize-hide."+this.uuid,$.proxy(this.image.hideResize,this)),this.$editor.on("click.redactor-image-resize-hide."+this.uuid,$.proxy(this.image.hideResize,this)),void(this.opts.imageResizable&&this.image.resizer.on("mousedown.redactor touchstart.redactor",$.proxy(function(e){this.image.setResizable(e,$image)},this))))},this))},setResizable:function(e,$image){e.preventDefault(),this.image.resizeHandle={x:e.pageX,y:e.pageY,el:$image,ratio:$image.width()/$image.height(),h:$image.height()},e=e.originalEvent||e,e.targetTouches&&(this.image.resizeHandle.x=e.targetTouches[0].pageX,this.image.resizeHandle.y=e.targetTouches[0].pageY),this.image.startResize()},startResize:function(){$(document).on("mousemove.redactor-image-resize touchmove.redactor-image-resize",$.proxy(this.image.moveResize,this)),$(document).on("mouseup.redactor-image-resize touchend.redactor-image-resize",$.proxy(this.image.stopResize,this))},moveResize:function(e){e.preventDefault(),e=e.originalEvent||e;var height=this.image.resizeHandle.h;height+=e.targetTouches?e.targetTouches[0].pageY-this.image.resizeHandle.y:e.pageY-this.image.resizeHandle.y;var width=Math.round(height*this.image.resizeHandle.ratio);50>height||100>width||(this.image.resizeHandle.el.width(width),this.image.resizeHandle.el.height(this.image.resizeHandle.el.width()/this.image.resizeHandle.ratio),this.code.sync())},stopResize:function(){this.handle=!1,$(document).off(".redactor-image-resize"),this.image.hideResize()},onDrag:function(e){return 0!==this.$editor.find("#redactor-image-box").length?(e.preventDefault(),!1):void this.$editor.on("drop.redactor-image-inside-drop",$.proxy(function(){setTimeout($.proxy(this.image.onDrop,this),1);
},this))},onDrop:function(){this.image.fixImageSourceAfterDrop(),this.observe.images(),this.$editor.off("drop.redactor-image-inside-drop"),this.clean.clearUnverified(),this.code.sync()},fixImageSourceAfterDrop:function(){this.$editor.find("img[data-save-url]").each(function(){var $el=$(this);$el.attr("src",$el.attr("data-save-url")),$el.removeAttr("data-save-url")})},hideResize:function(e){if(!e||0===$(e.target).closest("#redactor-image-box",this.$editor[0]).length){if(e&&"IMG"==e.target.tagName){var $image=$(e.target);$image.attr("data-save-url",$image.attr("src"))}var imageBox=this.$editor.find("#redactor-image-box");0!==imageBox.length&&(this.opts.imageEditable&&this.image.editter.remove(),$(this.image.resizer).remove(),imageBox.find("img").css({marginTop:imageBox[0].style.marginTop,marginBottom:imageBox[0].style.marginBottom,marginLeft:imageBox[0].style.marginLeft,marginRight:imageBox[0].style.marginRight}),imageBox.css("margin",""),imageBox.find("img").css("opacity",""),imageBox.replaceWith(function(){return $(this).contents()}),$(document).off("click.redactor-image-resize-hide."+this.uuid),this.$editor.off("click.redactor-image-resize-hide."+this.uuid),"undefined"!=typeof this.image.resizeHandle&&this.image.resizeHandle.el.attr("rel",this.image.resizeHandle.el.attr("style")),this.code.sync())}},loadResizableControls:function($image,imageBox){if(this.opts.imageResizable&&!this.utils.isMobile()){var imageResizer=$('<span id="redactor-image-resizer" data-redactor="verified"></span>');return this.utils.isDesktop()||imageResizer.css({width:"15px",height:"15px"}),imageResizer.attr("contenteditable",!1),imageBox.append(imageResizer),imageBox.append($image),imageResizer}return imageBox.append($image),!1},loadEditableControls:function($image){var imageBox=$('<span id="redactor-image-box" data-redactor="verified">');if(imageBox.css("float",$image.css("float")).attr("contenteditable",!1),"auto"!=$image[0].style.margin?(imageBox.css({marginTop:$image[0].style.marginTop,marginBottom:$image[0].style.marginBottom,marginLeft:$image[0].style.marginLeft,marginRight:$image[0].style.marginRight}),$image.css("margin","")):imageBox.css({display:"block",margin:"auto"}),$image.css("opacity",".5").after(imageBox),this.opts.imageEditable){this.image.editter=$('<span id="redactor-image-editter" data-redactor="verified">'+this.lang.get("edit")+"</span>"),this.image.editter.attr("contenteditable",!1),this.image.editter.on("click",$.proxy(function(){this.image.showEdit($image)},this)),imageBox.append(this.image.editter);var editerWidth=this.image.editter.innerWidth();this.image.editter.css("margin-left","-"+editerWidth/2+"px")}return this.image.loadResizableControls($image,imageBox)},remove:function(image){var $image=$(image),$link=$image.closest("a",this.$editor[0]),$figure=$image.closest("figure",this.$editor[0]),$parent=$image.parent();0!==$("#redactor-image-box").length&&($parent=$("#redactor-image-box").parent());var $next;0!==$figure.length?($next=$figure.next(),$figure.remove()):0!==$link.length?($parent=$link.parent(),$link.remove()):$image.remove(),$("#redactor-image-box").remove(),this.caret.setStart(0!==$figure.length?$next:$parent),this.core.setCallback("imageDelete",$image[0].src,$image),this.modal.close(),this.code.sync()},insert:function(json,direct,e){if("undefined"!=typeof json.error)return this.modal.close(),this.selection.restore(),void this.core.setCallback("imageUploadError",json);var $img;"string"==typeof json?$img=$(json).attr("data-redactor-inserted-image","true"):($img=$("<img>"),$img.attr("src",json.filelink).attr("data-redactor-inserted-image","true"));var node=$img,isP=this.utils.isCurrentOrParent("P");if(isP&&(node=$("<blockquote />").append($img)),direct){this.selection.removeMarkers();var marker=this.selection.getMarker();this.insert.nodeToCaretPositionFromPoint(e,marker)}else this.modal.close();this.selection.restore(),this.buffer.set(),this.insert.html(this.utils.getOuterHtml(node),!1);var $image=this.$editor.find("img[data-redactor-inserted-image=true]").removeAttr("data-redactor-inserted-image");isP?$image.parent().contents().unwrap().wrap("<p />"):this.opts.linebreaks&&$image.before("<br>").after("<br>"),"string"!=typeof json&&this.core.setCallback("imageUpload",$image,json)}}},indent:function(){return{increase:function(){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var block=this.selection.getBlock();block&&"LI"==block.tagName?this.indent.increaseLists():block===!1&&this.opts.linebreaks?this.indent.increaseText():this.indent.increaseBlocks(),this.selection.restore(),this.code.sync()},increaseLists:function(){document.execCommand("indent"),this.indent.fixEmptyIndent(),this.clean.normalizeLists(),this.clean.clearUnverified()},increaseBlocks:function(){$.each(this.selection.getBlocks(),$.proxy(function(i,elem){if("TD"!==elem.tagName&&"TH"!==elem.tagName){var $el=this.utils.getAlignmentElement(elem),left=this.utils.normalize($el.css("margin-left"))+this.opts.indentValue;$el.css("margin-left",left+"px")}},this))},increaseText:function(){var wrapper=this.selection.wrap("div");$(wrapper).attr("data-tagblock","redactor"),$(wrapper).css("margin-left",this.opts.indentValue+"px")},decrease:function(){this.buffer.set(),this.selection.save();var block=this.selection.getBlock();block&&"LI"==block.tagName?this.indent.decreaseLists():this.indent.decreaseBlocks(),this.selection.restore(),this.code.sync()},decreaseLists:function(){document.execCommand("outdent");var current=this.selection.getCurrent(),$item=$(current).closest("li",this.$editor[0]),$parent=$item.parent();0!==$item.length&&0!==$parent.length&&"LI"==$parent[0].tagName&&$parent.after($item),this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==$item.length||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote, p").each($.proxy(this.utils.removeEmpty,this))),this.clean.clearUnverified()},decreaseBlocks:function(){$.each(this.selection.getBlocks(),$.proxy(function(i,elem){var $el=this.utils.getAlignmentElement(elem),left=this.utils.normalize($el.css("margin-left"))-this.opts.indentValue;0>=left?this.opts.linebreaks&&"undefined"!=typeof $el.data("tagblock")?$el.replaceWith($el.html()+"<br />"):($el.css("margin-left",""),this.utils.removeEmptyAttr($el,"style")):$el.css("margin-left",left+"px")},this))},fixEmptyIndent:function(){var block=this.selection.getBlock();if(this.range.collapsed&&block&&"LI"==block.tagName&&this.utils.isEmpty($(block).text())){var $block=$(block);$block.find("span").not(".redactor-selection-marker").contents().unwrap(),$block.append("<br>")}}}},inline:function(){return{formatting:function(name){var type,value;"undefined"!=typeof this.formatting[name].style?type="style":"undefined"!=typeof this.formatting[name]["class"]&&(type="class"),type&&(value=this.formatting[name][type]),this.inline.format(this.formatting[name].tag,type,value)},format:function(tag,type,value){if(!this.utils.isCurrentOrParent("PRE")&&!this.utils.isCurrentOrParentHeader()){for(var tags=["b","bold","i","italic","underline","strikethrough","deleted","superscript","subscript"],replaced=["strong","strong","em","em","u","del","del","sup","sub"],i=0;i<tags.length;i++)tag==tags[i]&&(tag=replaced[i]);this.inline.type=type||!1,this.inline.value=value||!1,this.buffer.set(),this.utils.browser("msie")||this.$editor.focus(),this.selection.get(),this.range.collapsed?this.inline.formatCollapsed(tag):this.inline.formatMultiple(tag)}},formatCollapsed:function(tag){var current=this.selection.getCurrent(),$parent=$(current).closest(tag+"[data-redactor-tag="+tag+"]",this.$editor[0]);if(0!==$parent.length&&"style"!=this.inline.type&&"SPAN"!=$parent[0].tagName)return void(this.utils.isEmpty($parent.text())?(this.caret.setAfter($parent[0]),$parent.remove(),this.code.sync()):this.utils.isEndOfElement($parent)&&this.caret.setAfter($parent[0]));var node=$("<"+tag+">").attr("data-verified","redactor").attr("data-redactor-tag",tag);node.html(this.opts.invisibleSpace),node=this.inline.setFormat(node);var node=this.insert.node(node);this.caret.setEnd(node),this.code.sync()},formatMultiple:function(tag){if(this.inline.formatConvert(tag),this.selection.save(),document.execCommand("strikethrough"),this.$editor.find("strike").each($.proxy(function(i,s){var $el=$(s);this.inline.formatRemoveSameChildren($el,tag);var $span;if(this.inline.type?($span=$("<span>").attr("data-redactor-tag",tag).attr("data-verified","redactor"),$span=this.inline.setFormat($span)):$span=$("<"+tag+">").attr("data-redactor-tag",tag).attr("data-verified","redactor"),$el.replaceWith($span.html($el.contents())),"span"==tag){var $parent=$span.parent();if($parent&&"SPAN"==$parent[0].tagName&&"style"==this.inline.type)for(var arr=this.inline.value.split(";"),z=0;z<arr.length;z++){if(""===arr[z])return;var style=arr[z].split(":");$parent.css(style[0],""),this.utils.removeEmptyAttr($parent,"style")&&$parent.replaceWith($parent.contents())}}},this)),"span"!=tag&&this.$editor.find(this.opts.inlineTags.join(", ")).each($.proxy(function(i,s){var $el=$(s),property=$el.css("text-decoration");"line-through"==property&&($el.css("text-decoration",""),this.utils.removeEmptyAttr($el,"style"))},this)),"del"!=tag){var _this=this;this.$editor.find("inline").each(function(i,s){_this.utils.replaceToTag(s,"del")})}this.selection.restore(),this.code.sync()},formatRemoveSameChildren:function($el,tag){var self=this;$el.children(tag).each(function(){var $child=$(this);if(!$child.hasClass("redactor-selection-marker"))if("style"==self.inline.type)for(var arr=self.inline.value.split(";"),z=0;z<arr.length;z++){if(""===arr[z])return;var style=arr[z].split(":");$child.css(style[0],""),self.utils.removeEmptyAttr($child,"style")&&$child.replaceWith($child.contents())}else $child.contents().unwrap()})},formatConvert:function(tag){this.selection.save();var find="";"class"==this.inline.type?find="[data-redactor-class="+this.inline.value+"]":"style"==this.inline.type&&(find='[data-redactor-style="'+this.inline.value+'"]');var self=this;"del"!=tag&&this.$editor.find("del").each(function(i,s){self.utils.replaceToTag(s,"inline")}),"span"!=tag&&this.$editor.find(tag).each(function(){var $el=$(this);$el.replaceWith($("<strike />").html($el.contents()))}),this.$editor.find('[data-redactor-tag="'+tag+'"]'+find).each(function(){if(""!==find||"span"!=tag||this.tagName.toLowerCase()!=tag){var $el=$(this);$el.replaceWith($("<strike />").html($el.contents()))}}),this.selection.restore()},setFormat:function(node){switch(this.inline.type){case"class":node.hasClass(this.inline.value)?(node.removeClass(this.inline.value),node.removeAttr("data-redactor-class")):(node.addClass(this.inline.value),node.attr("data-redactor-class",this.inline.value));break;case"style":node[0].style.cssText=this.inline.value,node.attr("data-redactor-style",this.inline.value)}return node},removeStyle:function(){this.buffer.set();var current=this.selection.getCurrent(),nodes=this.selection.getInlines();if(this.selection.save(),current&&"SPAN"===current.tagName){var $s=$(current);$s.removeAttr("style"),0===$s[0].attributes.length&&$s.replaceWith($s.contents())}$.each(nodes,$.proxy(function(i,s){var $s=$(s);-1==$.inArray(s.tagName.toLowerCase(),this.opts.inlineTags)||$s.hasClass("redactor-selection-marker")||($s.removeAttr("style"),0===$s[0].attributes.length&&$s.replaceWith($s.contents()))},this)),this.selection.restore(),this.code.sync()},removeStyleRule:function(name){this.buffer.set();var parent=this.selection.getParent(),nodes=this.selection.getInlines();if(this.selection.save(),parent&&"SPAN"===parent.tagName){var $s=$(parent);$s.css(name,""),this.utils.removeEmptyAttr($s,"style"),0===$s[0].attributes.length&&$s.replaceWith($s.contents())}$.each(nodes,$.proxy(function(i,s){var $s=$(s);-1==$.inArray(s.tagName.toLowerCase(),this.opts.inlineTags)||$s.hasClass("redactor-selection-marker")||($s.css(name,""),this.utils.removeEmptyAttr($s,"style"),0===$s[0].attributes.length&&$s.replaceWith($s.contents()))},this)),this.selection.restore(),this.code.sync()},removeFormat:function(){this.buffer.set();var current=this.selection.getCurrent();this.selection.save(),document.execCommand("removeFormat"),current&&"SPAN"===current.tagName&&$(current).replaceWith($(current).contents()),$.each(this.selection.getNodes(),$.proxy(function(i,s){var $s=$(s);-1==$.inArray(s.tagName.toLowerCase(),this.opts.inlineTags)||$s.hasClass("redactor-selection-marker")||$s.replaceWith($s.contents())},this)),this.selection.restore(),this.code.sync()},toggleClass:function(className){this.inline.format("span","class",className)},toggleStyle:function(value){this.inline.format("span","style",value)}}},insert:function(){return{set:function(html,clean){this.placeholder.remove(),html=this.clean.setVerified(html),"undefined"==typeof clean&&(html=this.clean.onPaste(html,!1)),this.$editor.html(html),this.selection.remove(),this.focus.setEnd(),this.clean.normalizeLists(),this.code.sync(),this.observe.load(),"undefined"==typeof clean&&setTimeout($.proxy(this.clean.clearUnverified,this),10)},text:function(text){if(this.placeholder.remove(),text=text.toString(),text=$.trim(text),text=this.clean.getPlainText(text,!1),this.$editor.focus(),this.utils.browser("msie"))this.insert.htmlIe(text);else{this.selection.get(),this.range.deleteContents();var el=document.createElement("div");el.innerHTML=text;for(var node,lastNode,frag=document.createDocumentFragment();node=el.firstChild;)lastNode=frag.appendChild(node);if(this.range.insertNode(frag),lastNode){var range=this.range.cloneRange();range.setStartAfter(lastNode),range.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(range)}}this.code.sync(),this.clean.clearUnverified()},htmlWithoutClean:function(html){this.insert.html(html,!1)},html:function(html,clean){this.placeholder.remove(),"undefined"==typeof clean&&(clean=!0),this.$editor.focus(),html=this.clean.setVerified(html),clean&&(html=this.clean.onPaste(html)),this.utils.browser("msie")?this.insert.htmlIe(html):(this.clean.singleLine?this.insert.execHtml(html):document.execCommand("insertHTML",!1,html),this.insert.htmlFixMozilla()),this.clean.normalizeLists(),this.opts.linebreaks||this.$editor.find("p").each($.proxy(this.utils.removeEmpty,this)),this.code.sync(),this.observe.load(),clean&&this.clean.clearUnverified()},htmlFixMozilla:function(){if(this.utils.browser("mozilla")){var $next=$(this.selection.getBlock()).next();$next.length>0&&"P"==$next[0].tagName&&""===$next.html()&&$next.remove()}},htmlIe:function(html){if(this.utils.isIe11()){var parent=this.utils.isCurrentOrParent("P"),$html=$("<div>").append(html),blocksMatch=$html.contents().is("p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article");return void(parent&&blocksMatch?this.insert.ie11FixInserting(parent,html):this.insert.ie11PasteFrag(html))}document.selection.createRange().pasteHTML(html)},execHtml:function(html){html=this.clean.setVerified(html),this.selection.get(),this.range.deleteContents();var el=document.createElement("div");el.innerHTML=html;for(var node,lastNode,frag=document.createDocumentFragment();node=el.firstChild;)lastNode=frag.appendChild(node);this.range.insertNode(frag),this.range.collapse(!0),this.caret.setAfter(lastNode)},node:function(node,deleteContents){node=node[0]||node;var html=this.utils.getOuterHtml(node);return html=this.clean.setVerified(html),null!==html.match(/</g)&&(node=$(html)[0]),this.selection.get(),deleteContents!==!1&&this.range.deleteContents(),this.range.insertNode(node),this.range.collapse(!1),this.selection.addRange(),node},nodeToPoint:function(node,x,y){node=node[0]||node,this.selection.get();var range;if(document.caretPositionFromPoint){var pos=document.caretPositionFromPoint(x,y);this.range.setStart(pos.offsetNode,pos.offset),this.range.collapse(!0),this.range.insertNode(node)}else if(document.caretRangeFromPoint)range=document.caretRangeFromPoint(x,y),range.insertNode(node);else if("undefined"!=typeof document.body.createTextRange){range=document.body.createTextRange(),range.moveToPoint(x,y);var endRange=range.duplicate();endRange.moveToPoint(x,y),range.setEndPoint("EndToEnd",endRange),range.select()}},nodeToCaretPositionFromPoint:function(e,node){node=node[0]||node;var range,x=e.clientX,y=e.clientY;if(document.caretPositionFromPoint){var pos=document.caretPositionFromPoint(x,y),sel=document.getSelection();range=sel.getRangeAt(0),range.setStart(pos.offsetNode,pos.offset),range.collapse(!0),range.insertNode(node)}else if(document.caretRangeFromPoint)range=document.caretRangeFromPoint(x,y),range.insertNode(node);else if("undefined"!=typeof document.body.createTextRange){range=document.body.createTextRange(),range.moveToPoint(x,y);var endRange=range.duplicate();endRange.moveToPoint(x,y),range.setEndPoint("EndToEnd",endRange),range.select()}},ie11FixInserting:function(parent,html){var node=document.createElement("span");node.className="redactor-ie-paste",this.insert.node(node);var parHtml=$(parent).html();parHtml="<p>"+parHtml.replace(/<span class="redactor-ie-paste"><\/span>/gi,"</p>"+html+"<p>")+"</p>",$(parent).replaceWith(parHtml)},ie11PasteFrag:function(html){this.selection.get(),this.range.deleteContents();var el=document.createElement("div");el.innerHTML=html;for(var node,lastNode,frag=document.createDocumentFragment();node=el.firstChild;)lastNode=frag.appendChild(node);this.range.insertNode(frag),this.range.collapse(!1),this.selection.addRange()}}},keydown:function(){return{init:function(e){if(!this.rtePaste){var key=e.which,arrow=key>=37&&40>=key;this.keydown.ctrl=e.ctrlKey||e.metaKey,this.keydown.current=this.selection.getCurrent(),this.keydown.parent=this.selection.getParent(),this.keydown.block=this.selection.getBlock(),this.keydown.pre=this.utils.isTag(this.keydown.current,"pre"),this.keydown.blockquote=this.utils.isTag(this.keydown.current,"blockquote"),this.keydown.figcaption=this.utils.isTag(this.keydown.current,"figcaption"),this.shortcuts.init(e,key),this.keydown.checkEvents(arrow,key),this.keydown.setupBuffer(e,key),this.keydown.addArrowsEvent(arrow),this.keydown.setupSelectAll(e,key);var keydownStop=this.core.setCallback("keydown",e);if(keydownStop===!1)return e.preventDefault(),!1;if(this.opts.enterKey&&(this.utils.browser("msie")||this.utils.browser("mozilla"))&&(key===this.keyCode.DOWN||key===this.keyCode.RIGHT)){var isEndOfTable=!1,$table=!1;if(this.keydown.block&&"TD"===this.keydown.block.tagName&&($table=$(this.keydown.block).closest("table",this.$editor[0])),$table&&$table.find("td").last()[0]===this.keydown.block&&(isEndOfTable=!0),this.utils.isEndOfElement()&&isEndOfTable){var node=$(this.opts.emptyHtml);$table.after(node),this.caret.setStart(node)}}if(this.opts.enterKey&&key===this.keyCode.DOWN&&this.keydown.onArrowDown(),!this.opts.enterKey&&key===this.keyCode.ENTER)return e.preventDefault(),void(this.range.collapsed||this.range.deleteContents());if(key==this.keyCode.ENTER&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey){var stop=this.core.setCallback("enter",e);if(stop===!1)return e.preventDefault(),!1;if(this.keydown.blockquote&&this.keydown.exitFromBlockquote(e)===!0)return!1;var current,$next;if(this.keydown.pre)return this.keydown.insertNewLine(e);if(this.keydown.blockquote||this.keydown.figcaption)return current=this.selection.getCurrent(),$next=$(current).next(),0!==$next.length&&"BR"==$next[0].tagName?this.keydown.insertBreakLine(e):this.utils.isEndOfElement()&&current&&"SPAN"!=current?this.keydown.insertDblBreakLine(e):this.keydown.insertBreakLine(e);if(this.opts.linebreaks&&!this.keydown.block)return current=this.selection.getCurrent(),$next=$(this.keydown.current).next(),0!==$next.length&&"BR"==$next[0].tagName?this.keydown.insertBreakLine(e):current!==!1&&$(current).hasClass("redactor-invisible-space")?(this.caret.setAfter(current),$(current).contents().unwrap(),this.keydown.insertDblBreakLine(e)):this.utils.isEndOfEditor()?this.keydown.insertDblBreakLine(e):this.keydown.insertBreakLine(0===$next.length&&current===!1&&"undefined"!=typeof $next.context?e:e);if(this.opts.linebreaks&&this.keydown.block)setTimeout($.proxy(this.keydown.replaceDivToBreakLine,this),1);else if(!this.opts.linebreaks&&this.keydown.block)if("LI"!==this.keydown.block.tagName)setTimeout($.proxy(this.keydown.replaceDivToParagraph,this),1);else{current=this.selection.getCurrent();var $parent=$(current).closest("li",this.$editor[0]),$list=$parent.closest("ul,ol",this.$editor[0]);if(0!==$parent.length&&this.utils.isEmpty($parent.html())&&0===$list.next().length&&this.utils.isEmpty($list.find("li").last().html())){$list.find("li").last().remove();var node=$(this.opts.emptyHtml);return $list.after(node),this.caret.setStart(node),!1}}else if(!this.opts.linebreaks&&!this.keydown.block)return this.keydown.insertParagraph(e)}if(key===this.keyCode.ENTER&&(e.ctrlKey||e.shiftKey))return this.keydown.onShiftEnter(e);if(key===this.keyCode.TAB||e.metaKey&&221===key||e.metaKey&&219===key)return this.keydown.onTab(e,key);if(key===this.keyCode.BACKSPACE||key===this.keyCode.DELETE){if(this.utils.browser("mozilla")&&this.keydown.current&&"TD"===this.keydown.current.tagName)return e.preventDefault(),!1;var nodes=this.selection.getNodes();if(nodes)for(var last,len=nodes.length,i=0;len>i;i++){var children=$(nodes[i]).children("img");if(0!==children.length){var self=this;$.each(children,function(z,s){var $s=$(s);"none"==$s.css("float")&&(self.core.setCallback("imageDelete",s.src,$s),last=s)})}else"IMG"==nodes[i].tagName&&last!=nodes[i]&&(this.core.setCallback("imageDelete",nodes[i].src,$(nodes[i])),last=nodes[i])}}key===this.keyCode.BACKSPACE&&(this.keydown.removeInvisibleSpace(),this.keydown.removeEmptyListInTable(e)),this.code.sync()}},checkEvents:function(arrow,key){arrow||"click"!=this.core.getEvent()&&"arrow"!=this.core.getEvent()||(this.core.addEvent(!1),this.keydown.checkKeyEvents(key)&&this.buffer.set())},checkKeyEvents:function(key){var k=this.keyCode,keys=[k.BACKSPACE,k.DELETE,k.ENTER,k.SPACE,k.ESC,k.TAB,k.CTRL,k.META,k.ALT,k.SHIFT];return-1==$.inArray(key,keys)?!0:!1},addArrowsEvent:function(arrow){return arrow?"click"==this.core.getEvent()||"arrow"==this.core.getEvent()?void this.core.addEvent(!1):void this.core.addEvent("arrow"):void 0},setupBuffer:function(e,key){return this.keydown.ctrl&&90===key&&!e.shiftKey&&!e.altKey&&this.opts.buffer.length?(e.preventDefault(),void this.buffer.undo()):this.keydown.ctrl&&90===key&&e.shiftKey&&!e.altKey&&0!==this.opts.rebuffer.length?(e.preventDefault(),void this.buffer.redo()):void(this.keydown.ctrl||(key==this.keyCode.BACKSPACE||key==this.keyCode.DELETE||key==this.keyCode.ENTER&&!e.ctrlKey&&!e.shiftKey||key==this.keyCode.SPACE)&&this.buffer.set())},setupSelectAll:function(e,key){this.keydown.ctrl&&65===key?this.utils.enableSelectAll():key==this.keyCode.LEFT_WIN||this.keydown.ctrl||this.utils.disableSelectAll()},onArrowDown:function(){for(var tags=[this.keydown.blockquote,this.keydown.pre,this.keydown.figcaption],i=0;i<tags.length;i++)if(tags[i])return this.keydown.insertAfterLastElement(tags[i]),!1},onShiftEnter:function(e){return this.buffer.set(),this.utils.isEndOfElement()?this.keydown.insertDblBreakLine(e):this.keydown.insertBreakLine(e)},onTab:function(e,key){if(!this.opts.tabKey)return!0;if(this.utils.isEmpty(this.code.get())&&this.opts.tabAsSpaces===!1)return!0;e.preventDefault();var node;return this.keydown.pre&&!e.shiftKey?(node=document.createTextNode(this.opts.preSpaces?Array(this.opts.preSpaces+1).join(""):"	"),this.insert.node(node),this.code.sync()):this.opts.tabAsSpaces!==!1?(node=document.createTextNode(Array(this.opts.tabAsSpaces+1).join("")),this.insert.node(node),this.code.sync()):e.metaKey&&219===key?this.indent.decrease():e.metaKey&&221===key?this.indent.increase():e.shiftKey?this.indent.decrease():this.indent.increase(),!1},replaceDivToBreakLine:function(){var blockElem=this.selection.getBlock(),blockHtml=blockElem.innerHTML.replace(/<br\s?\/?>/gi,"");if(("DIV"===blockElem.tagName||"P"===blockElem.tagName)&&""===blockHtml&&!$(blockElem).hasClass("redactor-editor")){var br=document.createElement("br");return $(blockElem).replaceWith(br),this.caret.setBefore(br),this.code.sync(),!1}},replaceDivToParagraph:function(){var blockElem=this.selection.getBlock(),blockHtml=blockElem.innerHTML.replace(/<br\s?\/?>/gi,"");if("DIV"===blockElem.tagName&&""===blockHtml&&!$(blockElem).hasClass("redactor-editor")){var p=document.createElement("p");return p.innerHTML=this.opts.invisibleSpace,$(blockElem).replaceWith(p),this.caret.setStart(p),this.code.sync(),!1}this.opts.cleanStyleOnEnter&&"P"==blockElem.tagName&&$(blockElem).removeAttr("class").removeAttr("style")},insertParagraph:function(e){e.preventDefault(),this.selection.get();var p=document.createElement("p");return p.innerHTML=this.opts.invisibleSpace,this.range.deleteContents(),this.range.insertNode(p),this.caret.setStart(p),this.code.sync(),!1},exitFromBlockquote:function(e){if(this.utils.isEndOfElement()){var tmp=$.trim($(this.keydown.block).html());if(-1!=tmp.search(/(<br\s?\/?>){2}$/i)){if(e.preventDefault(),this.opts.linebreaks){var br=document.createElement("br");$(this.keydown.blockquote).after(br),this.caret.setBefore(br),$(this.keydown.block).html(tmp.replace(/<br\s?\/?>$/i,""))}else{var node=$(this.opts.emptyHtml);$(this.keydown.blockquote).after(node),this.caret.setStart(node)}return!0}}},insertAfterLastElement:function(element){if(this.utils.isEndOfElement())if(this.buffer.set(),this.opts.linebreaks){var contents=$("<div>").append($.trim(this.$editor.html())).contents(),last=contents.last()[0];if("SPAN"==last.tagName&&""===last.innerHTML&&(last=contents.prev()[0]),this.utils.getOuterHtml(last)!=this.utils.getOuterHtml(element))return;var br=document.createElement("br");$(element).after(br),this.caret.setAfter(br)}else{if(this.$editor.contents().last()[0]!==element)return;var node=$(this.opts.emptyHtml);$(element).after(node),this.caret.setStart(node)}},insertNewLine:function(e){e.preventDefault();var node=document.createTextNode("\n");return this.selection.get(),this.range.deleteContents(),this.range.insertNode(node),this.caret.setAfter(node),this.code.sync(),!1},insertBreakLine:function(e){return this.keydown.insertBreakLineProcessing(e)},insertDblBreakLine:function(e){return this.keydown.insertBreakLineProcessing(e,!0)},insertBreakLineProcessing:function(e,dbl){e.stopPropagation(),this.selection.get();var br1=document.createElement("br");if(this.utils.browser("msie")?(this.range.collapse(!1),this.range.setEnd(this.range.endContainer,this.range.endOffset)):this.range.deleteContents(),this.range.insertNode(br1),dbl===!0){var $next=$(br1).next();if(0!==$next.length&&"BR"===$next[0].tagName&&this.utils.isEndOfEditor())return this.caret.setAfter(br1),this.code.sync(),!1;var br2=document.createElement("br");this.range.insertNode(br2),this.caret.setAfter(br2)}else this.keydown.insertBreakLineProcessingAfter(br1);return this.code.sync(),!1},insertBreakLineProcessingAfter:function(node){var space=this.utils.createSpaceElement();$(node).after(space),this.selection.selectElement(space),$(space).replaceWith(function(){return $(this).contents()})},removeInvisibleSpace:function(){var $current=$(this.keydown.current);0===$current.text().search(/^\u200B$/g)&&$current.remove()},removeEmptyListInTable:function(e){var $current=$(this.keydown.current),$parent=$(this.keydown.parent),td=$current.closest("td",this.$editor[0]);if(0!==td.length&&$current.closest("li",this.$editor[0])&&1===$parent.children("li").length){if(!this.utils.isEmpty($current.text()))return;e.preventDefault(),$current.remove(),$parent.remove(),this.caret.setStart(td)}}}},keyup:function(){return{init:function(e){if(!this.rtePaste){var key=e.which;this.keyup.current=this.selection.getCurrent(),this.keyup.parent=this.selection.getParent();var $parent=this.utils.isRedactorParent($(this.keyup.parent).parent()),keyupStop=this.core.setCallback("keyup",e);return keyupStop===!1?(e.preventDefault(),!1):(!this.opts.linebreaks&&3==this.keyup.current.nodeType&&this.keyup.current.length<=1&&(this.keyup.parent===!1||"BODY"==this.keyup.parent.tagName)&&this.keyup.replaceToParagraph(),!this.opts.linebreaks&&this.utils.isRedactorParent(this.keyup.current)&&"DIV"===this.keyup.current.tagName&&this.keyup.replaceToParagraph(!1),this.opts.linebreaks||!$(this.keyup.parent).hasClass("redactor-invisible-space")||$parent!==!1&&"BODY"!=$parent[0].tagName||($(this.keyup.parent).contents().unwrap(),this.keyup.replaceToParagraph()),this.linkify.isEnabled()&&this.linkify.isKey(key)&&this.linkify.format(),key===this.keyCode.DELETE||key===this.keyCode.BACKSPACE?(this.clean.clearUnverified(),this.observe.image?(e.preventDefault(),this.image.hideResize(),this.buffer.set(),this.image.remove(this.observe.image),this.observe.image=!1,!1):(this.$editor.find("p").each($.proxy(this.utils.removeEmpty,this)),this.opts.linebreaks&&this.keyup.current&&"DIV"==this.keyup.current.tagName&&this.utils.isEmpty(this.keyup.current.innerHTML)&&($(this.keyup.current).after(this.selection.getMarkerAsHtml()),this.selection.restore(),$(this.keyup.current).remove()),this.keyup.formatEmpty(e))):void 0)}},replaceToParagraph:function(clone){var node,$current=$(this.keyup.current);node=$("<p>").append(clone===!1?$current.html():$current.clone()),$current.replaceWith(node);var next=$(node).next();"undefined"!=typeof next[0]&&"BR"==next[0].tagName&&next.remove(),this.caret.setEnd(node)},formatEmpty:function(e){var html=$.trim(this.$editor.html());if(this.utils.isEmpty(html))return e.preventDefault(),this.opts.linebreaks?(this.$editor.html(this.selection.getMarkerAsHtml()),this.selection.restore()):(html="<p><br /></p>",this.$editor.html(html),this.focus.setStart()),this.code.sync(),!1}}},lang:function(){return{load:function(){this.opts.curLang=this.opts.langs[this.opts.lang]},get:function(name){return"undefined"!=typeof this.opts.curLang[name]?this.opts.curLang[name]:""}}},line:function(){return{insert:function(){this.buffer.set();var blocks=this.selection.getBlocks();return blocks[0]!==!1&&this.line.isExceptLastOrFirst(blocks)?void(this.utils.browser("msie")||this.$editor.focus()):void(this.utils.browser("msie")?this.line.insertInIe():this.line.insertInOthersBrowsers())},isExceptLastOrFirst:function(blocks){var exceptTags=["li","td","th","blockquote","figcaption","pre","dl","dt","dd"],first=blocks[0].tagName.toLowerCase(),last=this.selection.getLastBlock();last="undefined"==typeof last?first:last.tagName.toLowerCase();var firstFound=-1!=$.inArray(first,exceptTags),lastFound=-1!=$.inArray(last,exceptTags);return firstFound&&lastFound||firstFound?!0:void 0},insertInIe:function(){this.utils.saveScroll(),this.buffer.set(),this.insert.node(document.createElement("hr")),this.utils.restoreScroll(),this.code.sync()},insertInOthersBrowsers:function(){this.buffer.set();var extra='<p id="redactor-insert-line"><br /></p>';this.opts.linebreaks&&(extra='<br id="redactor-insert-line">'),document.execCommand("insertHTML",!1,"<hr>"+extra),this.line.setFocus(),this.code.sync()},setFocus:function(){var node=this.$editor.find("#redactor-insert-line"),next=$(node).next()[0];next?(this.caret.setAfter(node),node.remove()):node.removeAttr("id")}}},link:function(){return{show:function(e){"undefined"!=typeof e&&e.preventDefault&&e.preventDefault(),this.modal.load("link",this.lang.get("link_insert"),600),this.modal.createCancelButton(),this.link.buttonInsert=this.modal.createActionButton(this.lang.get("insert")),this.selection.get(),this.link.getData(),this.link.cleanUrl(),"_blank"==this.link.target&&$("#redactor-link-blank").prop("checked",!0),this.link.$inputUrl=$("#redactor-link-url"),this.link.$inputText=$("#redactor-link-url-text"),this.link.$inputText.val(this.link.text),this.link.$inputUrl.val(this.link.url),this.link.buttonInsert.on("click",$.proxy(this.link.insert,this)),$(".redactor-link-tooltip").remove(),this.selection.save(),this.modal.show(),this.link.$inputUrl.focus()},cleanUrl:function(){var thref=self.location.href.replace(/\/$/i,"");
if(this.link.url=this.link.url.replace(thref,""),this.link.url=this.link.url.replace(/^\/#/,"#"),this.link.url=this.link.url.replace("mailto:",""),!this.opts.linkProtocol){var re=new RegExp("^(http|ftp|https)://"+self.location.host,"i");this.link.url=this.link.url.replace(re,"")}},getData:function(){this.link.$node=!1;var $el=$(this.selection.getCurrent()).closest("a",this.$editor[0]);0!==$el.length&&"A"===$el[0].tagName?(this.link.$node=$el,this.link.url=$el.attr("href"),this.link.text=$el.text(),this.link.target=$el.attr("target")):(this.link.text=this.sel.toString(),this.link.url="",this.link.target="")},insert:function(){this.placeholder.remove();var target="",link=this.link.$inputUrl.val(),text=this.link.$inputText.val();if(""===$.trim(link))return void this.link.$inputUrl.addClass("redactor-input-error").on("keyup",function(){$(this).removeClass("redactor-input-error"),$(this).off("keyup")});if(-1!=link.search("@")&&/(http|ftp|https):\/\//i.test(link)===!1)link="mailto:"+link;else if(0!==link.search("#")){$("#redactor-link-blank").prop("checked")&&(target="_blank");var pattern="((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}",re=new RegExp("^(http|ftp|https)://"+pattern,"i"),re2=new RegExp("^"+pattern,"i"),re3=new RegExp(".(html|php)$","i");-1==link.search(re)&&-1==link.search(re3)&&0===link.search(re2)&&this.opts.linkProtocol&&(link=this.opts.linkProtocol+"://"+link)}this.link.set(text,link,target),this.modal.close()},set:function(text,link,target){if(text=$.trim(text.replace(/<|>/g,"")),this.selection.restore(),""!==text||""!==link){if(""===text&&""!==link&&(text=link),this.link.$node){this.buffer.set();var $link=this.link.$node,$el=$link.children();if($el.length>0){for(;$el.length;)$el=$el.children();$el=$el.end()}else $el=$link;$link.attr("href",link),$el.text(text),""!==target?$link.attr("target",target):$link.removeAttr("target"),this.selection.selectElement($link),this.code.sync()}else{if(this.utils.browser("mozilla")&&""===this.link.text){var $a=$("<a />").attr("href",link).text(text);""!==target&&$a.attr("target",target),this.insert.node($a),this.selection.selectElement($a)}else{var $a;this.utils.browser("msie")?($a=$('<a href="'+link+'">').text(text),""!==target&&$a.attr("target",target),$a=$(this.insert.node($a)),this.selection.getText().match(/\s$/)&&$a.after(" "),this.selection.selectElement($a)):(document.execCommand("createLink",!1,link),$a=$(this.selection.getCurrent()).closest("a",this.$editor[0]),this.utils.browser("mozilla")&&($a=$('a[_moz_dirty=""]')),""!==target&&$a.attr("target",target),$a.removeAttr("style").removeAttr("_moz_dirty"),this.selection.getText().match(/\s$/)&&$a.after(" "),(""!==this.link.text||this.link.text!=text)&&($a.text(text),this.selection.selectElement($a)))}this.code.sync(),this.core.setCallback("insertedLink",$a)}setTimeout($.proxy(function(){this.observe.links()},this),5)}},unlink:function(e){"undefined"!=typeof e&&e.preventDefault&&e.preventDefault();var nodes=this.selection.getNodes();if(nodes){this.buffer.set();for(var len=nodes.length,i=0;len>i;i++){var $node=$(nodes[i]).closest("a",this.$editor[0]);$node.replaceWith($node.contents())}$(".redactor-link-tooltip").remove(),this.code.sync()}},toggleClass:function(className){this.link.setClass(className,"toggleClass")},addClass:function(className){this.link.setClass(className,"addClass")},removeClass:function(className){this.link.setClass(className,"removeClass")},setClass:function(className,func){var links=this.selection.getInlinesTags(["a"]);links!==!1&&$.each(links,function(){$(this)[func](className)})}}},list:function(){return{toggle:function(cmd){this.placeholder.remove(),this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var parent=this.selection.getParent(),$list=$(parent).closest("ol, ul",this.$editor[0]);this.utils.isRedactorParent($list)||0===$list.length||($list=!1);var isUnorderedCmdOrdered,isOrderedCmdUnordered,remove=!1;if($list&&$list.length){remove=!0;var listTag=$list[0].tagName;isUnorderedCmdOrdered="orderedlist"===cmd&&"UL"===listTag,isOrderedCmdUnordered="unorderedlist"===cmd&&"OL"===listTag}isUnorderedCmdOrdered?this.utils.replaceToTag($list,"ol"):isOrderedCmdUnordered?this.utils.replaceToTag($list,"ul"):remove?this.list.remove(cmd):this.list.insert(cmd),this.selection.restore(),this.code.sync()},insert:function(cmd){var parent=this.selection.getParent(),current=this.selection.getCurrent(),$td=$(current).closest("td, th",this.$editor[0]);this.utils.browser("msie")&&this.opts.linebreaks?this.list.insertInIe(cmd):document.execCommand("insert"+cmd);var $list=$(this.selection.getParent()).closest("ol, ul",this.$editor[0]);if(0!==$td.length){var prev=$td.prev(),html=$td.html();$td.html(""),!prev||1!==prev.length||"TD"!==prev[0].tagName&&"TH"!==prev[0].tagName?$(parent).prepend($td):$(prev).after($td),$td.html(html)}if(this.utils.isEmpty($list.find("li").text())){var $children=$list.children("li");$children.find("br").remove(),$children.append(this.selection.getMarkerAsHtml())}if($list.length){var $listParent=$list.parent();this.utils.isRedactorParent($listParent)&&"LI"!=$listParent[0].tagName&&this.utils.isBlock($listParent[0])&&$listParent.replaceWith($listParent.contents())}this.utils.browser("msie")||this.$editor.focus(),this.clean.clearUnverified()},insertInIe:function(cmd){var wrapper=this.selection.wrap("div"),wrapperHtml=$(wrapper).html(),tmpList=$("orderedlist"==cmd?"<ol>":"<ul>"),tmpLi=$("<li>");if(""===$.trim(wrapperHtml))tmpLi.append(this.selection.getMarkerAsHtml()),tmpList.append(tmpLi),this.$editor.find("#selection-marker-1").replaceWith(tmpList);else{var items=wrapperHtml.split(/<br\s?\/?>/gi);if(items)for(var i=0;i<items.length;i++)""!==$.trim(items[i])&&tmpList.append($("<li>").html(items[i]));else tmpLi.append(wrapperHtml),tmpList.append(tmpLi);$(wrapper).replaceWith(tmpList)}},remove:function(cmd){document.execCommand("insert"+cmd);var $current=$(this.selection.getCurrent());this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==$current.closest("li, th, td",this.$editor[0]).length||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote").each($.proxy(this.utils.removeEmpty,this)));var $table=$(this.selection.getCurrent()).closest("table",this.$editor[0]),$prev=$table.prev();this.opts.linebreaks||0===$table.length||0===$prev.length||"BR"!=$prev[0].tagName||$prev.remove(),this.clean.clearUnverified()}}},modal:function(){return{callbacks:{},loadTemplates:function(){this.opts.modal={imageEdit:String()+'<section id="redactor-modal-image-edit"><label>'+this.lang.get("title")+'</label><input type="text" id="redactor-image-title" /><label class="redactor-image-link-option">'+this.lang.get("link")+'</label><input type="text" id="redactor-image-link" class="redactor-image-link-option" /><label class="redactor-image-link-option"><input type="checkbox" id="redactor-image-link-blank"> '+this.lang.get("link_new_tab")+'</label><label class="redactor-image-position-option">'+this.lang.get("image_position")+'</label><select class="redactor-image-position-option" id="redactor-image-align"><option value="none">'+this.lang.get("none")+'</option><option value="left">'+this.lang.get("left")+'</option><option value="center">'+this.lang.get("center")+'</option><option value="right">'+this.lang.get("right")+"</option></select></section>",image:String()+'<section id="redactor-modal-image-insert"><div id="redactor-modal-image-droparea"></div></section>',file:String()+'<section id="redactor-modal-file-insert"><div id="redactor-modal-file-upload-box"><label>'+this.lang.get("filename")+'</label><input type="text" id="redactor-filename" /><br><br><div id="redactor-modal-file-upload"></div></div></section>',link:String()+'<section id="redactor-modal-link-insert"><label>URL</label><input type="url" id="redactor-link-url" /><label>'+this.lang.get("text")+'</label><input type="text" id="redactor-link-url-text" /><label><input type="checkbox" id="redactor-link-blank"> '+this.lang.get("link_new_tab")+"</label></section>"},$.extend(this.opts,this.opts.modal)},addCallback:function(name,callback){this.modal.callbacks[name]=callback},createTabber:function($modal){this.modal.$tabber=$("<div>").attr("id","redactor-modal-tabber"),$modal.prepend(this.modal.$tabber)},addTab:function(id,name,active){var $tab=$('<a href="#" rel="tab'+id+'">').text(name);active&&$tab.addClass("active");var self=this;$tab.on("click",function(e){e.preventDefault(),$(".redactor-tab").hide(),$(".redactor-"+$(this).attr("rel")).show(),self.modal.$tabber.find("a").removeClass("active"),$(this).addClass("active")}),this.modal.$tabber.append($tab)},addTemplate:function(name,template){this.opts.modal[name]=template},getTemplate:function(name){return this.opts.modal[name]},getModal:function(){return this.$modalBody.find("section")},load:function(templateName,title,width){this.modal.templateName=templateName,this.modal.width=width,this.modal.build(),this.modal.enableEvents(),this.modal.setTitle(title),this.modal.setDraggable(),this.modal.setContent(),"undefined"!=typeof this.modal.callbacks[templateName]&&this.modal.callbacks[templateName].call(this)},show:function(){this.utils.isMobile()&&!this.utils.browser("msie")&&document.activeElement.blur(),$(document.body).removeClass("body-redactor-hidden"),this.modal.bodyOveflow=$(document.body).css("overflow"),$(document.body).css("overflow","hidden"),this.utils.isMobile()?this.modal.showOnMobile():this.modal.showOnDesktop(),this.$modalOverlay.show(),this.$modalBox.show(),this.modal.setButtonsWidth(),this.utils.saveScroll(),this.utils.isMobile()||(setTimeout($.proxy(this.modal.showOnDesktop,this),0),$(window).on("resize.redactor-modal",$.proxy(this.modal.resize,this))),this.core.setCallback("modalOpened",this.modal.templateName,this.$modal),$(document).off("focusin.modal"),this.$modal.find("input[type=text],input[type=url],input[type=email]").on("keydown.redactor-modal",$.proxy(this.modal.setEnter,this))},showOnDesktop:function(){var height=this.$modal.outerHeight(),windowHeight=$(window).height(),windowWidth=$(window).width();return this.modal.width>windowWidth?void this.$modal.css({width:"96%",marginTop:windowHeight/2-height/2+"px"}):void this.$modal.css(height>windowHeight?{width:this.modal.width+"px",marginTop:"20px"}:{width:this.modal.width+"px",marginTop:windowHeight/2-height/2+"px"})},showOnMobile:function(){this.$modal.css({width:"96%",marginTop:"2%"})},resize:function(){this.utils.isMobile()?this.modal.showOnMobile():this.modal.showOnDesktop()},setTitle:function(title){this.$modalHeader.html(title)},setContent:function(){this.$modalBody.html(this.modal.getTemplate(this.modal.templateName))},setDraggable:function(){"undefined"!=typeof $.fn.draggable&&(this.$modal.draggable({handle:this.$modalHeader}),this.$modalHeader.css("cursor","move"))},setEnter:function(e){13==e.which&&(e.preventDefault(),this.$modal.find("button.redactor-modal-action-btn").click())},createCancelButton:function(){var button=$("<button>").addClass("redactor-modal-btn redactor-modal-close-btn").html(this.lang.get("cancel"));button.on("click",$.proxy(this.modal.close,this)),this.$modalFooter.append(button)},createDeleteButton:function(label){return this.modal.createButton(label,"delete")},createActionButton:function(label){return this.modal.createButton(label,"action")},createButton:function(label,className){var button=$("<button>").addClass("redactor-modal-btn").addClass("redactor-modal-"+className+"-btn").html(label);return this.$modalFooter.append(button),button},setButtonsWidth:function(){var buttons=this.$modalFooter.find("button"),buttonsSize=buttons.length;0!==buttonsSize&&buttons.css("width",100/buttonsSize+"%")},build:function(){this.modal.buildOverlay(),this.$modalBox=$('<div id="redactor-modal-box" />').hide(),this.$modal=$('<div id="redactor-modal" />'),this.$modalHeader=$("<header />"),this.$modalClose=$('<span id="redactor-modal-close" />').html("&times;"),this.$modalBody=$('<div id="redactor-modal-body" />'),this.$modalFooter=$("<footer />"),this.$modal.append(this.$modalHeader),this.$modal.append(this.$modalClose),this.$modal.append(this.$modalBody),this.$modal.append(this.$modalFooter),this.$modalBox.append(this.$modal),this.$modalBox.appendTo(document.body)},buildOverlay:function(){this.$modalOverlay=$('<div id="redactor-modal-overlay">').hide(),$("body").prepend(this.$modalOverlay)},enableEvents:function(){this.$modalClose.on("click.redactor-modal",$.proxy(this.modal.close,this)),$(document).on("keyup.redactor-modal",$.proxy(this.modal.closeHandler,this)),this.$editor.on("keyup.redactor-modal",$.proxy(this.modal.closeHandler,this)),this.$modalBox.on("click.redactor-modal",$.proxy(this.modal.close,this))},disableEvents:function(){this.$modalClose.off("click.redactor-modal"),$(document).off("keyup.redactor-modal"),this.$editor.off("keyup.redactor-modal"),this.$modalBox.off("click.redactor-modal"),$(window).off("resize.redactor-modal")},closeHandler:function(e){e.which==this.keyCode.ESC&&this.modal.close(!1)},close:function(e){if(e){if(!$(e.target).hasClass("redactor-modal-close-btn")&&e.target!=this.$modalClose[0]&&e.target!=this.$modalBox[0])return;e.preventDefault()}this.$modalBox&&(this.modal.disableEvents(),this.$modalOverlay.remove(),this.$modalBox.fadeOut("fast",$.proxy(function(){this.$modalBox.remove(),setTimeout($.proxy(this.utils.restoreScroll,this),0),void 0!==e&&this.selection.restore(),$(document.body).css("overflow",this.modal.bodyOveflow),this.core.setCallback("modalClosed",this.modal.templateName)},this)))}}},observe:function(){return{load:function(){this.observe.images(),this.observe.links()},buttons:function(e,btnName){var current=this.selection.getCurrent(),parent=this.selection.getParent();if(e!==!1?this.button.setInactiveAll():this.button.setInactiveAll(btnName),e===!1&&"html"!==btnName)return void(-1!=$.inArray(btnName,this.opts.activeButtons)&&this.button.toggleActive(btnName));$.each(this.opts.activeButtonsStates,$.proxy(function(key,value){var parentEl=$(parent).closest(key,this.$editor[0]),currentEl=$(current).closest(key,this.$editor[0]);(0===parentEl.length||this.utils.isRedactorParent(parentEl))&&this.utils.isRedactorParent(currentEl)&&(0!==parentEl.length||0!==currentEl.closest(key,this.$editor[0]).length)&&this.button.setActive(value)},this));var $parent=$(parent).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]);if(this.utils.isRedactorParent(parent)&&$parent.length){var align=""===$parent.css("text-align")?"left":$parent.css("text-align");this.button.setActive("align"+align)}},addButton:function(tag,btnName){this.opts.activeButtons.push(btnName),this.opts.activeButtonsStates[tag]=btnName},images:function(){this.$editor.find("img").each($.proxy(function(i,img){var $img=$(img);$img.closest("a",this.$editor[0]).on("click",function(e){e.preventDefault()}),this.utils.browser("msie")&&$img.attr("unselectable","on"),this.image.setEditable($img)},this)),$(document).on("click.redactor-image-delete."+this.uuid,$.proxy(function(e){this.observe.image=!1,"IMG"==e.target.tagName&&this.utils.isRedactorParent(e.target)&&(this.observe.image=this.observe.image&&this.observe.image==e.target?!1:e.target)},this))},links:function(){this.opts.linkTooltip&&(this.$editor.find("a").on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,$.proxy(this.observe.showTooltip,this)),this.$editor.on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,$.proxy(this.observe.closeTooltip,this)),$(document).on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,$.proxy(this.observe.closeTooltip,this)))},getTooltipPosition:function($link){return $link.offset()},showTooltip:function(e){var $el=$(e.target);if("IMG"!=$el[0].tagName&&("A"!==$el[0].tagName&&($el=$el.closest("a",this.$editor[0])),"A"===$el[0].tagName)){var $link=$el,pos=this.observe.getTooltipPosition($link),tooltip=$('<span class="redactor-link-tooltip"></span>'),href=$link.attr("href");void 0===href&&(href=""),href.length>24&&(href=href.substring(0,24)+"...");var aLink=$('<a href="'+$link.attr("href")+'" target="_blank" />').html(href).addClass("redactor-link-tooltip-action"),aEdit=$('<a href="#" />').html(this.lang.get("edit")).on("click",$.proxy(this.link.show,this)).addClass("redactor-link-tooltip-action"),aUnlink=$('<a href="#" />').html(this.lang.get("unlink")).on("click",$.proxy(this.link.unlink,this)).addClass("redactor-link-tooltip-action");tooltip.append(aLink).append(" | ").append(aEdit).append(" | ").append(aUnlink),tooltip.css({top:pos.top+parseInt($link.css("line-height"),10)+"px",left:pos.left+"px"}),$(".redactor-link-tooltip").remove(),$("body").append(tooltip)}},closeTooltip:function(e){e=e.originalEvent||e;var target=e.target,$parent=$(target).closest("a",this.$editor[0]);(0===$parent.length||"A"!==$parent[0].tagName||"A"===target.tagName)&&("A"===target.tagName&&this.utils.isRedactorParent(target)||$(target).hasClass("redactor-link-tooltip-action")||$(".redactor-link-tooltip").remove())}}},paragraphize:function(){return{load:function(html){return this.opts.linebreaks?html:""===html||"<p></p>"===html?this.opts.emptyHtml:(this.paragraphize.blocks=["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"],html+="\n",this.paragraphize.safes=[],this.paragraphize.z=0,html=html.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>"),html=this.paragraphize.getSafes(html),html=this.paragraphize.getSafesComments(html),html=this.paragraphize.replaceBreaksToNewLines(html),html=this.paragraphize.replaceBreaksToParagraphs(html),html=this.paragraphize.clear(html),html=this.paragraphize.restoreSafes(html),html=html.replace(new RegExp("<br\\s?/?>\n?<("+this.paragraphize.blocks.join("|")+")(.*?[^>])>","gi"),"<p><br /></p>\n<$1$2>"),$.trim(html))},getSafes:function(html){var $div=$("<div />").append(html);return $div.find("blockquote p").replaceWith(function(){return $(this).append("<br />").contents()}),html=$div.html(),$div.find(this.paragraphize.blocks.join(", ")).each($.proxy(function(i,s){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=s.outerHTML,html=html.replace(s.outerHTML,"\n{replace"+this.paragraphize.z+"}")},this)),html},getSafesComments:function(html){var commentsMatches=html.match(/<!--([\w\W]*?)-->/gi);return commentsMatches?($.each(commentsMatches,$.proxy(function(i,s){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=s,html=html.replace(s,"\n{replace"+this.paragraphize.z+"}")},this)),html):html},restoreSafes:function(html){return $.each(this.paragraphize.safes,function(i,s){s="undefined"!=typeof s?s.replace(/\$/g,"&#36;"):s,html=html.replace("{replace"+i+"}",s)}),html},replaceBreaksToParagraphs:function(html){var htmls=html.split(new RegExp("\n","g"),-1);if(html="",htmls)for(var len=htmls.length,i=0;len>i;i++){if(!htmls.hasOwnProperty(i))return;-1==htmls[i].search("{replace")?(htmls[i]=htmls[i].replace(/<p>\n\t?<\/p>/gi,""),htmls[i]=htmls[i].replace(/<p><\/p>/gi,""),""!==htmls[i]&&(html+="<p>"+htmls[i].replace(/^\n+|\n+$/g,"")+"</p>")):html+=htmls[i]}return html},replaceBreaksToNewLines:function(html){return html=html.replace(/<br \/>\s*<br \/>/gi,"\n\n"),html=html.replace(/<br\s?\/?>\n?<br\s?\/?>/gi,"\n<br /><br />"),html=html.replace(new RegExp("\r\n","g"),"\n"),html=html.replace(new RegExp("\r","g"),"\n"),html=html.replace(new RegExp("/\n\n+/"),"g","\n\n")},clear:function(html){return html=html.replace(new RegExp("</blockquote></p>","gi"),"</blockquote>"),html=html.replace(new RegExp("<p></blockquote>","gi"),"</blockquote>"),html=html.replace(new RegExp("<p><blockquote>","gi"),"<blockquote>"),html=html.replace(new RegExp("<blockquote></p>","gi"),"<blockquote>"),html=html.replace(new RegExp("<p><p ","gi"),"<p "),html=html.replace(new RegExp("<p><p>","gi"),"<p>"),html=html.replace(new RegExp("</p></p>","gi"),"</p>"),html=html.replace(new RegExp("<p>\\s?</p>","gi"),""),html=html.replace(new RegExp("\n</p>","gi"),"</p>"),html=html.replace(new RegExp("<p>	?	?\n?<p>","gi"),"<p>"),html=html.replace(new RegExp("<p>	*</p>","gi"),"")}}},paste:function(){return{init:function(e){return this.opts.cleanOnPaste?(this.rtePaste=!0,this.buffer.set(),this.selection.save(),this.utils.saveScroll(),this.paste.createPasteBox(),$(window).on("scroll.redactor-freeze",$.proxy(function(){$(window).scrollTop(this.saveBodyScroll)},this)),void setTimeout($.proxy(function(){var html=this.$pasteBox.html();this.$pasteBox.remove(),this.selection.restore(),this.utils.restoreScroll(),this.paste.insert(html),$(window).off("scroll.redactor-freeze"),this.linkify.isEnabled()&&this.linkify.format()},this),1)):void setTimeout($.proxy(this.code.sync,this),1)},createPasteBox:function(){this.$pasteBox=$("<div>").html("").attr("contenteditable","true").css({position:"fixed",width:0,top:0,left:"-9999px"}),this.utils.browser("msie")?this.$box.append(this.$pasteBox):$("body").append(this.$pasteBox),this.$pasteBox.focus()},insert:function(html){html=this.core.setCallback("pasteBefore",html),html=this.utils.isSelectAll()?this.clean.onPaste(html,!1):this.clean.onPaste(html),html=this.core.setCallback("paste",html),this.utils.isSelectAll()?this.insert.set(html,!1):this.insert.html(html,!1),this.utils.disableSelectAll(),this.rtePaste=!1,setTimeout($.proxy(this.clean.clearUnverified,this),10),setTimeout($.proxy(function(){var spans=this.$editor.find("span");$.each(spans,function(i,s){var html=s.innerHTML.replace(/[\u200B-\u200D\uFEFF]/,"");""===html&&0===s.attributes.length&&$(s).remove()})},this),10)}}},placeholder:function(){return{enable:function(){this.placeholder.is()&&(this.$editor.attr("placeholder",this.$element.attr("placeholder")),this.placeholder.toggle(),this.$editor.on("keyup.redactor-placeholder",$.proxy(this.placeholder.toggle,this)))},toggle:function(){var func="removeClass";this.utils.isEmpty(this.$editor.html(),!1)&&(func="addClass"),this.$editor[func]("redactor-placeholder")},remove:function(){this.$editor.removeClass("redactor-placeholder")},is:function(){return this.opts.placeholder?this.$element.attr("placeholder",this.opts.placeholder):!("undefined"==typeof this.$element.attr("placeholder")||""===this.$element.attr("placeholder"))}}},progress:function(){return{show:function(){$(document.body).append($('<div id="redactor-progress"><span></span></div>')),$("#redactor-progress").fadeIn()},hide:function(){$("#redactor-progress").fadeOut(1500,function(){$(this).remove()})}}},selection:function(){return{get:function(){this.sel=document.getSelection(),document.getSelection&&this.sel.getRangeAt&&this.sel.rangeCount?this.range=this.sel.getRangeAt(0):this.range=document.createRange()},addRange:function(){try{this.sel.removeAllRanges()}catch(e){}this.sel.addRange(this.range)},getCurrent:function(){var el=!1;return this.selection.get(),this.sel&&this.sel.rangeCount>0&&(el=this.sel.getRangeAt(0).startContainer),this.utils.isRedactorParent(el)},getParent:function(elem){return elem=elem||this.selection.getCurrent(),elem?this.utils.isRedactorParent($(elem).parent()[0]):!1},getBlock:function(node){for(node=node||this.selection.getCurrent();node;){if(this.utils.isBlockTag(node.tagName))return $(node).hasClass("redactor-editor")?!1:node;node=node.parentNode}return!1},getInlines:function(nodes,tags){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var inlines=[];nodes="undefined"==typeof nodes||nodes===!1?this.selection.getNodes():nodes;var inlineTags=this.opts.inlineTags;if(inlineTags.push("span"),"undefined"!=typeof tags)for(var i=0;i<tags.length;i++)inlineTags.push(tags[i]);return $.each(nodes,$.proxy(function(i,node){-1!=$.inArray(node.tagName.toLowerCase(),inlineTags)&&inlines.push(node)},this)),0===inlines.length?!1:inlines},getInlinesTags:function(tags){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var inlines=[],nodes=this.selection.getNodes();return $.each(nodes,$.proxy(function(i,node){-1!=$.inArray(node.tagName.toLowerCase(),tags)&&inlines.push(node)},this)),0===inlines.length?!1:inlines},getBlocks:function(nodes){if(this.selection.get(),this.range&&this.range.collapsed)return[this.selection.getBlock()];var blocks=[];return nodes="undefined"==typeof nodes?this.selection.getNodes():nodes,$.each(nodes,$.proxy(function(i,node){this.utils.isBlock(node)&&(this.selection.lastBlock=node,blocks.push(node))},this)),0===blocks.length?[this.selection.getBlock()]:blocks},getLastBlock:function(){return this.selection.lastBlock},getNodes:function(){this.selection.get();var startNode=this.selection.getNodesMarker(1),endNode=this.selection.getNodesMarker(2),range=this.range.cloneRange();if(this.range.collapsed===!1){var startContainer=range.startContainer,startOffset=range.startOffset;this.selection.setNodesMarker(range,endNode,!1),range.setStart(startContainer,startOffset),this.selection.setNodesMarker(range,startNode,!0)}else this.selection.setNodesMarker(range,startNode,!0),endNode=startNode;var nodes=[],counter=0,self=this;this.$editor.find("*").each(function(){if(this==startNode){var parent=$(this).parent();0!==parent.length&&"BODY"!=parent[0].tagName&&self.utils.isRedactorParent(parent[0])&&nodes.push(parent[0]),nodes.push(this),counter=1}else counter>0&&(nodes.push(this),counter+=1);return this==endNode?!1:void 0});for(var finalNodes=[],len=nodes.length,i=0;len>i;i++)"nodes-marker-1"!=nodes[i].id&&"nodes-marker-2"!=nodes[i].id&&finalNodes.push(nodes[i]);return this.selection.removeNodesMarkers(),finalNodes},getNodesMarker:function(num){return $('<span id="nodes-marker-'+num+'" class="redactor-nodes-marker" data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},setNodesMarker:function(range,node,type){try{range.collapse(type),range.insertNode(node)}catch(e){}},removeNodesMarkers:function(){$(document).find("span.redactor-nodes-marker").remove(),this.$editor.find("span.redactor-nodes-marker").remove()},fromPoint:function(start,end){this.caret.setOffset(start,end)},wrap:function(tag){if(this.selection.get(),this.range.collapsed)return!1;var wrapper=document.createElement(tag);return wrapper.appendChild(this.range.extractContents()),this.range.insertNode(wrapper),wrapper},selectElement:function(node){this.caret.set(node,0,node,1)},selectAll:function(){this.selection.get(),this.range.selectNodeContents(this.$editor[0]),this.selection.addRange()},remove:function(){this.selection.get(),this.sel.removeAllRanges()},save:function(){this.selection.createMarkers()},createMarkers:function(){this.selection.get();var node1=this.selection.getMarker(1);if(this.selection.setMarker(this.range,node1,!0),this.range.collapsed===!1){var node2=this.selection.getMarker(2);this.selection.setMarker(this.range,node2,!1)}this.savedSel=this.$editor.html()},getMarker:function(num){return"undefined"==typeof num&&(num=1),$('<span id="selection-marker-'+num+'" class="redactor-selection-marker"  data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},getMarkerAsHtml:function(num){return this.utils.getOuterHtml(this.selection.getMarker(num))},setMarker:function(range,node,type){range=range.cloneRange();try{range.collapse(type),range.insertNode(node)}catch(e){this.focus.setStart()}},restore:function(){var node1=this.$editor.find("span#selection-marker-1"),node2=this.$editor.find("span#selection-marker-2");0!==node1.length&&0!==node2.length?this.caret.set(node1,0,node2,0):0!==node1.length?this.caret.set(node1,0,node1,0):this.$editor.focus(),this.selection.removeMarkers(),this.savedSel=!1},removeMarkers:function(){this.$editor.find("span.redactor-selection-marker").each(function(i,s){var text=$(s).text().replace(/[\u200B-\u200D\uFEFF]/g,"");""===text?$(s).remove():$(s).replaceWith(function(){return $(this).contents()})})},getText:function(){return this.selection.get(),this.sel.toString()},getHtml:function(){var html="";if(this.selection.get(),this.sel.rangeCount){for(var container=document.createElement("div"),len=this.sel.rangeCount,i=0;len>i;++i)container.appendChild(this.sel.getRangeAt(i).cloneContents());html=container.innerHTML}return this.clean.onSync(html)},replaceWithHtml:function(html){if(html=this.selection.getMarkerAsHtml(1)+html+this.selection.getMarkerAsHtml(2),this.selection.get(),window.getSelection&&window.getSelection().getRangeAt){this.range.deleteContents();var div=document.createElement("div");div.innerHTML=html;for(var child,frag=document.createDocumentFragment();child=div.firstChild;)frag.appendChild(child);this.range.insertNode(frag)}else document.selection&&document.selection.createRange&&this.range.pasteHTML(html);this.selection.restore(),this.code.sync()}}},shortcuts:function(){return{init:function(e,key){return this.opts.shortcuts?void $.each(this.opts.shortcuts,$.proxy(function(str,command){for(var keys=str.split(","),len=keys.length,i=0;len>i;i++)"string"==typeof keys[i]&&this.shortcuts.handler(e,$.trim(keys[i]),$.proxy(function(){var func;"-1"!=command.func.search(/\./)?(func=command.func.split("."),"undefined"!=typeof this[func[0]]&&this[func[0]][func[1]].apply(this,command.params)):this[command.func].apply(this,command.params)},this))},this)):(!e.ctrlKey&&!e.metaKey||66!==key&&73!==key||e.preventDefault(),!1)},handler:function(e,keys,origHandler){var hotkeysSpecialKeys={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},hotkeysShiftNums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"};keys=keys.toLowerCase().split(" ");var special=hotkeysSpecialKeys[e.keyCode],character=String.fromCharCode(e.which).toLowerCase(),modif="",possible={};$.each(["alt","ctrl","meta","shift"],function(index,specialKey){e[specialKey+"Key"]&&special!==specialKey&&(modif+=specialKey+"+")}),special&&(possible[modif+special]=!0),character&&(possible[modif+character]=!0,possible[modif+hotkeysShiftNums[character]]=!0,"shift+"===modif&&(possible[hotkeysShiftNums[character]]=!0));for(var i=0,len=keys.length;len>i;i++)if(possible[keys[i]])return e.preventDefault(),origHandler.apply(this,arguments)}}},tabifier:function(){return{get:function(code){if(!this.opts.tabifier)return code;var ownLine=["area","body","head","hr","i?frame","link","meta","noscript","style","script","table","tbody","thead","tfoot"],contOwnLine=["li","dt","dt","h[1-6]","option","script"],newLevel=["p","blockquote","div","dl","fieldset","form","frameset","map","ol","pre","select","td","th","tr","ul"];this.tabifier.lineBefore=new RegExp("^<(/?"+ownLine.join("|/?")+"|"+contOwnLine.join("|")+")[ >]"),this.tabifier.lineAfter=new RegExp("^<(br|/?"+ownLine.join("|/?")+"|/"+contOwnLine.join("|/")+")[ >]"),this.tabifier.newLevel=new RegExp("^</?("+newLevel.join("|")+")[ >]");var i=0,codeLength=code.length,point=0,start=null,end=null,tag="",out="",cont="";for(this.tabifier.cleanlevel=0;codeLength>i;i++){if(point=i,-1==code.substr(i).indexOf("<"))return out+=code.substr(i),this.tabifier.finish(out);for(;codeLength>point&&"<"!=code.charAt(point);)point++;for(i!=point&&(cont=code.substr(i,point-i),cont.match(/^\s{2,}$/g)||("\n"==out.charAt(out.length-1)?out+=this.tabifier.getTabs():"\n"==cont.charAt(0)&&(out+="\n"+this.tabifier.getTabs(),cont=cont.replace(/^\s+/,"")),out+=cont),cont.match(/\n/)&&(out+="\n"+this.tabifier.getTabs())),start=point;codeLength>point&&">"!=code.charAt(point);)point++;
tag=code.substr(start,point-start),i=point;var t;if("!--"==tag.substr(1,3)){if(!tag.match(/--$/)){for(;"-->"!=code.substr(point,3);)point++;point+=2,tag=code.substr(start,point-start),i=point}"\n"!=out.charAt(out.length-1)&&(out+="\n"),out+=this.tabifier.getTabs(),out+=tag+">\n"}else"!"==tag[1]?out=this.tabifier.placeTag(tag+">",out):"?"==tag[1]?out+=tag+">\n":(t=tag.match(/^<(script|style|pre)/i))?(t[1]=t[1].toLowerCase(),tag=this.tabifier.cleanTag(tag),out=this.tabifier.placeTag(tag,out),end=String(code.substr(i+1)).toLowerCase().indexOf("</"+t[1]),end&&(cont=code.substr(i+1,end),i+=end,out+=cont)):(tag=this.tabifier.cleanTag(tag),out=this.tabifier.placeTag(tag,out))}return this.tabifier.finish(out)},getTabs:function(){for(var s="",j=0;j<this.tabifier.cleanlevel;j++)s+="	";return s},finish:function(code){return code=code.replace(/\n\s*\n/g,"\n"),code=code.replace(/^[\s\n]*/,""),code=code.replace(/[\s\n]*$/,""),code=code.replace(/<script(.*?)>\n<\/script>/gi,"<script$1></script>"),this.tabifier.cleanlevel=0,code},cleanTag:function(tag){var tagout="";tag=tag.replace(/\n/g," "),tag=tag.replace(/\s{2,}/g," "),tag=tag.replace(/^\s+|\s+$/g," ");var suffix="";tag.match(/\/$/)&&(suffix="/",tag=tag.replace(/\/+$/,""));for(var m;m=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(tag);)m[2]?tagout+=m[1].toLowerCase()+"="+m[2]:m[1]&&(tagout+=m[1].toLowerCase()),tagout+=" ",tag=tag.substr(m[0].length);return tagout.replace(/\s*$/,"")+suffix+">"},placeTag:function(tag,out){var nl=tag.match(this.tabifier.newLevel);return(tag.match(this.tabifier.lineBefore)||nl)&&(out=out.replace(/\s*$/,""),out+="\n"),nl&&"/"==tag.charAt(1)&&this.tabifier.cleanlevel--,"\n"==out.charAt(out.length-1)&&(out+=this.tabifier.getTabs()),nl&&"/"!=tag.charAt(1)&&this.tabifier.cleanlevel++,out+=tag,(tag.match(this.tabifier.lineAfter)||tag.match(this.tabifier.newLevel))&&(out=out.replace(/ *$/,"")),out}}},tidy:function(){return{setupAllowed:function(){if(this.opts.allowedTags&&(this.opts.deniedTags=!1),this.opts.allowedAttr&&(this.opts.removeAttr=!1),!this.opts.linebreaks){var tags=["p","section"];this.opts.allowedTags&&this.tidy.addToAllowed(tags),this.opts.deniedTags&&this.tidy.removeFromDenied(tags)}},addToAllowed:function(tags){for(var len=tags.length,i=0;len>i;i++)-1==$.inArray(tags[i],this.opts.allowedTags)&&this.opts.allowedTags.push(tags[i])},removeFromDenied:function(tags){for(var len=tags.length,i=0;len>i;i++){var pos=$.inArray(tags[i],this.opts.deniedTags);-1!=pos&&this.opts.deniedTags.splice(pos,1)}},load:function(html,options){return this.tidy.settings={deniedTags:this.opts.deniedTags,allowedTags:this.opts.allowedTags,removeComments:this.opts.removeComments,replaceTags:this.opts.replaceTags,replaceStyles:this.opts.replaceStyles,removeDataAttr:this.opts.removeDataAttr,removeAttr:this.opts.removeAttr,allowedAttr:this.opts.allowedAttr,removeWithoutAttr:this.opts.removeWithoutAttr,removeEmpty:this.opts.removeEmpty},$.extend(this.tidy.settings,options),html=this.tidy.removeComments(html),this.tidy.$div=$("<div />").append(html),this.tidy.replaceTags(),this.tidy.replaceStyles(),this.tidy.removeTags(),this.tidy.removeAttr(),this.tidy.removeEmpty(),this.tidy.removeParagraphsInLists(),this.tidy.removeDataAttr(),this.tidy.removeWithoutAttr(),html=this.tidy.$div.html(),this.tidy.$div.remove(),html},removeComments:function(html){return this.tidy.settings.removeComments?html.replace(/<!--[\s\S]*?-->/gi,""):html},replaceTags:function(html){if(!this.tidy.settings.replaceTags)return html;for(var len=this.tidy.settings.replaceTags.length,replacement=[],rTags=[],i=0;len>i;i++)rTags.push(this.tidy.settings.replaceTags[i][1]),replacement.push(this.tidy.settings.replaceTags[i][0]);return this.tidy.$div.find(replacement.join(",")).each($.proxy(function(n,s){var tag=rTags[n];$(s).replaceWith(function(){for(var replaced=$("<"+tag+" />").append($(this).contents()),i=0;i<this.attributes.length;i++)replaced.attr(this.attributes[i].name,this.attributes[i].value);return replaced})},this)),html},replaceStyles:function(){if(this.tidy.settings.replaceStyles){var len=this.tidy.settings.replaceStyles.length;this.tidy.$div.find("span").each($.proxy(function(n,s){for(var $el=$(s),style=$el.attr("style"),i=0;len>i;i++)if(style&&style.match(new RegExp("^"+this.tidy.settings.replaceStyles[i][0],"i"))){var tagName=this.tidy.settings.replaceStyles[i][1];$el.replaceWith(function(){var tag=document.createElement(tagName);return $(tag).append($(this).contents())})}},this))}},removeTags:function(){!this.tidy.settings.deniedTags&&this.tidy.settings.allowedTags&&this.tidy.$div.find("*").not(this.tidy.settings.allowedTags.join(",")).each(function(i,s){""===s.innerHTML?$(s).remove():$(s).contents().unwrap()}),this.tidy.settings.deniedTags&&this.tidy.$div.find(this.tidy.settings.deniedTags.join(",")).each(function(i,s){""===s.innerHTML?$(s).remove():$(s).contents().unwrap()})},removeAttr:function(){var len;if(!this.tidy.settings.removeAttr&&this.tidy.settings.allowedAttr){var allowedAttrTags=[],allowedAttrData=[];len=this.tidy.settings.allowedAttr.length;for(var i=0;len>i;i++)allowedAttrTags.push(this.tidy.settings.allowedAttr[i][0]),allowedAttrData.push(this.tidy.settings.allowedAttr[i][1]);this.tidy.$div.find("*").each($.proxy(function(n,s){var $el=$(s),pos=$.inArray($el[0].tagName.toLowerCase(),allowedAttrTags),attributesRemove=this.tidy.removeAttrGetRemoves(pos,allowedAttrData,$el);attributesRemove&&$.each(attributesRemove,function(z,f){$el.removeAttr(f)})},this))}if(this.tidy.settings.removeAttr){len=this.tidy.settings.removeAttr.length;for(var i=0;len>i;i++){var attrs=this.tidy.settings.removeAttr[i][1];$.isArray(attrs)&&(attrs=attrs.join(" ")),this.tidy.$div.find(this.tidy.settings.removeAttr[i][0]).removeAttr(attrs)}}},removeAttrGetRemoves:function(pos,allowed,$el){var attributesRemove=[];return-1==pos?$.each($el[0].attributes,function(i,item){attributesRemove.push(item.name)}):"*"==allowed[pos]?attributesRemove=[]:$.each($el[0].attributes,function(i,item){$.isArray(allowed[pos])?-1==$.inArray(item.name,allowed[pos])&&attributesRemove.push(item.name):allowed[pos]!=item.name&&attributesRemove.push(item.name)}),attributesRemove},removeAttrs:function(el,regex){return regex=new RegExp(regex,"g"),el.each(function(){for(var self=$(this),len=this.attributes.length-1,i=len;i>=0;i--){var item=this.attributes[i];item&&item.specified&&item.name.search(regex)>=0&&self.removeAttr(item.name)}})},removeEmpty:function(){this.tidy.settings.removeEmpty&&this.tidy.$div.find(this.tidy.settings.removeEmpty.join(",")).each(function(){var $el=$(this),text=$el.text();text=text.replace(/[\u200B-\u200D\uFEFF]/g,""),text=text.replace(/&nbsp;/gi,""),text=text.replace(/\s/g,""),""===text&&0===$el.children().length&&$el.remove()})},removeParagraphsInLists:function(){this.tidy.$div.find("li p").contents().unwrap()},removeDataAttr:function(){if(this.tidy.settings.removeDataAttr){var tags=this.tidy.settings.removeDataAttr;$.isArray(this.tidy.settings.removeDataAttr)&&(tags=this.tidy.settings.removeDataAttr.join(",")),this.tidy.removeAttrs(this.tidy.$div.find(tags),"^(data-)")}},removeWithoutAttr:function(){this.tidy.settings.removeWithoutAttr&&this.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(",")).each(function(){0===this.attributes.length&&$(this).contents().unwrap()})}}},toolbar:function(){return{init:function(){return{html:{title:this.lang.get("html"),func:"code.toggle"},formatting:{title:this.lang.get("formatting"),dropdown:{p:{title:this.lang.get("paragraph"),func:"block.format"},blockquote:{title:this.lang.get("quote"),func:"block.format"},pre:{title:this.lang.get("code"),func:"block.format"},h1:{title:this.lang.get("header1"),func:"block.format"},h2:{title:this.lang.get("header2"),func:"block.format"},h3:{title:this.lang.get("header3"),func:"block.format"},h4:{title:this.lang.get("header4"),func:"block.format"},h5:{title:this.lang.get("header5"),func:"block.format"}}},bold:{title:this.lang.get("bold"),func:"inline.format"},italic:{title:this.lang.get("italic"),func:"inline.format"},deleted:{title:this.lang.get("deleted"),func:"inline.format"},underline:{title:this.lang.get("underline"),func:"inline.format"},unorderedlist:{title:"&bull; "+this.lang.get("unorderedlist"),func:"list.toggle"},orderedlist:{title:"1. "+this.lang.get("orderedlist"),func:"list.toggle"},outdent:{title:"< "+this.lang.get("outdent"),func:"indent.decrease"},indent:{title:"> "+this.lang.get("indent"),func:"indent.increase"},image:{title:this.lang.get("image"),func:"image.show"},file:{title:this.lang.get("file"),func:"file.show"},link:{title:this.lang.get("link"),dropdown:{link:{title:this.lang.get("link_insert"),func:"link.show"},unlink:{title:this.lang.get("unlink"),func:"link.unlink"}}},alignment:{title:this.lang.get("alignment"),dropdown:{left:{title:this.lang.get("align_left"),func:"alignment.left"},center:{title:this.lang.get("align_center"),func:"alignment.center"},right:{title:this.lang.get("align_right"),func:"alignment.right"},justify:{title:this.lang.get("align_justify"),func:"alignment.justify"}}},horizontalrule:{title:this.lang.get("horizontalrule"),func:"line.insert"}}},build:function(){this.toolbar.hideButtons(),this.toolbar.hideButtonsOnMobile(),this.toolbar.isButtonSourceNeeded(),0!==this.opts.buttons.length&&(this.$toolbar=this.toolbar.createContainer(),this.toolbar.setOverflow(),this.toolbar.append(),this.toolbar.setFormattingTags(),this.toolbar.loadButtons(),this.toolbar.setFixed(),this.opts.activeButtons&&this.$editor.on("mouseup.redactor keyup.redactor focus.redactor",$.proxy(this.observe.buttons,this)))},createContainer:function(){return $("<ul>").addClass("redactor-toolbar").attr("id","redactor-toolbar-"+this.uuid)},setFormattingTags:function(){$.each(this.opts.toolbar.formatting.dropdown,$.proxy(function(i,s){-1==$.inArray(i,this.opts.formatting)&&delete this.opts.toolbar.formatting.dropdown[i]},this))},loadButtons:function(){$.each(this.opts.buttons,$.proxy(function(i,btnName){if(this.opts.toolbar[btnName]){if("file"===btnName){if(this.opts.fileUpload===!1)return;if(!this.opts.fileUpload&&this.opts.s3===!1)return}if("image"===btnName){if(this.opts.imageUpload===!1)return;if(!this.opts.imageUpload&&this.opts.s3===!1)return}var btnObject=this.opts.toolbar[btnName];this.$toolbar.append($("<li>").append(this.button.build(btnName,btnObject)))}},this))},append:function(){this.opts.toolbarExternal?(this.$toolbar.addClass("redactor-toolbar-external"),$(this.opts.toolbarExternal).html(this.$toolbar)):this.$box.prepend(this.$toolbar)},setFixed:function(){this.utils.isDesktop()&&(this.opts.toolbarExternal||this.opts.toolbarFixed&&(this.toolbar.observeScroll(),$(this.opts.toolbarFixedTarget).on("scroll.redactor."+this.uuid,$.proxy(this.toolbar.observeScroll,this))))},setOverflow:function(){this.utils.isMobile()&&this.opts.toolbarOverflow&&this.$toolbar.addClass("redactor-toolbar-overflow")},isButtonSourceNeeded:function(){if(!this.opts.source){var index=this.opts.buttons.indexOf("html");-1!==index&&this.opts.buttons.splice(index,1)}},hideButtons:function(){0!==this.opts.buttonsHide.length&&$.each(this.opts.buttonsHide,$.proxy(function(i,s){var index=this.opts.buttons.indexOf(s);this.opts.buttons.splice(index,1)},this))},hideButtonsOnMobile:function(){this.utils.isMobile()&&0!==this.opts.buttonsHideOnMobile.length&&$.each(this.opts.buttonsHideOnMobile,$.proxy(function(i,s){var index=this.opts.buttons.indexOf(s);this.opts.buttons.splice(index,1)},this))},observeScroll:function(){var scrollTop=$(this.opts.toolbarFixedTarget).scrollTop(),boxTop=1;this.opts.toolbarFixedTarget===document&&(boxTop=this.$box.offset().top),scrollTop>boxTop?this.toolbar.observeScrollEnable(scrollTop,boxTop):this.toolbar.observeScrollDisable()},observeScrollEnable:function(scrollTop,boxTop){var top=this.opts.toolbarFixedTopOffset+scrollTop-boxTop,left=0,end=boxTop+this.$box.height()-32,width=this.$box.innerWidth();this.$toolbar.addClass("toolbar-fixed-box"),this.$toolbar.css({position:"absolute",width:width,top:top+"px",left:left}),scrollTop>end&&$(".redactor-dropdown-"+this.uuid+":visible").hide(),this.toolbar.setDropdownsFixed(),this.$toolbar.css("visibility",end>scrollTop?"visible":"hidden")},observeScrollDisable:function(){this.$toolbar.css({position:"relative",width:"auto",top:0,left:0,visibility:"visible"}),this.toolbar.unsetDropdownsFixed(),this.$toolbar.removeClass("toolbar-fixed-box")},setDropdownsFixed:function(){var top=this.$toolbar.innerHeight()+this.opts.toolbarFixedTopOffset,position="fixed";this.opts.toolbarFixedTarget!==document&&(top=this.$toolbar.innerHeight()+this.$toolbar.offset().top+this.opts.toolbarFixedTopOffset,position="absolute"),$(".redactor-dropdown-"+this.uuid).each(function(){$(this).css({position:position,top:top+"px"})})},unsetDropdownsFixed:function(){var top=this.$toolbar.innerHeight()+this.$toolbar.offset().top;$(".redactor-dropdown-"+this.uuid).each(function(){$(this).css({position:"absolute",top:top+"px"})})}}},upload:function(){return{init:function(id,url,callback){this.upload.direct=!1,this.upload.callback=callback,this.upload.url=url,this.upload.$el=$(id),this.upload.$droparea=$('<div id="redactor-droparea" />'),this.upload.$placeholdler=$('<div id="redactor-droparea-placeholder" />').text(this.lang.get("upload_label")),this.upload.$input=$('<input type="file" name="file" />'),this.upload.$placeholdler.append(this.upload.$input),this.upload.$droparea.append(this.upload.$placeholdler),this.upload.$el.append(this.upload.$droparea),this.upload.$droparea.off("redactor.upload"),this.upload.$input.off("redactor.upload"),this.upload.$droparea.on("dragover.redactor.upload",$.proxy(this.upload.onDrag,this)),this.upload.$droparea.on("dragleave.redactor.upload",$.proxy(this.upload.onDragLeave,this)),this.upload.$input.on("change.redactor.upload",$.proxy(function(e){e=e.originalEvent||e,this.upload.traverseFile(this.upload.$input[0].files[0],e)},this)),this.upload.$droparea.on("drop.redactor.upload",$.proxy(function(e){e.preventDefault(),this.upload.$droparea.removeClass("drag-hover").addClass("drag-drop"),this.upload.onDrop(e)},this))},directUpload:function(file,e){this.upload.direct=!0,this.upload.traverseFile(file,e)},onDrop:function(e){e=e.originalEvent||e;var files=e.dataTransfer.files;this.upload.traverseFile(files[0],e)},traverseFile:function(file,e){if(this.opts.s3)return this.upload.setConfig(file),void this.upload.s3uploadFile(file);var formData=window.FormData?new FormData:null;if(window.FormData){this.upload.setConfig(file);var name="image"==this.upload.type?this.opts.imageUploadParam:this.opts.fileUploadParam;formData.append(name,file)}this.progress.show(),this.core.setCallback("uploadStart",e,formData),this.upload.sendData(formData,e)},setConfig:function(file){this.upload.getType(file),this.upload.direct&&(this.upload.url="image"==this.upload.type?this.opts.imageUpload:this.opts.fileUpload,this.upload.callback="image"==this.upload.type?this.image.insert:this.file.insert)},getType:function(file){this.upload.type="image",-1==this.opts.imageTypes.indexOf(file.type)&&(this.upload.type="file")},getHiddenFields:function(obj,fd){return obj===!1||"object"!=typeof obj?fd:($.each(obj,$.proxy(function(k,v){null!==v&&0===v.toString().indexOf("#")&&(v=$(v).val()),fd.append(k,v)},this)),fd)},sendData:function(formData,e){"image"==this.upload.type?(formData=this.upload.getHiddenFields(this.opts.uploadImageFields,formData),formData=this.upload.getHiddenFields(this.upload.imageFields,formData)):(formData=this.upload.getHiddenFields(this.opts.uploadFileFields,formData),formData=this.upload.getHiddenFields(this.upload.fileFields,formData));var xhr=new XMLHttpRequest;xhr.open("POST",this.upload.url),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.onreadystatechange=$.proxy(function(){if(4==xhr.readyState){var data=xhr.responseText;data=data.replace(/^\[/,""),data=data.replace(/\]$/,"");var json;try{json="string"==typeof data?$.parseJSON(data):data}catch(err){json={error:!0}}this.progress.hide(),this.upload.direct||this.upload.$droparea.removeClass("drag-drop"),this.upload.callback(json,this.upload.direct,e)}},this),xhr.send(formData)},onDrag:function(e){e.preventDefault(),this.upload.$droparea.addClass("drag-hover")},onDragLeave:function(e){e.preventDefault(),this.upload.$droparea.removeClass("drag-hover")},clearImageFields:function(){this.upload.imageFields={}},addImageFields:function(name,value){this.upload.imageFields[name]=value},removeImageFields:function(name){delete this.upload.imageFields[name]},clearFileFields:function(){this.upload.fileFields={}},addFileFields:function(name,value){this.upload.fileFields[name]=value},removeFileFields:function(name){delete this.upload.fileFields[name]},s3uploadFile:function(file){this.upload.s3executeOnSignedUrl(file,$.proxy(function(signedURL){this.upload.s3uploadToS3(file,signedURL)},this))},s3executeOnSignedUrl:function(file,callback){var xhr=new XMLHttpRequest,mark="?";"-1"!=this.opts.s3.search(/\?/)&&(mark="&"),xhr.open("GET",this.opts.s3+mark+"name="+file.name+"&type="+file.type,!0),xhr.overrideMimeType&&xhr.overrideMimeType("text/plain; charset=x-user-defined");var that=this;xhr.onreadystatechange=function(e){4==this.readyState&&200==this.status?(that.progress.show(),callback(decodeURIComponent(this.responseText))):4==this.readyState&&200!=this.status},xhr.send()},s3createCORSRequest:function(method,url){var xhr=new XMLHttpRequest;return"withCredentials"in xhr?xhr.open(method,url,!0):"undefined"!=typeof XDomainRequest?(xhr=new XDomainRequest,xhr.open(method,url)):xhr=null,xhr},s3uploadToS3:function(file,url){var xhr=this.upload.s3createCORSRequest("PUT",url);xhr&&(xhr.onload=$.proxy(function(){if(200==xhr.status){this.progress.hide();var s3file=url.split("?");if(!s3file[0])return!1;this.upload.direct||this.upload.$droparea.removeClass("drag-drop");var json={filelink:s3file[0]};if("file"==this.upload.type){var arr=s3file[0].split("/");json.filename=arr[arr.length-1]}this.upload.callback(json,this.upload.direct,!1)}},this),xhr.onerror=function(){},xhr.upload.onprogress=function(e){},xhr.setRequestHeader("Content-Type",file.type),xhr.setRequestHeader("x-amz-acl","public-read"),xhr.send(file))}}},utils:function(){return{isMobile:function(){return/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)},isString:function(obj){return"[object String]"==Object.prototype.toString.call(obj)},isEmpty:function(html,removeEmptyTags){return html=html.replace(/[\u200B-\u200D\uFEFF]/g,""),html=html.replace(/&nbsp;/gi,""),html=html.replace(/<\/?br\s?\/?>/g,""),html=html.replace(/\s/g,""),html=html.replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,""),html=html.replace(/<iframe(.*?[^>])>$/i,"iframe"),html=html.replace(/<source(.*?[^>])>$/i,"source"),removeEmptyTags!==!1&&(html=html.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),html=html.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")),html=$.trim(html),""===html},normalize:function(str){return"undefined"==typeof str?0:parseInt(str.replace("px",""),10)},hexToRgb:function(hex){if("undefined"!=typeof hex){if(-1==hex.search(/^#/))return hex;var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return"rgb("+parseInt(result[1],16)+", "+parseInt(result[2],16)+", "+parseInt(result[3],16)+")"}},getOuterHtml:function(el){return $("<div>").append($(el).eq(0).clone()).html()},getAlignmentElement:function(el){return-1!==$.inArray(el.tagName,this.opts.alignmentTags)?$(el):$(el).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0])},removeEmptyAttr:function(el,attr){var $el=$(el);return"undefined"==typeof $el.attr(attr)?!0:""===$el.attr(attr)?($el.removeAttr(attr),!0):!1},removeEmpty:function(i,s){var $s=$(s);if($s.find(".redactor-invisible-space").removeAttr("style").removeAttr("class"),0===$s.find("hr, br, img, iframe, source").length){var text=$.trim($s.text());this.utils.isEmpty(text,!1)&&$s.remove()}},saveScroll:function(){this.saveEditorScroll=this.$editor.scrollTop(),this.saveBodyScroll=$(window).scrollTop(),this.opts.scrollTarget&&(this.saveTargetScroll=$(this.opts.scrollTarget).scrollTop())},restoreScroll:function(){("undefined"!=typeof this.saveScroll||"undefined"!=typeof this.saveBodyScroll)&&($(window).scrollTop(this.saveBodyScroll),this.$editor.scrollTop(this.saveEditorScroll),this.opts.scrollTarget&&$(this.opts.scrollTarget).scrollTop(this.saveTargetScroll))},createSpaceElement:function(){var space=document.createElement("span");return space.className="redactor-invisible-space",space.innerHTML=this.opts.invisibleSpace,space},removeInlineTags:function(node){var tags=this.opts.inlineTags;tags.push("span"),"PRE"==node.tagName&&tags.push("a"),$(node).find(tags.join(",")).not("span.redactor-selection-marker").contents().unwrap()},replaceWithContents:function(node,removeInlineTags){var self=this;return $(node).replaceWith(function(){return removeInlineTags===!0&&self.utils.removeInlineTags(this),$(this).contents()}),$(node)},replaceToTag:function(node,tag,removeInlineTags){var replacement,self=this;return $(node).replaceWith(function(){replacement=$("<"+tag+" />").append($(this).contents());for(var i=0;i<this.attributes.length;i++)replacement.attr(this.attributes[i].name,this.attributes[i].value);return removeInlineTags===!0&&self.utils.removeInlineTags(replacement),replacement}),replacement},isStartOfElement:function(){var block=this.selection.getBlock();if(!block)return!1;var offset=this.caret.getOffsetOfElement(block);return 0===offset?!0:!1},isEndOfElement:function(element){if("undefined"==typeof element){var element=this.selection.getBlock();if(!element)return!1}var offset=this.caret.getOffsetOfElement(element),text=$.trim($(element).text()).replace(/\n\r\n/g,"");return offset==text.length?!0:!1},isEndOfEditor:function(){var block=this.$editor[0],offset=this.caret.getOffsetOfElement(block),text=$.trim($(block).html().replace(/(<([^>]+)>)/gi,""));return offset==text.length?!0:!1},isBlock:function(block){return block=block[0]||block,block&&this.utils.isBlockTag(block.tagName)},isBlockTag:function(tag){return"undefined"==typeof tag?!1:this.reIsBlock.test(tag)},isTag:function(current,tag){var element=$(current).closest(tag,this.$editor[0]);return 1==element.length?element[0]:!1},isSelectAll:function(){return this.selectAll},enableSelectAll:function(){this.selectAll=!0},disableSelectAll:function(){this.selectAll=!1},isRedactorParent:function(el){return el?0===$(el).parents(".redactor-editor").length||$(el).hasClass("redactor-editor")?!1:el:!1},isCurrentOrParentHeader:function(){return this.utils.isCurrentOrParent(["H1","H2","H3","H4","H5","H6"])},isCurrentOrParent:function(tagName){var parent=this.selection.getParent(),current=this.selection.getCurrent();if($.isArray(tagName)){var matched=0;return $.each(tagName,$.proxy(function(i,s){this.utils.isCurrentOrParentOne(current,parent,s)&&matched++},this)),0===matched?!1:!0}return this.utils.isCurrentOrParentOne(current,parent,tagName)},isCurrentOrParentOne:function(current,parent,tagName){return tagName=tagName.toUpperCase(),parent&&parent.tagName===tagName?parent:current&&current.tagName===tagName?current:!1},isOldIe:function(){return this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<9?!0:!1},isLessIe10:function(){return this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<10?!0:!1},isIe11:function(){return!!navigator.userAgent.match(/Trident\/7\./)},browser:function(browser){var ua=navigator.userAgent.toLowerCase(),match=/(opr)[\/]([\w.]+)/.exec(ua)||/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return"safari"==browser?"undefined"!=typeof match[3]?"safari"==match[3]:!1:"version"==browser?match[2]:"webkit"==browser?"chrome"==match[1]||"opr"==match[1]||"webkit"==match[1]:"rv"==match[1]?"msie"==browser:"opr"==match[1]?"webkit"==browser:browser==match[1]}}},linkify:function(){return{isKey:function(key){return key==this.keyCode.ENTER||key==this.keyCode.SPACE},isEnabled:function(){return this.opts.convertLinks&&(this.opts.convertUrlLinks||this.opts.convertImageLinks||this.opts.convertVideoLinks)&&!this.utils.isCurrentOrParent("PRE")},format:function(){var linkify=this.linkify,opts=this.opts;this.$editor.find(":not(iframe,img,a,pre)").addBack().contents().filter(function(){return 3===this.nodeType&&""!=$.trim(this.nodeValue)&&!$(this).parent().is("pre")&&(this.nodeValue.match(opts.linkify.regexps.youtube)||this.nodeValue.match(opts.linkify.regexps.vimeo)||this.nodeValue.match(opts.linkify.regexps.image)||this.nodeValue.match(opts.linkify.regexps.url))}).each(function(){var text=$(this).text(),html=text;opts.convertImageLinks&&html.match(opts.linkify.regexps.image)?html=linkify.convertImages(html):!opts.convertUrlLinks||html.match(opts.linkify.regexps.youtube)||html.match(opts.linkify.regexps.vimeo)||(html=linkify.convertLinks(html)),opts.convertVideoLinks&&(html=linkify.convertVideoLinks(html)),$(this).before(text.replace(text,html)).remove()}),this.linkify.after()},convertVideoLinks:function(html){var iframeStart='<iframe width="500" height="281" src="',iframeEnd='" frameborder="0" allowfullscreen></iframe>';return html.match(this.opts.linkify.regexps.youtube)&&(html=html.replace(this.opts.linkify.regexps.youtube,iframeStart+"//www.youtube.com/embed/$1"+iframeEnd)),html.match(this.opts.linkify.regexps.vimeo)&&(html=html.replace(this.opts.linkify.regexps.vimeo,iframeStart+"//player.vimeo.com/video/$2"+iframeEnd)),html},convertImages:function(html){var matches=html.match(this.opts.linkify.regexps.image);return matches&&(html=html.replace(html,'<img src="'+matches+'" />')),html},convertLinks:function(html){var matches=html.match(this.opts.linkify.regexps.url);if(matches){matches=$.grep(matches,function(v,k){return $.inArray(v,matches)===k});for(var length=matches.length,i=0;length>i;i++){var href=matches[i],text=href,linkProtocol=this.opts.linkProtocol+"://";null!==href.match(/(https?|ftp):\/\//i)&&(linkProtocol=""),text.length>this.opts.linkSize&&(text=text.substring(0,this.opts.linkSize)+"..."),text=decodeURIComponent(text);var regexp=new RegExp("("+href.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")\\b","g");html=html.replace(regexp,'<a href="'+linkProtocol+$.trim(href)+'">'+$.trim(text)+"</a>")}}return html},after:function(){this.observe.load(),this.code.sync()}}}},$(window).on("load.tools.redactor",function(){$('[data-tools="redactor"]').redactor()}),Redactor.prototype.init.prototype=Redactor.prototype}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function($){RedactorPlugins.table=function(){return{getTemplate:function(){return String()+'<section id="redactor-modal-table-insert"><label>'+this.lang.get("rows")+'</label><input type="text" size="5" value="2" id="redactor-table-rows" /><label>'+this.lang.get("columns")+'</label><input type="text" size="5" value="3" id="redactor-table-columns" /></section>'},init:function(){var dropdown={};dropdown.insert_table={title:this.lang.get("insert_table"),func:this.table.show},dropdown.insert_row_above={title:this.lang.get("insert_row_above"),func:this.table.addRowAbove},dropdown.insert_row_below={title:this.lang.get("insert_row_below"),func:this.table.addRowBelow},dropdown.insert_column_left={title:this.lang.get("insert_column_left"),func:this.table.addColumnLeft},dropdown.insert_column_right={title:this.lang.get("insert_column_right"),func:this.table.addColumnRight},dropdown.add_head={title:this.lang.get("add_head"),func:this.table.addHead},dropdown.delete_head={title:this.lang.get("delete_head"),func:this.table.deleteHead},dropdown.delete_column={title:this.lang.get("delete_column"),func:this.table.deleteColumn},dropdown.delete_row={title:this.lang.get("delete_row"),func:this.table.deleteRow},dropdown.delete_table={title:this.lang.get("delete_table"),func:this.table.deleteTable},this.observe.addButton("td","table"),this.observe.addButton("th","table");var button=this.button.addBefore("link","table",this.lang.get("table"));this.button.addDropdown(button,dropdown)},show:function(){this.modal.addTemplate("table",this.table.getTemplate()),this.modal.load("table",this.lang.get("insert_table"),300),this.modal.createCancelButton();var button=this.modal.createActionButton(this.lang.get("insert"));button.on("click",this.table.insert),this.selection.save(),this.modal.show(),$("#redactor-table-rows").focus()},insert:function(){this.placeholder.remove(),this.clean.cleanEmptyParagraph();var i,$row,z,$column,rows=$("#redactor-table-rows").val(),columns=$("#redactor-table-columns").val(),$tableBox=$("<div>"),tableId=Math.floor(99999*Math.random()),$table=$('<table id="table'+tableId+'"><tbody></tbody></table>');for(i=0;rows>i;i++){for($row=$("<tr>"),z=0;columns>z;z++)$column=$("<td>"+this.opts.invisibleSpace+"</td>"),0===i&&0===z&&$column.append(this.selection.getMarker()),$($row).append($column);$table.append($row)}$tableBox.append($table);var html=$tableBox.html();if(this.modal.close(),this.selection.restore(),!this.table.getTable()){this.buffer.set();var current=this.selection.getBlock()||this.selection.getCurrent();current&&"BODY"!=current.tagName?("LI"==current.tagName&&(current=$(current).closest("ul, ol")),$(current).after(html)):this.insert.html(html,!1),this.selection.restore();var table=this.$editor.find("#table"+tableId);if(!this.opts.linebreaks&&(this.utils.browser("mozilla")||this.utils.browser("msie"))){var $next=table.next();0===$next.length&&table.after(this.opts.emptyHtml)}this.observe.buttons(),table.find("span.redactor-selection-marker").remove(),table.removeAttr("id"),table.addClass("table"),this.code.sync(),this.core.setCallback("insertedTable",table)}},getTable:function(){var $table=$(this.selection.getParent()).closest("table");return this.utils.isRedactorParent($table)?0===$table.size()?!1:$table:!1},restoreAfterDelete:function($table){this.selection.restore(),$table.find("span.redactor-selection-marker").remove(),this.code.sync()},deleteTable:function(){var $table=this.table.getTable();if($table){this.buffer.set();var $next=$table.next();this.opts.linebreaks||0===$next.length?this.caret.setAfter($table):this.caret.setStart($next),$table.remove(),this.code.sync()}},deleteRow:function(){var $table=this.table.getTable();if($table){var $current=$(this.selection.getCurrent());this.buffer.set();var $current_tr=$current.closest("tr"),$focus_tr=$current_tr.prev().length?$current_tr.prev():$current_tr.next();if($focus_tr.length){var $focus_td=$focus_tr.children("td, th").first();$focus_td.length&&$focus_td.prepend(this.selection.getMarker())}$current_tr.remove(),this.table.restoreAfterDelete($table)}},deleteColumn:function(){var $table=this.table.getTable();if($table){this.buffer.set();var $current=$(this.selection.getCurrent()),$current_td=$current.closest("td, th"),index=$current_td[0].cellIndex;$table.find("tr").each($.proxy(function(i,elem){var $elem=$(elem),focusIndex=0>index-1?index+1:index-1;0===i&&$elem.find("td, th").eq(focusIndex).prepend(this.selection.getMarker()),$elem.find("td, th").eq(index).remove()},this)),this.table.restoreAfterDelete($table)}},addHead:function(){var $table=this.table.getTable();if($table){if(this.buffer.set(),0!==$table.find("thead").size())return void this.table.deleteHead();var tr=$table.find("tr").first().clone();tr.find("td").replaceWith($.proxy(function(){return $("<th>").html(this.opts.invisibleSpace)},this)),$thead=$("<thead></thead>").append(tr),$table.prepend($thead),this.code.sync()}},deleteHead:function(){var $table=this.table.getTable();if($table){var $thead=$table.find("thead");0!==$thead.size()&&(this.buffer.set(),
$thead.remove(),this.code.sync())}},addRowAbove:function(){this.table.addRow("before")},addRowBelow:function(){this.table.addRow("after")},addColumnLeft:function(){this.table.addColumn("before")},addColumnRight:function(){this.table.addColumn("after")},addRow:function(type){var $table=this.table.getTable();if($table){this.buffer.set();var $current=$(this.selection.getCurrent()),$current_tr=$current.closest("tr"),new_tr=$current_tr.clone();new_tr.find("th").replaceWith(function(){var $td=$("<td>");return $td[0].attributes=this.attributes,$td.append($(this).contents())}),new_tr.find("td").html(this.opts.invisibleSpace),"after"==type?$current_tr.after(new_tr):$current_tr.before(new_tr),this.code.sync()}},addColumn:function(type){var $table=this.table.getTable();if($table){var index=0,current=$(this.selection.getCurrent());this.buffer.set();var $current_tr=current.closest("tr"),$current_td=current.closest("td, th");$current_tr.find("td, th").each($.proxy(function(i,elem){$(elem)[0]===$current_td[0]&&(index=i)},this)),$table.find("tr").each($.proxy(function(i,elem){var $current=$(elem).find("td, th").eq(index),td=$current.clone();td.html(this.opts.invisibleSpace),"after"==type?$current.after(td):$current.before(td)},this)),this.code.sync()}}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};if(function($){RedactorPlugins.fontcolor=function(){return{init:function(){for(var colors=["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],buttons=["fontcolor","backcolor"],i=0;2>i;i++){var name=buttons[i],button=this.button.add(name,this.lang.get(name)),$dropdown=this.button.addDropdown(button);$dropdown.width(242),this.fontcolor.buildPicker($dropdown,name,colors)}},buildPicker:function($dropdown,name,colors){for(var rule="backcolor"==name?"background-color":"color",len=colors.length,self=this,func=function(e){e.preventDefault(),self.fontcolor.set($(this).data("rule"),$(this).attr("rel"))},z=0;len>z;z++){var color=colors[z],$swatch=$('<a rel="'+color+'" data-rule="'+rule+'" href="#" style="float: left; font-size: 0; border: 2px solid #fff; padding: 0; margin: 0; width: 22px; height: 22px;"></a>');$swatch.css("background-color",color),$swatch.on("click",func),$dropdown.append($swatch)}var $elNone=$('<a href="#" style="display: block; clear: both; padding: 5px; font-size: 12px; line-height: 1;"></a>').html(this.lang.get("none"));$elNone.on("click",$.proxy(function(e){e.preventDefault(),this.fontcolor.remove(rule)},this)),$dropdown.append($elNone)},set:function(rule,type){this.inline.format("span","style",rule+": "+type+";")},remove:function(rule){this.inline.removeStyleRule(rule)}}}}(jQuery),!RedactorPlugins)var RedactorPlugins={};!function($){RedactorPlugins.fontsize=function(){return{init:function(){var fonts=[10,11,12,14,16,18,20,24,28,30],that=this,dropdown={};$.each(fonts,function(i,s){dropdown["s"+i]={title:s+"px",func:function(){that.fontsize.set(s)}}}),dropdown.remove={title:"Remove Font Size",func:that.fontsize.reset};var button=this.button.add("fontsize","Change Font Size");this.button.addDropdown(button,dropdown)},set:function(size){this.inline.format("span","style","font-size: "+size+"px;")},reset:function(){this.inline.removeStyleRule("font-size")}}}}(jQuery);